{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/component/element.js","webpack:///./src/core/alphabet.js","webpack:///./src/core/cell_range.js","webpack:///./src/core/selector.js","webpack:///./src/core/scroll.js","webpack:///./src/core/history.js","webpack:///./src/core/clipboard.js","webpack:///./src/core/auto_filter.js","webpack:///./src/core/merge.js","webpack:///./src/core/helper.js","webpack:///./src/core/row.js","webpack:///./src/core/col.js","webpack:///./src/locale/locale.js","webpack:///./src/locale/en.js","webpack:///./src/core/validator.js","webpack:///./src/core/validation.js","webpack:///./src/core/data_proxy.js","webpack:///./src/component/event.js","webpack:///./src/config.js","webpack:///./src/component/resizer.js","webpack:///./src/component/scrollbar.js","webpack:///./src/component/selector.js","webpack:///./src/component/suggest.js","webpack:///./src/component/icon.js","webpack:///./src/component/calendar.js","webpack:///./src/component/datepicker.js","webpack:///./src/component/editor.js","webpack:///./src/component/button.js","webpack:///./src/canvas/draw.js","webpack:///./src/core/font.js","webpack:///./src/core/formula.js","webpack:///./src/core/cell.js","webpack:///./src/core/format.js","webpack:///./src/component/table.js","webpack:///./src/component/print.js","webpack:///./src/component/contextmenu.js","webpack:///./src/component/toolbar/item.js","webpack:///./src/component/tooltip.js","webpack:///./src/component/toolbar/dropdown_item.js","webpack:///./src/component/dropdown.js","webpack:///./src/component/dropdown_align.js","webpack:///./src/component/toolbar/align.js","webpack:///./src/component/toolbar/valign.js","webpack:///./src/component/toolbar/toggle_item.js","webpack:///./src/component/toolbar/autofilter.js","webpack:///./src/component/toolbar/bold.js","webpack:///./src/component/toolbar/italic.js","webpack:///./src/component/toolbar/strike.js","webpack:///./src/component/toolbar/underline.js","webpack:///./src/component/color_palette.js","webpack:///./src/component/dropdown_color.js","webpack:///./src/component/dropdown_linetype.js","webpack:///./src/component/border_palette.js","webpack:///./src/component/dropdown_border.js","webpack:///./src/component/toolbar/border.js","webpack:///./src/component/toolbar/icon_item.js","webpack:///./src/component/toolbar/clearformat.js","webpack:///./src/component/toolbar/paintformat.js","webpack:///./src/component/toolbar/text_color.js","webpack:///./src/component/toolbar/fill_color.js","webpack:///./src/component/dropdown_fontsize.js","webpack:///./src/component/toolbar/font_size.js","webpack:///./src/component/dropdown_font.js","webpack:///./src/component/toolbar/font.js","webpack:///./src/component/dropdown_format.js","webpack:///./src/component/toolbar/format.js","webpack:///./src/component/dropdown_formula.js","webpack:///./src/component/toolbar/formula.js","webpack:///./src/component/toolbar/freeze.js","webpack:///./src/component/toolbar/merge.js","webpack:///./src/component/toolbar/redo.js","webpack:///./src/component/toolbar/undo.js","webpack:///./src/component/toolbar/print.js","webpack:///./src/component/toolbar/textwrap.js","webpack:///./src/component/toolbar/more.js","webpack:///./src/component/toolbar/index.js","webpack:///./src/component/formulabar.js","webpack:///./src/component/modal.js","webpack:///./src/component/form_input.js","webpack:///./src/component/form_select.js","webpack:///./src/component/form_field.js","webpack:///./src/component/modal_validation.js","webpack:///./src/component/sort_filter.js","webpack:///./src/component/message.js","webpack:///./src/component/sheet.js","webpack:///./src/component/bottombar.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Element","tag","className","arguments","length","undefined","_classCallCheck","this","el","document","createElement","data","eventNames","handler","_eventNames$split2","_toArray","split","fen","oen","slice","eventName","test","window","navigator","userAgent","addEventListener","evt","k","button","stopPropagation","_this","keys","forEach","css","concat","_this$el","top","offsetTop","left","offsetLeft","height","offsetHeight","width","offsetWidth","v","scrollLeft","scrollTop","getBoundingClientRect","parentNode","_this2","_len","eles","Array","_key","childNodes","ele","child","removeChild","arg","createTextNode","appendChild","contains","classList","add","remove","cls","toggleClass","toggle","flag","addClass","removeClass","active","_this3","setAttribute","getAttribute","removeAttribute","content","innerHTML","focus","_this4","_len2","_key2","style","removeProperty","_this5","getComputedStyle","h","alphabets","stringAt","index","str","cindex","parseInt","last","indexAt","ret","toUpperCase","charCodeAt","exponet","Math","pow","expr2xy","src","x","y","replace","charAt","xy2expr","isConstX","isConstY","expr2expr","xn","yn","condition","_expr2xy2","_slicedToArray","CellRange","sri","sci","eri","eci","w","cell_range_classCallCheck","ref","refs","_expr2xy4","cell_range_slicedToArray","_expr2xy6","ri","ci","args","_expr2xy","cb","rowFilter","j","other","addRet","push","dsr","dsc","der","dec","multiple","Selector","selector_classCallCheck","range","size","Scroll","scroll_classCallCheck","History","history_classCallCheck","undoItems","redoItems","JSON","stringify","currentd","canUndo","parse","pop","canRedo","Clipboard","clipboard_classCallCheck","state","cellRange","Filter","operator","auto_filter_classCallCheck","includes","Sort","order","AutoFilter","filters","sort","_ref","map","it","getData","filter","getFilter","set","hrange","getCell","rset","Set","fset","_this$range","cell","ctext","text","_this$range2","cnt","valueOf","Merges","merge_classCallCheck","_","cr","within","intersects","union","deleteWithin","type","cbWithin","toRm","rn","cn","it1","merges","merge","removeBrokenMerges","toString","mergeDeep","sources","source","isArray","digits","a","numberCalc","a1","a2","Number","isNaN","al1","al2","num1","num2","NaN","toFixed","max","helper","cloneDeep","obj","apply","equals","obj1","obj2","v1","v2","ai","arrayEquals","sum","objOrAry","total","rangeEach","min","rangeSum","getv","rangeReduceIf","inits","initv","ifv","deleteProperty","oldv","Rows","len","row_classCallCheck","isHide","row","getOrNew","idx","setHide","hide","exceptSet","has","getHeight","sumHeight","cells","what","getCellOrNew","editable","srcCellRange","dstCellRange","autofill","dsri","dsci","deri","deci","_srcCellRange$size","_srcCellRange$size2","row_slicedToArray","_dstCellRange$size","_dstCellRange$size2","drn","dcn","isAdd","dn","_loop","_loop2","ii","_loop3","jj","nri","nci","ncell","word","result","exec","substring","setCell","ncellmm","each","eachCells","setCellText","ndata","_this6","_this7","rndata","_expr2xy8","_this8","_expr2xy10","_expr2xy12","_this9","deleteCell","col","ks","entries","_ref2","_ref3","_ref4","_ref5","assign","Cols","indexWidth","minWidth","col_classCallCheck","getWidth","sumWidth","$languages","$messages","en","toolbar","undo","redo","print","paintformat","clearformat","format","fontName","fontSize","fontBold","fontItalic","underline","strike","color","bgcolor","border","align","valign","textwrap","freeze","autofilter","formula","more","contextmenu","copy","cut","paste","pasteValue","pasteFormat","insertRowBefore","insertRowAfter","insertRowsBefore","insertRowsAfter","insertColumnBefore","insertColumnAfter","insertColumnsBefore","insertColumnsAfter","deleteSheet","deleteRow","deleteRows","deleteColumn","deleteColumns","deleteCellText","resetRowHeight","resetColumnWidth","validation","cellprintable","cellnonprintable","celleditable","cellnoneditable","orientation","orientations","normal","number","percent","rmb","usd","eur","date","time","datetime","duration","average","_if","and","or","required","notMatch","between","notBetween","notIn","equal","notEqual","lessThan","lessThanEqual","greaterThan","greaterThanEqual","error","pasteForMergedCell","warning","mergingMultipleValues","calendar","weeks","months","next","cancel","save","ok","desc","asc","empty","dataValidation","criteria","modeType","column","list","phone","email","be","nbe","lt","lte","gt","gte","eq","neq","translate","messages","_i","_$languages","lang","message","match","x_spreadsheet","tf","locale","unshift","rules","returnMessage","Validator","validator_classCallCheck","Date","values","parseValue","_value","validator_slicedToArray","_value2","Validation","validator","validation_classCallCheck","nrefs","difference","Validations","errors","Map","_v$validator$validate2","validation_slicedToArray","validate","getByValidator","addRef","defaultSettings","autoFocus","view","documentElement","clientHeight","clientWidth","showGrid","showToolbar","showContextmenu","showContextMenuForCells","showBottomBar","suggestFormulas","font","bold","italic","cellHeaderStyle","selectedBgcolor","cornerBgcolor","fontFamily","misc","paintFormat","clearFormat","family","textStyle","fill","borders","cellText","horizontalAlignment","verticalAlignment","wrap","tools","freezeCell","formulas","itemsCallback","clipboard","formulaBar","location","contextMenu","extraItems","preShowCallback","cellCustomFormatterCreator","canPaste","dst","clone","_src$size2","data_proxy_slicedToArray","srn","scn","_dst$size2","copyPaste","rows","deleteCells","_cell$merge","cutPaste","move","clear","setStyleBorder","bss","styles","cstyle","addStyle","DataProxy","settings","data_proxy_classCallCheck","cols","validations","hyperlinks","comments","selector","scroll","history","autoFilter","change","exceptRowSet","sortedRowMap","unsortedRowMap","randomId","random","substr","changeData","_this$selector","_this$selector2","setData","copyText","copyObj","srcType","srcDataId","srcRange","_this$selector$range","renderedText","startsWith","_lastRenderedFormula","getCellStyle","join","json","clipboardData","clearData","preventDefault","writeText","then","err","console","log","isClear","isCopy","isCut","txt","lines","dci","dri","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","iterator","done","cellData","translateFormula","isHeaderClick","_selector$range2","cri","cci","getFirstIncludes","unmerge","_selector$range","isSingleSelected","mergeIndexes","_merges$ii","mri","mci","splice","_cell$merge2","mrl","mcl","bottom","right","getCellMerge","_selector$size2","nfont","oldCell","oldText","vIndex","findIndex","_this$selector3","_this$getSelectedRect","getSelectedRect","x1","y1","getRect","left0","top0","fsh","freezeTotalHeight","fsw","freezeTotalWidth","_getCellRowByY$call","scrollOffsety","frset","_getCellColByX$call","scrollOffsetx","_helper$rangeReduceIf2","totalWidth","totalHeight","_this$cellRect","cellRect","_this$selector$range2","_cell$merge3","_this$selector$range3","_cell$merge4","_selector$size4","_selector$range3","collectMergeValues","firstCellStyle","firstNonEmptyCellStyle","getMergeFirstNonEmptyCellStyle","mergedCellStyle","_this10","_selector$range4","_this11","addFilter","setSort","resetAutoFilter","_this12","_autoFilter$filteredR","filteredRows","fary","from","oldAry","b","_this13","_this14","_this14$selector$rang","si","insert","insertColumn","shift","_this15","_selector$range5","_selector$range$size2","rsize","csize","fci","_helper$rangeReduceIf4","fri","_helper$rangeReduceIf6","allowHorizontalOverflow","textWidth","isCellMerged","isCellTextAlignedLeft","isTextWrapOn","_cell$merge5","hasHorizontalOverflow","extraWidth","maxHorizontalOverflowExtraColumnsCount","maxHorizontalOverflow","ci2","cell2","isCellEmpty","width2","maxNeededExtraWidth","addedExtraWidth","defaultStyle","styleVal","defaultStyleVal","cellStyle","newCellStyle","hasAlignSet","_this$selector4","getCellStyleOrDefault","formatter","setSelectedCellAttr","origText","_origText","_this$freeze","_this16","_this17","setHeight","_this18","setWidth","_this$settings","_this$freeze2","_rows$maxCell2","maxCell","exceptRows","exceptRowTH","viewHeight","viewWidth","viewRange","filterIntersects","_selector$size6","rlen","clen","_selector$range6","unhide","frary","_toConsumableArray","offset","rowHeight","colWidth","nstyle","force","_this19","target","fn","unbind","removeEventListener","unbindClickoutside","xclickoutside","body","bindClickoutside","detail","mouseMoveUp","movefunc","upfunc","xEvtUp","calTouchDirection","spanx","spany","abs","cssPrefix","devicePixelRatio","Resizer","vertical","minDistance","resizer_classCallCheck","moving","children","unhideHoverEl","on","mousedblclickHandler","hoverEl","mousedownHandler","lineEl","cRect","finishedFn","unhideFn","unhideIndex","show","rect","line","hideUnhide","startEvt","distance","e","buttons","movementX","movementY","Scrollbar","scrollbar_classCallCheck","moveFn","contentEl","_evt$target","contentDistance","cssKey","isHidden","startZIndex","SelectorElement","useHideInput","component_selector_classCallCheck","inputChange","cornerEl","areaElFirst","areaEl","clipboardEl","autofillEl","hideInput","hideInputDiv","vFirst","of","ofFirst","val","calBRAreaOffset","ftwidth","ftheight","calTAreaOffset","calLAreaOffset","setBRAreaOffset","offsetFirst","br","setAreaOffset","setTAreaOffset","setLAreaOffset","setLClipboardOffset","setClipboardOffset","setBRClipboardOffset","setTClipboardOffset","setAllAreaOffset","tl","setAllClipboardOffset","areaOffset","indexes","arange","lastri","lastci","resetAreaOffset","freezeHeight","freezeWidth","setOffset","getFirstSelectedCellRect","coffset","getClipboardRect","resetOffset","indexesUpdated","calSelectedRangeByStart","setIndexes","moveIndexes","calSelectedRangeByEnd","_this$data$selector$r","setEnd","ern","ecn","showAutofill","hideAutofill","showClipboard","hideClipboard","inputEnter","filterItems","itemIndex","click","Suggest","items","itemClick","disabled","suggest_classCallCheck","cssRemoveKeys","parent","_el$html","title","item","label","html","suggest_toConsumableArray","input","keyCode","ctrlKey","Icon","icon_classCallCheck","_possibleConstructorReturn","_getPrototypeOf","iconNameEl","addMonth","step","setMonth","getMonth","weekday","setDate","getDay","Calendar","_h","calendar_classCallCheck","cvalue","headerLeftEl","bodyEl","buildAll","prev","calendar_toConsumableArray","week","selectChange","buildHeaderLeft","buildBody","getFullYear","_bodyEl$html","trs","year","month","cdate","startDate","datess","getDate","monthDays","_h2","tds","Datepicker","datepicker_classCallCheck","setValue","RegExp","resetTextareaSize","inputText","textlineEl","textEl","txts","maxTxtSize","editor_toConsumableArray","fontWidth","tlineWidth","maxWidth","viewFn","h1","twidth","keydownEventHandler","altKey","shiftKey","checkChooserTrigger","arrowExits","viaF2","moveCursorFn","setTimeout","toggleChooserHint","itxt","selectionEnd","ntxt","setSelectionRange","initialText","stopImmediatePropagation","setText","position","preventFocus","blur","Editor","choosers","spreadsheet","editor_classCallCheck","suggest","start","lastIndexOf","sit","eit","indexOf","datepicker","dateFormat","search","htmlFormulaOverlay","bindInputEvents","isOn","onClearActions","act","setItems","hideChooserHint","suggestPosition","elOffset","sOffset","idxStart","idxEnd","selectionStart","activeElement","selection","end","hint","currentChooser","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","chooser","chooserHint","getHint","showChooserHint","chooserHintEl","currentChooserHint","_unused","_unused2","triggers","trigger","ctrlOrMeta","metaKey","alt","res","onTriggered","cursorPosition","setCursorPosition","formulaHtml","Button","button_classCallCheck","button_possibleConstructorReturn","button_getPrototypeOf","dpr","thinLineWidth","npx","px","revNpx","npxLine","DrawBox","padding","draw_classCallCheck","borderTop","borderRight","borderBottom","borderLeft","drawFontLine","tx","ty","blheight","blwidth","floffset","Draw","clickableElementFinders","clickableElementsContainer","ctx","getContext","resize","scale","clearRect","options","beginPath","restore","clip","fillRect","fillText","attr","measureText","mtxt","box","textWrap","clipX","clipY","areaId","scrollX","scrollY","frozenWidth","frozenHeight","missingHeightCb","_align","baseTx","textx","textBaseline","fillStyle","strokeStyle","biw","innerWidth","ntxts","_it","_this$parseClickableE2","draw_slicedToArray","parseClickableElements","texts","txtWidth","getTextWidth","textLine","lastSpaceIdx","wAfterLastSpace","segments","getTextSegments","cw","txtHeight","totalTextHeight","boxInnerHeight","innerHeight","boxTotalHeight","missingBoxHeight","ceil","requiredBoxTotalHeight","texty","dx","textWidths","newEl","finder","render","elem","elem2","boxX","boxY","clipLeft","clipTop","floor","dt","onCtrlClick","prevLen","dataStart","dataEnd","d1","d2","els","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","found","draw_toConsumableArray","_iterator3","idxsToRemove","el2","prevEnd","forEl","leftPartial","repeat","extraPreSpaces","extraPostSpaces","newText","lineWidth","setLineDash","moveTo","lineTo","stroke","topxys","rightxys","bottomxys","leftxys","sx","sy","closePath","dtextcb","addExtraPaddingTop","addExtraPaddingLeft","baseFonts","fontSizes","pt","getFontSizePxByPt","baseFormulas","ary","reduce","formula_toConsumableArray","formula_slicedToArray","f","every","some","formulam","addCustomFormula","infixExprToSuffixExpr","operatorStack","stack","subStrs","fnArgType","fnArgOperator","fnArgsLens","oldc","c1","cell_slicedToArray","ex","ey","rangelen","isFormulaName","nc","startIdx","endIdx","getClosingBracketIndex","inner","cell_toConsumableArray","depth","evalSubExpr","subExpr","cellRender","fl","expr","cellValue","evalSuffixExpr","srcStack","formulaMap","cellList","fc","_expr","params","reverse","isFormulaSyntaxValid","core_cell","getCellText","formatStringRender","formatNumberRender","_v1$split2","format_toArray","first","parts","format_toConsumableArray","baseFormats","formatm","cellPaddingWidth","tableGridStyle","getDrawBox","rindex","yoffset","_data$cellRect","renderCell","draw","renderedBorders","nrindex","highlightInfo","highlightFormulaCells","find","coords","getHighlightInfo","frozen","evalPaused","_cell","getCellTextOrDefault","customFormatter","prepareCellStyle","dbox","skipRightBorder","styleBorder","setBorders","strokeBorders","borderStyle","prevBottomBorder","prevRightBorder","formatCellText","sheet","resizeRowAfterClearingEditor","getError","renderContent","fw","fh","exceptRowTotalHeight","filteredTranslateFunc","clipRect","eachMergesInView","afRange","dropdown","renderSelectedHeaderCell","renderFixedHeaders","nty","ntx","_data$selector$range","textAlign","rowEach","colEach","renderContentGrid","ch","Table","clickableElementsInner","table_classCallCheck","getClickableElementFinders","_data$scroll","_data$freeze","table_slicedToArray","vr","freezeViewRange","ftw","fth","theight","PAGER_SIZES","PAGER_ORIENTATIONS","inches2px","inc","btnClick","toPrint","Print","print_classCallCheck","paper","print_toConsumableArray","ps","preview","iwidth","iheight","contentRange","pages","canvases","mViewRange","th","yo","canvas","rh","yof","contentWindow","idoc","head","cloneNode","drawImage","menuItems","buildMenu","processedMenuItems","contextMenuOptions","callback","targetRange","ContextMenu","isHideForRange","contextmenu_classCallCheck","contextmenu_toConsumableArray","setTargetRange","hideEl","getItemByKey","isVisibleCallback","toggleShowElements","toggleShowSingleColumnElements","toggleShowMultiColumnElements","toggleShowSingleRowElements","toggleShowMultiRowElements","hasPrevVisibleItem","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","elements","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","element","origElements","querySelectorAll","vhf","Item","shortcut","item_classCallCheck","tip","_target$getBoundingCl","elBox","tooltip","DropdownItem","dd","getValue","_get","dropdown_item_getPrototypeOf","setTitle","Dropdown","showArrow","placement","dropdown_classCallCheck","dropdown_possibleConstructorReturn","dropdown_getPrototypeOf","headerClick","setContentChildren","headerEl","_this$contentEl","DropdownAlign","aligns","_getPrototypeOf2","dropdown_align_classCallCheck","icon","naligns","iconName","dropdown_align_possibleConstructorReturn","dropdown_align_getPrototypeOf","dropdown_align_toConsumableArray","setName","Align","align_classCallCheck","align_possibleConstructorReturn","align_getPrototypeOf","Valign","valign_classCallCheck","valign_possibleConstructorReturn","valign_getPrototypeOf","ToggleItem","toggle_item_get","toggle_item_getPrototypeOf","hasClass","Autofilter","autofilter_classCallCheck","autofilter_possibleConstructorReturn","autofilter_getPrototypeOf","Bold","bold_classCallCheck","bold_possibleConstructorReturn","bold_getPrototypeOf","Italic","italic_classCallCheck","italic_possibleConstructorReturn","italic_getPrototypeOf","Strike","strike_classCallCheck","strike_possibleConstructorReturn","strike_getPrototypeOf","Underline","underline_classCallCheck","underline_possibleConstructorReturn","underline_getPrototypeOf","themeColorPlaceHolders","themeColors","standardColors","highlightColors","buildTd","ColorPalette","_h4","color_palette_classCallCheck","table","color_palette_toConsumableArray","_h3","DropdownColor","dropdown_color_classCallCheck","colorPalette","dropdown_color_possibleConstructorReturn","dropdown_color_getPrototypeOf","lineTypes","DropdownLineType","dropdown_linetype_classCallCheck","beforei","lineTypeEls","iti","dropdown_linetype_possibleConstructorReturn","dropdown_linetype_getPrototypeOf","dropdown_linetype_toConsumableArray","buildTable","BorderPalette","border_palette_classCallCheck","ddColor","ddType","border_palette_slicedToArray","border_palette_toConsumableArray","DropdownBorder","dropdown_border_classCallCheck","borderPalette","dropdown_border_possibleConstructorReturn","dropdown_border_getPrototypeOf","Border","border_classCallCheck","border_possibleConstructorReturn","border_getPrototypeOf","IconItem","icon_item_get","icon_item_getPrototypeOf","Clearformat","clearformat_classCallCheck","clearformat_possibleConstructorReturn","clearformat_getPrototypeOf","Paintformat","paintformat_classCallCheck","paintformat_possibleConstructorReturn","paintformat_getPrototypeOf","TextColor","text_color_classCallCheck","text_color_possibleConstructorReturn","text_color_getPrototypeOf","FillColor","fill_color_classCallCheck","fill_color_possibleConstructorReturn","fill_color_getPrototypeOf","DropdownFontSize","dropdown_fontsize_classCallCheck","nfontSizes","dropdown_fontsize_possibleConstructorReturn","dropdown_fontsize_getPrototypeOf","dropdown_fontsize_toConsumableArray","Format","font_size_classCallCheck","font_size_possibleConstructorReturn","font_size_getPrototypeOf","DropdownFontsize","DropdownFont","dropdown_font_classCallCheck","nfonts","dropdown_font_possibleConstructorReturn","dropdown_font_getPrototypeOf","dropdown_font_toConsumableArray","Font","font_classCallCheck","font_possibleConstructorReturn","font_getPrototypeOf","DropdownFormat","dropdown_format_classCallCheck","nformats","dropdown_format_possibleConstructorReturn","dropdown_format_getPrototypeOf","dropdown_format_toConsumableArray","format_classCallCheck","format_possibleConstructorReturn","format_getPrototypeOf","DropdownFormula","dropdown_formula_classCallCheck","nformulas","dropdown_formula_possibleConstructorReturn","dropdown_formula_getPrototypeOf","dropdown_formula_toConsumableArray","formula_classCallCheck","formula_possibleConstructorReturn","formula_getPrototypeOf","Freeze","freeze_classCallCheck","freeze_possibleConstructorReturn","freeze_getPrototypeOf","Merge","toolbar_merge_classCallCheck","merge_possibleConstructorReturn","merge_getPrototypeOf","Redo","redo_classCallCheck","redo_possibleConstructorReturn","redo_getPrototypeOf","Undo","undo_classCallCheck","undo_possibleConstructorReturn","undo_getPrototypeOf","toolbar_print_classCallCheck","print_possibleConstructorReturn","print_getPrototypeOf","Textwrap","textwrap_classCallCheck","textwrap_possibleConstructorReturn","textwrap_getPrototypeOf","DropdownMore","more_classCallCheck","moreBtns","more_possibleConstructorReturn","more_getPrototypeOf","More","buildDivider","moreResize","_btns$html","_moreBtns$html","btns","moreEl","btns2","_moreEl$dd","widthFn","sumWidth2","list1","list2","toolbar_slicedToArray","genBtn","btn","onClick","Toolbar","toolbar_classCallCheck","ts","createItem","undoEl","redoEl","paintformatEl","clearformatEl","formatEl","fontEl","fontSizeEl","FontSize","boldEl","italicEl","underlineEl","strikeEl","textColorEl","fillColorEl","borderEl","mergeEl","alignEl","valignEl","textwrapEl","freezeEl","autofilterEl","formulaEl","Formula","prevIsBlock","nextIsBlock","removeNullToolbarItems","_data$settings$extend","extendToolbar","reset","_el$computedStyle","computedStyle","marginLeft","marginRight","_it$computedStyle","creatorFunc","returnCondition","checkMergeWarning","setState","Promise","resolve","confirm","getSelectedCellStyle","getSelectedCell","hAlign","trim","canUnmerge","canAutofilter","freezeIsActive","FormulaBar","formulaBarOptions","onInputCallback","formulabar_classCallCheck","inputEl","selectionInfoEl","readOnly","textContent","Modal","modal_classCallCheck","modal_toConsumableArray","dimmer","_this$el$show$box","_document$documentEle","xkeydownEsc","FormInput","form_input_classCallCheck","vchange","FormSelect","getTitle","form_select_classCallCheck","itemEl","patterns","FormField","rule","labelWidth","form_field_classCallCheck","pattern","fieldLabelWidth","ModalValidation","modal_validation_classCallCheck","mf","rf","cf","criteriaSelected","criteriaOperatorSelected","minvf","maxvf","svf","vf","modal_validation_possibleConstructorReturn","modal_validation_getPrototypeOf","action","attrs","field","isShow","clsName","buildSortItem","resetFilterHeader","filterhEl","filterValues","checked","SortFilter","sort_filter_classCallCheck","filterbEl","filterClick","sortAscEl","sortDescEl","sortDesc","tindex","xtoast","_el$box","throttle","func","wait","timeout","that","selectorSet","updateSelectionInfo","updateContextMenuTargetRange","selectorMove","direction","_selector$indexes","sheet_slicedToArray","_selector$moveIndexes","verticalScrollbar","horizontalScrollbar","_data$getSelectedRect","tableOffset","getTableOffset","verticalScrollbarSet","erth","horizontalScrollbarSet","sheetReset","tableEl","overlayerEl","overlayerCEl","tOffset","vRect","editor","fwidth","fheight","setFreezeLengths","clearClipboard","copyToSystemClipboard","cdata","execPaste","canPasteInternal","parsedData","msg","sheet_typeof","pasteFromText","pasteFromObj","selectedCell","selectedCellText","cdataNew","unhideRowsOrCols","overlayerMousedown","sortFilter","offsetX","offsetY","isSelectingCellsForFormula","closest","clientX","clientY","isAutofillEl","getCellRectByXY","getSort","isColumnHeaderClick","isRowHeaderClick","isSelectedColumnHeaderClick","isSelectedRowHeaderClick","isSelectedHeaderRightClick","_data$getCellRectByXY","paintformatActive","paintformatToggle","editorSetOffset","sPosition","editorSet","getSelectedValidator","updateHighlightedFormulaReferences","rowResizerFinished","_ri","setRowHeight","dataSetCellText","setSelectedCellText","_data$selector","insertDeleteRowColumn","nSelectedRows","nSelectedCols","needsEnsuringSelectorInSheet","nCols","nRows","sci2","eci2","sri2","eri2","toolbarChange","_data$selector2","sheetInitEvents","startx","starty","rowResizer","colResizer","modalValidation","tRect","showUnhide","formulaCellRow","formulaCellCol","editorCursorPos","isEnteringFormula","getCursorPosition","xyInSelectedRect","setPosition","overlayerMouseup","col0","col1","row0","row1","isConstXY","rangeStart","rangeEnd","rangeText","injectText","setSelectedRange","deltaY","deltaX","loopValue","vFunc","moveY","tempY","tempX","temp","horizontal","moveX","_evt$touches$","touches","pageX","pageY","_evt$changedTouches$","changedTouches","_evt$changedTouches$2","setAutoFilter","_ci","setColWidth","scrolly","resetBRLAreaOffset","scrollx","resetBRTAreaOffset","itext","_this6$data","addValidation","removeValidation","getSelectedValidation","hideRowsOrCols","reload","focusing","spreadsheetEl","which","Sheet","targetEl","sheet_classCallCheck","eventMap","listeners","currentListener","removeListener","current","once","execCalllback","fire","event_toConsumableArray","removeAllListeners","createEventEmitter","_data$settings","getChoosers","_len3","_key3","resetData","setFreeze","_this$data","_this$getRect","setSelectedCellCustomFormatter","clearSelectedCellCustomFormatter","numericValues","parseFloat","setSelectionInfoText","curr","avg","formatNumber","num","round","sumStr","avgStr","matches","sheet_toConsumableArray","matchAll","nextColorIndex","deltaPos","_str$split$map2","prefix","suffix","prevLength","newLength","setFormulaHtml","rng","bottombar_classCallCheck","bottombar_possibleConstructorReturn","bottombar_getPrototypeOf","contentClick","bottombar_toConsumableArray","_h$css","Bottombar","addFunc","swapFunc","deleteFunc","updateFunc","dataNames","activeEl","deleteEl","clickSwap2","menuEl","nindex","renameItem","clickSwap","bottombar_slicedToArray","addClickableElementFinder","addChooser","Spreadsheet","selectors","src_classCallCheck","_objectSpread","sheetIndex","datas","querySelector","bottombar","addSheet","rootEl","xSpreadsheetCtrlKeyListener","isBodyClassSet","hasCtrlKey","_this2$sheet","addItem","_this$bottombar$delet2","src_slicedToArray","deleteItem","oldIndex","ds","nd"],"mappings":"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","file":"xspreadsheet.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","/* global document */\n/* global window */\nclass Element {\n  constructor(tag, className = '') {\n    if (typeof tag === 'string') {\n      this.el = document.createElement(tag);\n      this.el.className = className;\n    } else {\n      this.el = tag;\n    }\n    this.data = {};\n  }\n\n  data(key, value) {\n    if (value !== undefined) {\n      this.data[key] = value;\n      return this;\n    }\n    return this.data[key];\n  }\n\n  on(eventNames, handler) {\n    const [fen, ...oen] = eventNames.split('.');\n    let eventName = fen;\n    if (eventName === 'mousewheel' && /Firefox/i.test(window.navigator.userAgent)) {\n      eventName = 'DOMMouseScroll';\n    }\n    this.el.addEventListener(eventName, (evt) => {\n      handler(evt);\n      for (let i = 0; i < oen.length; i += 1) {\n        const k = oen[i];\n        if (k === 'left' && evt.button !== 0) {\n          return;\n        }\n        if (k === 'right' && evt.button !== 2) {\n          return;\n        }\n        if (k === 'stop') {\n          evt.stopPropagation();\n        }\n      }\n    });\n    return this;\n  }\n\n  offset(value) {\n    if (value !== undefined) {\n      Object.keys(value).forEach((k) => {\n        this.css(k, `${value[k]}px`);\n      });\n      return this;\n    }\n    const {\n      offsetTop, offsetLeft, offsetHeight, offsetWidth,\n    } = this.el;\n    return {\n      top: offsetTop,\n      left: offsetLeft,\n      height: offsetHeight,\n      width: offsetWidth,\n    };\n  }\n\n  scroll(v) {\n    const { el } = this;\n    if (v !== undefined) {\n      if (v.left !== undefined) {\n        el.scrollLeft = v.left;\n      }\n      if (v.top !== undefined) {\n        el.scrollTop = v.top;\n      }\n    }\n    return { left: el.scrollLeft, top: el.scrollTop };\n  }\n\n  box() {\n    return this.el.getBoundingClientRect();\n  }\n\n  parent() {\n    return new Element(this.el.parentNode);\n  }\n\n  children(...eles) {\n    if (arguments.length === 0) {\n      return this.el.childNodes;\n    }\n    eles.forEach(ele => this.child(ele));\n    return this;\n  }\n\n  removeChild(el) {\n    this.el.removeChild(el);\n  }\n\n  /*\n  first() {\n    return this.el.firstChild;\n  }\n\n  last() {\n    return this.el.lastChild;\n  }\n\n  remove(ele) {\n    return this.el.removeChild(ele);\n  }\n\n  prepend(ele) {\n    const { el } = this;\n    if (el.children.length > 0) {\n      el.insertBefore(ele, el.firstChild);\n    } else {\n      el.appendChild(ele);\n    }\n    return this;\n  }\n\n  prev() {\n    return this.el.previousSibling;\n  }\n\n  next() {\n    return this.el.nextSibling;\n  }\n  */\n\n  child(arg) {\n    let ele = arg;\n    if (typeof arg === 'string') {\n      ele = document.createTextNode(arg);\n    } else if (arg instanceof Element) {\n      ele = arg.el;\n    }\n    this.el.appendChild(ele);\n    return this;\n  }\n\n  contains(ele) {\n    return this.el.contains(ele);\n  }\n\n  className(v) {\n    if (v !== undefined) {\n      this.el.className = v;\n      return this;\n    }\n    return this.el.className;\n  }\n\n  addClass(name) {\n    this.el.classList.add(name);\n    return this;\n  }\n\n  hasClass(name) {\n    return this.el.classList.contains(name);\n  }\n\n  removeClass(name) {\n    this.el.classList.remove(name);\n    return this;\n  }\n\n  toggle(cls = 'active') {\n    return this.toggleClass(cls);\n  }\n\n  toggleClass(name) {\n    return this.el.classList.toggle(name);\n  }\n\n  active(flag = true, cls = 'active') {\n    if (flag) this.addClass(cls);\n    else this.removeClass(cls);\n    return this;\n  }\n\n  checked(flag = true) {\n    this.active(flag, 'checked');\n    return this;\n  }\n\n  disabled(flag = true) {\n    if (flag) this.addClass('disabled');\n    else this.removeClass('disabled');\n    return this;\n  }\n\n  // key, value\n  // key\n  // {k, v}...\n  attr(key, value) {\n    if (value !== undefined) {\n      this.el.setAttribute(key, value);\n    } else {\n      if (typeof key === 'string') {\n        return this.el.getAttribute(key);\n      }\n      Object.keys(key).forEach((k) => {\n        this.el.setAttribute(k, key[k]);\n      });\n    }\n    return this;\n  }\n\n  removeAttr(key) {\n    this.el.removeAttribute(key);\n    return this;\n  }\n\n  html(content) {\n    if (content !== undefined) {\n      this.el.innerHTML = content;\n      return this;\n    }\n    return this.el.innerHTML;\n  }\n\n  val(v) {\n    if (v !== undefined) {\n      this.el.value = v;\n      return this;\n    }\n    return this.el.value;\n  }\n\n  focus() {\n    this.el.focus();\n  }\n\n  cssRemoveKeys(...keys) {\n    keys.forEach(k => this.el.style.removeProperty(k));\n    return this;\n  }\n\n  // css( propertyName )\n  // css( propertyName, value )\n  // css( properties )\n  css(name, value) {\n    if (value === undefined && typeof name !== 'string') {\n      Object.keys(name).forEach((k) => {\n        this.el.style[k] = name[k];\n      });\n      return this;\n    }\n    if (value !== undefined) {\n      this.el.style[name] = value;\n      return this;\n    }\n    return this.el.style[name];\n  }\n\n  computedStyle() {\n    return window.getComputedStyle(this.el, null);\n  }\n\n  show() {\n    this.css('display', 'block');\n    return this;\n  }\n\n  hide() {\n    this.css('display', 'none');\n    return this;\n  }\n  \n  isHidden() {\n    return this.css('display') === 'none';\n  }\n}\n\nconst h = (tag, className = '') => new Element(tag, className);\n\nexport {\n  Element,\n  h,\n};\n","import './_.prototypes';\n\nconst alphabets = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\n\n/** index number 2 letters\n * @example stringAt(26) ==> 'AA'\n * @date 2019-10-10\n * @export\n * @param {number} index\n * @returns {string}\n */\nexport function stringAt(index) {\n  let str = '';\n  let cindex = index;\n  while (cindex >= alphabets.length) {\n    cindex /= alphabets.length;\n    cindex -= 1;\n    str += alphabets[parseInt(cindex, 10) % alphabets.length];\n  }\n  const last = index % alphabets.length;\n  str += alphabets[last];\n  return str;\n}\n\n/** translate letter in A1-tag to number\n * @date 2019-10-10\n * @export\n * @param {string} str \"AA\" in A1-tag \"AA1\"\n * @returns {number}\n */\nexport function indexAt(str) {\n  let ret = 0;\n  str = str.toUpperCase();\n  for (let i = 0; i < str.length - 1; i += 1) {\n    const cindex = str.charCodeAt(i) - 65;\n    const exponet = str.length - 1 - i;\n    ret += (alphabets.length ** exponet) + (alphabets.length * cindex);\n  }\n  ret += str.charCodeAt(str.length - 1) - 65;\n  return ret;\n}\n\n// B10 => x,y\n/** translate A1-tag to XY-tag\n * @date 2019-10-10\n * @export\n * @param {tagA1} src\n * @returns {tagXY}\n */\nexport function expr2xy(src) {\n  let x = '';\n  let y = '';\n  src = src.replace(/\\$/g, '');\n  for (let i = 0; i < src.length; i += 1) {\n    if (src.charAt(i) >= '0' && src.charAt(i) <= '9') {\n      y += src.charAt(i);\n    } else {\n      x += src.charAt(i);\n    }\n  }\n  return [indexAt(x), parseInt(y, 10) - 1];\n}\n\n/** translate XY-tag to A1-tag\n * @example x,y => B10\n * @date 2019-10-10\n * @export\n * @param {number} x\n * @param {number} y\n * @param {boolean} isConstX\n * @param {boolean} isConstY\n * @returns {tagA1}\n */\nexport function xy2expr(x, y, isConstX, isConstY) {\n  return `${isConstX ? '$' : ''}${stringAt(x)}${isConstY ? '$' : ''}${y + 1}`;\n}\n\n/** translate A1-tag src by (xn, yn)\n * @date 2019-10-10\n * @export\n * @param {tagA1} src\n * @param {number} xn\n * @param {number} yn\n * @param {function} condition\n * @param {boolean} isConstX\n * @param {boolean} isConstY\n * @returns {tagA1}\n */\nexport function expr2expr(src, xn, yn, condition = () => true, isConstX, isConstY) {\n  if (xn === 0 && yn === 0) return src;\n  const [x, y] = expr2xy(src);\n  if (!condition(x, y)) return src;\n  return xy2expr(x + xn, y + yn, isConstX, isConstY);\n}\n\nexport default {\n  stringAt,\n  indexAt,\n  expr2xy,\n  xy2expr,\n  expr2expr,\n};\n","import { xy2expr, expr2xy } from './alphabet';\n\nclass CellRange {\n  constructor(sri, sci, eri, eci, w = 0, h = 0) {\n    this.sri = sri;\n    this.sci = sci;\n    this.eri = eri;\n    this.eci = eci;\n    this.w = w;\n    this.h = h;\n  }\n\n  set(sri, sci, eri, eci) {\n    this.sri = sri;\n    this.sci = sci;\n    this.eri = eri;\n    this.eci = eci;\n  }\n\n  multiple() {\n    return this.eri - this.sri > 0 || this.eci - this.sci > 0;\n  }\n\n  // cell-index: ri, ci\n  // cell-ref: A10\n  includes(...args) {\n    let [ri, ci] = [0, 0];\n    if (args.length === 1) {\n      [ci, ri] = expr2xy(args[0]);\n    } else if (args.length === 2) {\n      [ri, ci] = args;\n    }\n    const {\n      sri, sci, eri, eci,\n    } = this;\n    return sri <= ri && ri <= eri && sci <= ci && ci <= eci;\n  }\n\n  each(cb, rowFilter = () => true) {\n    const {\n      sri, sci, eri, eci,\n    } = this;\n    for (let i = sri; i <= eri; i += 1) {\n      if (rowFilter(i)) {\n        for (let j = sci; j <= eci; j += 1) {\n          cb(i, j);\n        }\n      }\n    }\n  }\n\n  contains(other) {\n    return this.sri <= other.sri\n      && this.sci <= other.sci\n      && this.eri >= other.eri\n      && this.eci >= other.eci;\n  }\n\n  // within\n  within(other) {\n    return this.sri >= other.sri\n      && this.sci >= other.sci\n      && this.eri <= other.eri\n      && this.eci <= other.eci;\n  }\n\n  // disjoint\n  disjoint(other) {\n    return this.sri > other.eri\n      || this.sci > other.eci\n      || other.sri > this.eri\n      || other.sci > this.eci;\n  }\n\n  // intersects\n  intersects(other) {\n    return this.sri <= other.eri\n      && this.sci <= other.eci\n      && other.sri <= this.eri\n      && other.sci <= this.eci;\n  }\n\n  // union\n  union(other) {\n    const {\n      sri, sci, eri, eci,\n    } = this;\n    return new CellRange(\n      other.sri < sri ? other.sri : sri,\n      other.sci < sci ? other.sci : sci,\n      other.eri > eri ? other.eri : eri,\n      other.eci > eci ? other.eci : eci,\n    );\n  }\n\n  // intersection\n  // intersection(other) {}\n\n  // Returns Array<CellRange> that represents that part of this that does not intersect with other\n  // difference\n  difference(other) {\n    const ret = [];\n    const addRet = (sri, sci, eri, eci) => {\n      ret.push(new CellRange(sri, sci, eri, eci));\n    };\n    const {\n      sri, sci, eri, eci,\n    } = this;\n    const dsr = other.sri - sri;\n    const dsc = other.sci - sci;\n    const der = eri - other.eri;\n    const dec = eci - other.eci;\n    if (dsr > 0) {\n      addRet(sri, sci, other.sri - 1, eci);\n      if (der > 0) {\n        addRet(other.eri + 1, sci, eri, eci);\n        if (dsc > 0) {\n          addRet(other.sri, sci, other.eri, other.sci - 1);\n        }\n        if (dec > 0) {\n          addRet(other.sri, other.eci + 1, other.eri, eci);\n        }\n      } else {\n        if (dsc > 0) {\n          addRet(other.sri, sci, eri, other.sci - 1);\n        }\n        if (dec > 0) {\n          addRet(other.sri, other.eci + 1, eri, eci);\n        }\n      }\n    } else if (der > 0) {\n      addRet(other.eri + 1, sci, eri, eci);\n      if (dsc > 0) {\n        addRet(sri, sci, other.eri, other.sci - 1);\n      }\n      if (dec > 0) {\n        addRet(sri, other.eci + 1, other.eri, eci);\n      }\n    }\n    if (dsc > 0) {\n      addRet(sri, sci, eri, other.sci - 1);\n      if (dec > 0) {\n        addRet(sri, other.eri + 1, eri, eci);\n        if (dsr > 0) {\n          addRet(sri, other.sci, other.sri - 1, other.eci);\n        }\n        if (der > 0) {\n          addRet(other.sri + 1, other.sci, eri, other.eci);\n        }\n      } else {\n        if (dsr > 0) {\n          addRet(sri, other.sci, other.sri - 1, eci);\n        }\n        if (der > 0) {\n          addRet(other.sri + 1, other.sci, eri, eci);\n        }\n      }\n    } else if (dec > 0) {\n      addRet(eri, other.eci + 1, eri, eci);\n      if (dsr > 0) {\n        addRet(sri, sci, other.sri - 1, other.eci);\n      }\n      if (der > 0) {\n        addRet(other.eri + 1, sci, eri, other.eci);\n      }\n    }\n    return ret;\n  }\n\n  size() {\n    return [\n      this.eri - this.sri + 1,\n      this.eci - this.sci + 1,\n    ];\n  }\n\n  toString() {\n    const {\n      sri, sci, eri, eci,\n    } = this;\n    let ref = xy2expr(sci, sri);\n    if (this.multiple()) {\n      ref = `${ref}:${xy2expr(eci, eri)}`;\n    }\n    return ref;\n  }\n\n  clone() {\n    const {\n      sri, sci, eri, eci, w, h,\n    } = this;\n    return new CellRange(sri, sci, eri, eci, w, h);\n  }\n\n  /*\n  toJSON() {\n    return this.toString();\n  }\n  */\n\n  equals(other) {\n    return this.eri === other.eri\n      && this.eci === other.eci\n      && this.sri === other.sri\n      && this.sci === other.sci;\n  }\n\n  static valueOf(ref) {\n    // B1:B8, B1 => 1 x 1 cell range\n    const refs = ref.split(':');\n    const [sci, sri] = expr2xy(refs[0]);\n    let [eri, eci] = [sri, sci];\n    if (refs.length > 1) {\n      [eci, eri] = expr2xy(refs[1]);\n    }\n    return new CellRange(sri, sci, eri, eci);\n  }\n}\n\nexport default CellRange;\n\nexport {\n  CellRange,\n};\n","import { CellRange } from './cell_range';\n\nexport default class Selector {\n  constructor() {\n    this.range = new CellRange(0, 0, 0, 0);\n    this.ri = 0;\n    this.ci = 0;\n  }\n\n  multiple() {\n    return this.range.multiple();\n  }\n\n  setIndexes(ri, ci) {\n    this.ri = ri;\n    this.ci = ci;\n  }\n\n  size() {\n    return this.range.size();\n  }\n}\n","export default class Scroll {\n  constructor() {\n    this.x = 0; // left\n    this.y = 0; // top\n    this.ri = 0; // cell row-index\n    this.ci = 0; // cell col-index\n  }\n}\n","// import helper from '../helper';\n\nexport default class History {\n  constructor() {\n    this.undoItems = [];\n    this.redoItems = [];\n  }\n\n  add(data) {\n    this.undoItems.push(JSON.stringify(data));\n    this.redoItems = [];\n  }\n\n  canUndo() {\n    return this.undoItems.length > 0;\n  }\n\n  canRedo() {\n    return this.redoItems.length > 0;\n  }\n\n  undo(currentd, cb) {\n    const { undoItems, redoItems } = this;\n    if (this.canUndo()) {\n      redoItems.push(JSON.stringify(currentd));\n      cb(JSON.parse(undoItems.pop()));\n    }\n  }\n\n  redo(currentd, cb) {\n    const { undoItems, redoItems } = this;\n    if (this.canRedo()) {\n      undoItems.push(JSON.stringify(currentd));\n      cb(JSON.parse(redoItems.pop()));\n    }\n  }\n}\n","export default class Clipboard {\n  constructor() {\n    this.range = null; // CellRange\n    this.state = 'clear';\n  }\n\n  copy(cellRange) {\n    this.range = cellRange;\n    this.state = 'copy';\n    return this;\n  }\n\n  cut(cellRange) {\n    this.range = cellRange;\n    this.state = 'cut';\n    return this;\n  }\n\n  isCopy() {\n    return this.state === 'copy';\n  }\n\n  isCut() {\n    return this.state === 'cut';\n  }\n\n  isClear() {\n    return this.state === 'clear';\n  }\n\n  clear() {\n    this.range = null;\n    this.state = 'clear';\n  }\n}\n","import { CellRange } from './cell_range';\n// operator: all|eq|neq|gt|gte|lt|lte|in|be\n// value:\n//   in => []\n//   be => [min, max]\nclass Filter {\n  constructor(ci, operator, value) {\n    this.ci = ci;\n    this.operator = operator;\n    this.value = value;\n  }\n\n  set(operator, value) {\n    this.operator = operator;\n    this.value = value;\n  }\n\n  includes(v) {\n    const { operator, value } = this;\n    if (operator === 'all') {\n      return true;\n    }\n    if (operator === 'in') {\n      return value.includes(v);\n    }\n    return false;\n  }\n\n  vlength() {\n    const { operator, value } = this;\n    if (operator === 'in') {\n      return value.length;\n    }\n    return 0;\n  }\n\n  getData() {\n    const { ci, operator, value } = this;\n    return { ci, operator, value };\n  }\n}\n\nclass Sort {\n  constructor(ci, order) {\n    this.ci = ci;\n    this.order = order;\n  }\n\n  asc() {\n    return this.order === 'asc';\n  }\n\n  desc() {\n    return this.order === 'desc';\n  }\n}\n\nexport default class AutoFilter {\n  constructor() {\n    this.ref = null;\n    this.filters = [];\n    this.sort = null;\n  }\n\n  setData({ ref, filters, sort }) {\n    if (ref != null) {\n      this.ref = ref;\n      this.filters = filters.map(it => new Filter(it.ci, it.operator, it.value));\n      if (sort) {\n        this.sort = new Sort(sort.ci, sort.order);\n      }\n    }\n  }\n\n  getData() {\n    if (this.active()) {\n      const { ref, filters, sort } = this;\n      return { ref, filters: filters.map(it => it.getData()), sort };\n    }\n    return {};\n  }\n\n  addFilter(ci, operator, value) {\n    const filter = this.getFilter(ci);\n    if (filter == null) {\n      this.filters.push(new Filter(ci, operator, value));\n    } else {\n      filter.set(operator, value);\n    }\n  }\n\n  setSort(ci, order) {\n    this.sort = order ? new Sort(ci, order) : null;\n  }\n\n  includes(ri, ci) {\n    if (this.active()) {\n      return this.hrange().includes(ri, ci);\n    }\n    return false;\n  }\n\n  getSort(ci) {\n    const { sort } = this;\n    if (sort && sort.ci === ci) {\n      return sort;\n    }\n    return null;\n  }\n\n  getFilter(ci) {\n    const { filters } = this;\n    for (let i = 0; i < filters.length; i += 1) {\n      if (filters[i].ci === ci) {\n        return filters[i];\n      }\n    }\n    return null;\n  }\n\n  filteredRows(getCell) {\n    // const ary = [];\n    // let lastri = 0;\n    const rset = new Set();\n    const fset = new Set();\n    if (this.active()) {\n      const { sri, eri } = this.range();\n      const { filters } = this;\n      for (let ri = sri + 1; ri <= eri; ri += 1) {\n        for (let i = 0; i < filters.length; i += 1) {\n          const filter = filters[i];\n          const cell = getCell(ri, filter.ci);\n          const ctext = cell ? cell.text : '';\n          if (!filter.includes(ctext)) {\n            rset.add(ri);\n            break;\n          } else {\n            fset.add(ri);\n          }\n        }\n      }\n    }\n    return { rset, fset };\n  }\n\n  items(ci, getCell) {\n    const m = {};\n    if (this.active()) {\n      const { sri, eri } = this.range();\n      for (let ri = sri + 1; ri <= eri; ri += 1) {\n        const cell = getCell(ri, ci);\n        if (cell !== null && !/^\\s*$/.test(cell.text)) {\n          const key = cell.text;\n          const cnt = (m[key] || 0) + 1;\n          m[key] = cnt;\n        } else {\n          m[''] = (m[''] || 0) + 1;\n        }\n      }\n    }\n    return m;\n  }\n\n  range() {\n    return CellRange.valueOf(this.ref);\n  }\n\n  hrange() {\n    const r = this.range();\n    r.eri = r.sri;\n    return r;\n  }\n\n  clear() {\n    this.ref = null;\n    this.filters = [];\n    this.sort = null;\n  }\n\n  active() {\n    return this.ref !== null;\n  }\n}\n","import { CellRange } from './cell_range';\n\nclass Merges {\n  constructor(d = []) {\n    this._ = d;\n  }\n\n  forEach(cb) {\n    this._.forEach(cb);\n  }\n\n  deleteWithin(cr) {\n    this._ = this._.filter(it => !it.within(cr));\n  }\n\n  getFirstIncludes(ri, ci) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const it = this._[i];\n      if (it.includes(ri, ci)) {\n        return it;\n      }\n    }\n    return null;\n  }\n\n  filterIntersects(cellRange) {\n    return new Merges(this._.filter(it => it.intersects(cellRange)));\n  }\n\n  intersects(cellRange) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const it = this._[i];\n      if (it.intersects(cellRange)) {\n        // console.log('intersects');\n        return true;\n      }\n    }\n    return false;\n  }\n\n  union(cellRange) {\n    let cr = cellRange;\n    this._.forEach((it) => {\n      if (it.intersects(cr)) {\n        cr = it.union(cr);\n      }\n    });\n    return cr;\n  }\n\n  add(cr) {\n    this.deleteWithin(cr);\n    this._.push(cr);\n  }\n\n  // type: row | column\n  shift(type, index, n, cbWithin) {\n    const toRm = [];\n    if (n < 0) {\n      this._.forEach(cellRange => {\n        const {\n          sri, sci, eri, eci,\n        } = cellRange;\n        if (toRm.includes(cellRange)) {\n          return;\n        }\n        if (type === 'row') {\n          if (sri >= index && eri <= (index - n - 1)) {\n            toRm.push(cellRange);\n          }\n        } else if (type === 'column') {\n          if (sci >= index && eci <= (index - n - 1)) {\n            toRm.push(cellRange);\n          }\n        }\n      });\n    }\n    this._ = this._.filter(it => !toRm.includes(it));\n    this._.forEach((cellRange) => {\n      const {\n        sri, sci, eri, eci,\n      } = cellRange;\n      const range = cellRange;\n      if (type === 'row') {\n        if (sri === index) {\n          range.toRm = true;\n        } else if (sri > index) {\n          range.sri += n;\n          range.eri += n;\n        } else if (sri < index && index <= eri) {\n          range.eri += n;\n          cbWithin(sri, sci, n, 0);\n        }\n      } else if (type === 'column') {\n        if (sci === index) {\n          range.toRm = true;\n        } else if (sci >= index) {\n          range.sci += n;\n          range.eci += n;\n        } else if (sci < index && index <= eci) {\n          range.eci += n;\n          cbWithin(sri, sci, 0, n);\n        }\n      }\n    });\n    this._ = this._.filter(it => !it.toRm && (it.sci !== it.eci || it.sri !== it.eri));\n  }\n\n  move(cellRange, rn, cn) {\n    this._.forEach((it1) => {\n      const it = it1;\n      if (it.within(cellRange)) {\n        it.eri += rn;\n        it.sri += rn;\n        it.sci += cn;\n        it.eci += cn;\n      }\n    });\n  }\n\n  setData(merges) {\n    this._ = merges.map(merge => CellRange.valueOf(merge));\n    this.removeBrokenMerges();\n    return this;\n  }\n\n  getData() {\n    this.removeBrokenMerges();\n    return this._.map(merge => merge.toString());\n  }\n  \n  removeBrokenMerges() {\n    this._ = this._.filter(it => it.sci !== it.eci || it.sri !== it.eri);\n  }\n}\n\nexport default {};\nexport {\n  Merges,\n};\n","/* eslint-disable no-param-reassign */\nfunction cloneDeep(obj) {\n  return JSON.parse(JSON.stringify(obj));\n}\n\nconst mergeDeep = (object = {}, ...sources) => {\n  sources.forEach((source) => {\n    Object.keys(source).forEach((key) => {\n      const v = source[key];\n      // console.log('k:', key, ', v:', source[key], typeof v, v instanceof Object);\n      if (typeof v === 'string' || typeof v === 'number' || typeof v === 'boolean') {\n        object[key] = v;\n      } else if (typeof v !== 'function' && !Array.isArray(v) && v instanceof Object) {\n        object[key] = object[key] || {};\n        mergeDeep(object[key], v);\n      } else {\n        object[key] = v;\n      }\n    });\n  });\n  // console.log('::', object);\n  return object;\n};\n\nfunction equals(obj1, obj2) {\n  const keys = Object.keys(obj1);\n  if (keys.length !== Object.keys(obj2).length) return false;\n  for (let i = 0; i < keys.length; i += 1) {\n    const k = keys[i];\n    const v1 = obj1[k];\n    const v2 = obj2[k];\n    if (v2 === undefined) return false;\n    if (typeof v1 === 'string' || typeof v1 === 'number' || typeof v1 === 'boolean') {\n      if (v1 !== v2) return false;\n    } else if (Array.isArray(v1)) {\n      if (v1.length !== v2.length) return false;\n      for (let ai = 0; ai < v1.length; ai += 1) {\n        if (!equals(v1[ai], v2[ai])) return false;\n      }\n    } else if (typeof v1 !== 'function' && !Array.isArray(v1) && v1 instanceof Object) {\n      if (!equals(v1, v2)) return false;\n    }\n  }\n  return true;\n}\n\n/*\n  objOrAry: obejct or Array\n  cb: (value, index | key) => { return value }\n*/\nconst sum = (objOrAry, cb = value => value) => {\n  let total = 0;\n  let size = 0;\n  Object.keys(objOrAry).forEach((key) => {\n    total += cb(objOrAry[key], key);\n    size += 1;\n  });\n  return [total, size];\n};\n\nfunction deleteProperty(obj, property) {\n  const oldv = obj[`${property}`];\n  delete obj[`${property}`];\n  return oldv;\n}\n\nfunction rangeReduceIf(min, max, inits, initv, ifv, getv) {\n  let s = inits;\n  let v = initv;\n  let i = min;\n  for (; i < max; i += 1) {\n    if (s > ifv) break;\n    v = getv(i);\n    s += v;\n  }\n  return [i, s - v, v];\n}\n\nfunction rangeSum(min, max, getv) {\n  let s = 0;\n  for (let i = min; i < max; i += 1) {\n    s += getv(i);\n  }\n  return s;\n}\n\nfunction rangeEach(min, max, cb) {\n  for (let i = min; i < max; i += 1) {\n    cb(i);\n  }\n}\n\nfunction arrayEquals(a1, a2) {\n  if (a1.length === a2.length) {\n    for (let i = 0; i < a1.length; i += 1) {\n      if (a1[i] !== a2[i]) return false;\n    }\n  } else return false;\n  return true;\n}\n\nfunction digits(a) {\n  const v = `${a}`;\n  let ret = 0;\n  let flag = false;\n  for (let i = 0; i < v.length; i += 1) {\n    if (flag === true) ret += 1;\n    if (v.charAt(i) === '.') flag = true;\n  }\n  return ret;\n}\n\nexport function numberCalc(type, a1, a2) {\n  if (Number.isNaN(a1) || Number.isNaN(a2)) {\n    return a1 + type + a2;\n  }\n  const al1 = digits(a1);\n  const al2 = digits(a2);\n  const num1 = Number(a1);\n  const num2 = Number(a2);\n  if (isNaN(num1) || isNaN(num2)) {\n    return Number.NaN;\n  }\n  let ret = 0;\n  if (type === '-') {\n    ret = num1 - num2;\n  } else if (type === '+') {\n    ret = num1 + num2;\n  } else if (type === '*') {\n    ret = num1 * num2;\n  } else if (type === '/') {\n    ret = num1 / num2;\n    if (digits(ret) > 5) return ret.toFixed(2);\n    return ret;\n  }\n  return ret.toFixed(Math.max(al1, al2));\n}\n\nexport default {\n  cloneDeep,\n  merge: (...sources) => mergeDeep({}, ...sources),\n  equals,\n  arrayEquals,\n  sum,\n  rangeEach,\n  rangeSum,\n  rangeReduceIf,\n  deleteProperty,\n  numberCalc,\n};\n","import helper from './helper';\nimport { expr2expr, expr2xy } from './alphabet';\n\nclass Rows {\n  constructor({ len, height }) {\n    this._ = {};\n    this.len = len;\n    // default row height\n    this.height = height;\n  }\n\n  getHeight(ri) {\n    if (this.isHide(ri)) return 0;\n    const row = this.get(ri);\n    if (row && row.height) {\n      return row.height;\n    }\n    return this.height;\n  }\n\n  setHeight(ri, v) {\n    const row = this.getOrNew(ri);\n    row.height = v;\n  }\n\n  unhide(idx) {\n    let index = idx;\n    while (index > 0) {\n      index -= 1;\n      if (this.isHide(index)) {\n        this.setHide(index, false);\n      } else break;\n    }\n  }\n\n  isHide(ri) {\n    const row = this.get(ri);\n    return row && row.hide;\n  }\n\n  setHide(ri, v) {\n    const row = this.getOrNew(ri);\n    if (v === true) row.hide = true;\n    else delete row.hide;\n  }\n\n  setStyle(ri, style) {\n    const row = this.getOrNew(ri);\n    row.style = style;\n  }\n\n  sumHeight(min, max, exceptSet) {\n    return helper.rangeSum(min, max, (i) => {\n      if (exceptSet && exceptSet.has(i)) return 0;\n      return this.getHeight(i);\n    });\n  }\n\n  totalHeight() {\n    return this.sumHeight(0, this.len);\n  }\n\n  get(ri) {\n    return this._[ri];\n  }\n\n  getOrNew(ri) {\n    this._[ri] = this._[ri] || { cells: {} };\n    return this._[ri];\n  }\n\n  getCell(ri, ci) {\n    const row = this.get(ri);\n    if (row !== undefined && row.cells !== undefined && row.cells[ci] !== undefined) {\n      return row.cells[ci];\n    }\n    return null;\n  }\n\n  getCellMerge(ri, ci) {\n    const cell = this.getCell(ri, ci);\n    if (cell && cell.merge) return cell.merge;\n    return [0, 0];\n  }\n\n  getCellOrNew(ri, ci) {\n    const row = this.getOrNew(ri);\n    row.cells[ci] = row.cells[ci] || {};\n    return row.cells[ci];\n  }\n\n  // what: all | text | format\n  setCell(ri, ci, cell, what = 'all') {\n    const row = this.getOrNew(ri);\n    if (what === 'all') {\n      row.cells[ci] = cell;\n    } else if (what === 'text') {\n      row.cells[ci] = row.cells[ci] || {};\n      row.cells[ci].text = cell.text;\n    } else if (what === 'format') {\n      row.cells[ci] = row.cells[ci] || {};\n      row.cells[ci].style = cell.style;\n      if (cell.merge) row.cells[ci].merge = cell.merge;\n    }\n  }\n\n  setCellText(ri, ci, text) {\n    const cell = this.getCellOrNew(ri, ci);\n    if (cell.editable !== false) cell.text = text;\n  }\n\n  // what: all | format | text\n  copyPaste(srcCellRange, dstCellRange, what, autofill = false, cb = () => {}) {\n    const {\n      sri, sci, eri, eci,\n    } = srcCellRange;\n    const dsri = dstCellRange.sri;\n    const dsci = dstCellRange.sci;\n    const deri = dstCellRange.eri;\n    const deci = dstCellRange.eci;\n    const [rn, cn] = srcCellRange.size();\n    const [drn, dcn] = dstCellRange.size();\n    // console.log(srcIndexes, dstIndexes);\n    let isAdd = true;\n    let dn = 0;\n    if (deri < sri || deci < sci) {\n      isAdd = false;\n      if (deri < sri) dn = drn;\n      else dn = dcn;\n    }\n    for (let i = sri; i <= eri; i += 1) {\n      if (this._[i]) {\n        for (let j = sci; j <= eci; j += 1) {\n          if (this._[i].cells && this._[i].cells[j]) {\n            for (let ii = dsri; ii <= deri; ii += rn) {\n              for (let jj = dsci; jj <= deci; jj += cn) {\n                const nri = ii + (i - sri);\n                const nci = jj + (j - sci);\n                const ncell = helper.cloneDeep(this._[i].cells[j]);\n                // ncell.text\n                if (ncell && ncell.text && ncell.text.length > 0) {\n                  const { text } = ncell;\n                  let n = (jj - dsci) + (ii - dsri) + 2;\n                  if (!isAdd) {\n                    n -= dn + 1;\n                  }\n                  if (text[0] === '=') {\n                    ncell.text = text.replace(/\\$?[a-zA-Z]{1,3}\\$?\\d+/g, (word) => {\n                      let [xn, yn] = [0, 0];\n                      if (autofill) {\n                        if (sri === dsri) {\n                          xn = n - 1;\n                          // if (isAdd) xn -= 1;\n                        } else {\n                          yn = n - 1;\n                        }\n                      }\n                      else {\n                        xn = nci - j;\n                        yn = nri - i;\n                      }\n                      const isConstX = /\\$[a-zA-Z]{1,3}\\$?\\d+/.test(word);\n                      const isConstY = /\\$?[a-zA-Z]{1,3}\\$\\d+/.test(word);\n                      if (isConstX) {\n                        xn = 0;\n                      }\n                      if (isConstY) {\n                        yn = 0;\n                      }\n                      if (/^\\d+$/.test(word)) return word;\n                      return expr2expr(word, xn, yn, () => true, isConstX, isConstY);\n                    });\n                  } else if (autofill && ((rn <= 1 && cn > 1 && (dsri > eri || deri < sri))\n                    || (cn <= 1 && rn > 1 && (dsci > eci || deci < sci))\n                    || (rn <= 1 && cn <= 1))) {\n                    const result = /[\\\\.\\d]+$/.exec(text);\n                    // console.log('result:', result);\n                    if (result !== null) {\n                      const index = Number(result[0]) + n - 1;\n                      ncell.text = text.substring(0, result.index) + index;\n                    }\n                  }\n                }\n                this.setCell(nri, nci, ncell, what);\n                cb(nri, nci, ncell);\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  cutPaste(srcCellRange, dstCellRange) {\n    const ncellmm = {};\n    this.each((ri) => {\n      this.eachCells(ri, (ci) => {\n        let nri = parseInt(ri, 10);\n        let nci = parseInt(ci, 10);\n        if (srcCellRange.includes(ri, ci)) {\n          nri = dstCellRange.sri + (nri - srcCellRange.sri);\n          nci = dstCellRange.sci + (nci - srcCellRange.sci);\n        }\n        ncellmm[nri] = ncellmm[nri] || { cells: {} };\n        ncellmm[nri].cells[nci] = this._[ri].cells[ci];\n      });\n    });\n    this._ = ncellmm;\n  }\n\n  // src: Array<Array<String>>\n  paste(src, dstCellRange) {\n    if (src.length <= 0) return;\n    const { sri, sci } = dstCellRange;\n    src.forEach((row, i) => {\n      const ri = sri + i;\n      row.forEach((cell, j) => {\n        const ci = sci + j;\n        this.setCellText(ri, ci, cell);\n      });\n    });\n  }\n\n  insert(sri, n = 1) {\n    const ndata = {};\n    this.each((ri, row) => {\n      let nri = parseInt(ri, 10);\n      if (nri >= sri) {\n        nri += n;\n        this.eachCells(ri, (ci, cell) => {\n          if (cell.text && cell.text[0] === '=') {\n            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => expr2expr(word, 0, n, (x, y) => y >= sri));\n          }\n        });\n      }\n      else {\n        this.eachCells(ri, (ci, cell) => {\n          if (cell.text && cell.text[0] === '=') {\n            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => {\n              const [x, y] = expr2xy(word);\n              if (y < sri) {\n                return word;\n              }\n              return expr2expr(word, 0, n, (x, y) => y >= sri);\n            });\n          }\n        });\n      }\n      ndata[nri] = row;\n    });\n    this._ = ndata;\n    this.len += n;\n  }\n\n  delete(sri, eri) {\n    const n = eri - sri + 1;\n    const ndata = {};\n    this.each((ri, row) => {\n      this.eachCells(ri, (ci, cell) => {\n        if (cell.text && cell.text[0] === '=') {\n          cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => {\n            const [x, y] = expr2xy(word);\n            if (y >= sri && y <= eri) {\n              return '#REF';\n            }\n            return word;\n          });\n        }\n      });\n    });\n    this.each((ri, row) => {\n      const nri = parseInt(ri, 10);\n      if (nri < sri) {\n        ndata[nri] = row;\n        this.eachCells(ri, (ci, cell) => {\n          if (cell.text && cell.text[0] === '=') {\n            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => {\n              const [x, y] = expr2xy(word);\n              if (y < sri) {\n                return word;\n              }\n              return expr2expr(word, 0, -n, (x, y) => y > eri);\n            });\n          }\n        });\n      } else if (ri > eri) {\n        ndata[nri - n] = row;\n        this.eachCells(ri, (ci, cell) => {\n          if (cell.text && cell.text[0] === '=') {\n            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => expr2expr(word, 0, -n, (x, y) => y > eri));\n          }\n        });\n      }\n    });\n    this._ = ndata;\n    this.len -= n;\n  }\n\n  insertColumn(sci, n = 1) {\n    this.each((ri, row) => {\n      const rndata = {};\n      this.eachCells(ri, (ci, cell) => {\n        let nci = parseInt(ci, 10);\n        if (nci >= sci) {\n          nci += n;\n          if (cell.text && cell.text[0] === '=') {\n            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => expr2expr(word, n, 0, x => x >= sci));\n          }\n        }\n        else {\n          if (cell.text && cell.text[0] === '=') {\n            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => {\n              const [x, y] = expr2xy(word);\n              if (x < sci) {\n                return word;\n              }\n              return expr2expr(word, n, 0, x => x >= sci);\n            });\n          }\n        }\n        rndata[nci] = cell;\n      });\n      row.cells = rndata;\n    });\n  }\n\n  deleteColumn(sci, eci) {\n    const n = eci - sci + 1;\n    this.each((ri, row) => {\n      this.eachCells(ri, (ci, cell) => {\n        if (cell.text && cell.text[0] === '=') {\n          cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => {\n            const [x, y] = expr2xy(word);\n            if (x >= sci && x <= eci) {\n              return '#REF';\n            }\n            return word;\n          });\n        }\n      });\n    });\n    this.each((ri, row) => {\n      const rndata = {};\n      this.eachCells(ri, (ci, cell) => {\n        const nci = parseInt(ci, 10);\n        if (nci < sci) {\n          rndata[nci] = cell;\n          if (cell.text && cell.text[0] === '=') {\n            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => {\n              const [x, y] = expr2xy(word);\n              if (x < sci) {\n                return word;\n              }\n              return expr2expr(word, -n, 0, x => x > eci);\n            });\n          }\n        } else if (nci > eci) {\n          rndata[nci - n] = cell;\n          if (cell.text && cell.text[0] === '=') {\n            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => expr2expr(word, -n, 0, x => x > eci));\n          }\n        }\n      });\n      row.cells = rndata;\n    });\n  }\n\n  // what: all | text | format | merge\n  deleteCells(cellRange, what = 'all') {\n    cellRange.each((i, j) => {\n      this.deleteCell(i, j, what);\n    });\n  }\n\n  // what: all | text | format | merge\n  deleteCell(ri, ci, what = 'all') {\n    const row = this.get(ri);\n    if (row !== null) {\n      const cell = this.getCell(ri, ci);\n      if (cell !== null && cell.editable !== false) {\n        if (what === 'all') {\n          delete row.cells[ci];\n        } else if (what === 'text') {\n          if (cell.text) delete cell.text;\n          if (cell.value) delete cell.value;\n        } else if (what === 'format') {\n          if (cell.style !== undefined) delete cell.style;\n          if (cell.merge) delete cell.merge;\n        } else if (what === 'merge') {\n          if (cell.merge) delete cell.merge;\n        }\n      }\n    }\n  }\n\n  maxCell() {\n    const keys = Object.keys(this._);\n    const ri = keys[keys.length - 1];\n    const col = this._[ri];\n    if (col) {\n      const { cells } = col;\n      const ks = Object.keys(cells);\n      const ci = ks[ks.length - 1];\n      return [parseInt(ri, 10), parseInt(ci, 10)];\n    }\n    return [0, 0];\n  }\n\n  each(cb) {\n    Object.entries(this._).forEach(([ri, row]) => {\n      cb(ri, row);\n    });\n  }\n\n  eachCells(ri, cb) {\n    if (this._[ri] && this._[ri].cells) {\n      Object.entries(this._[ri].cells).forEach(([ci, cell]) => {\n        cb(ci, cell);\n      });\n    }\n  }\n\n  setData(d) {\n    if (d.len) {\n      this.len = d.len;\n      delete d.len;\n    }\n    this._ = d;\n  }\n\n  getData() {\n    const { len } = this;\n    return Object.assign({ len }, this._);\n  }\n}\n\nexport default {};\nexport {\n  Rows,\n};\n","import helper from './helper';\n\nclass Cols {\n  constructor({\n    len, width, indexWidth, minWidth,\n  }) {\n    this._ = {};\n    this.len = len;\n    this.width = width;\n    this.indexWidth = indexWidth;\n    this.minWidth = minWidth;\n  }\n\n  setData(d) {\n    if (d.len) {\n      this.len = d.len;\n      delete d.len;\n    }\n    this._ = d;\n  }\n\n  getData() {\n    const { len } = this;\n    return Object.assign({ len }, this._);\n  }\n\n  getWidth(i) {\n    if (this.isHide(i)) return 0;\n    const col = this._[i];\n    if (col && col.width) {\n      return col.width;\n    }\n    return this.width;\n  }\n\n  getOrNew(ci) {\n    this._[ci] = this._[ci] || {};\n    return this._[ci];\n  }\n\n  setWidth(ci, width) {\n    const col = this.getOrNew(ci);\n    col.width = width;\n  }\n\n  unhide(idx) {\n    let index = idx;\n    while (index > 0) {\n      index -= 1;\n      if (this.isHide(index)) {\n        this.setHide(index, false);\n      } else break;\n    }\n  }\n\n  isHide(ci) {\n    const col = this._[ci];\n    return col && col.hide;\n  }\n\n  setHide(ci, v) {\n    const col = this.getOrNew(ci);\n    if (v === true) col.hide = true;\n    else delete col.hide;\n  }\n\n  setStyle(ci, style) {\n    const col = this.getOrNew(ci);\n    col.style = style;\n  }\n\n  sumWidth(min, max) {\n    return helper.rangeSum(min, max, i => this.getWidth(i));\n  }\n\n  totalWidth() {\n    return this.sumWidth(0, this.len);\n  }\n}\n\nexport default {};\nexport {\n  Cols,\n};\n","/* global window */\nimport en from './en';\n\n// Defines the fallback language as English\nlet $languages = ['en'];\nconst $messages = {\n  en,\n};\n\nfunction translate(key, messages) {\n  if (messages) {\n    // Return the translation from the first language in the languages array\n    // that has a value for the provided key.\n    for (const lang of $languages) {\n      if (!messages[lang]) break;\n\n      let message = messages[lang];\n\n      // Splits the key at '.' except where escaped as '\\.'\n      const keys = key.match(/(?:\\\\.|[^.])+/g);\n\n      for (let i = 0; i < keys.length; i += 1) {\n        const property = keys[i];\n        const value = message[property];\n\n        // If value doesn't exist, try next language\n        if (!value) break;\n\n        if (i === keys.length - 1) return value;\n\n        // Move down to the next level of the messages object\n        message = value;\n      }\n    }\n  }\n\n  return undefined;\n}\n\nfunction t(key) {\n  let v = translate(key, $messages);\n  if (!v && window && window.x_spreadsheet && window.x_spreadsheet.$messages) {\n    v = translate(key, window.x_spreadsheet.$messages);\n  }\n  return v || '';\n}\n\nfunction tf(key) {\n  return () => t(key);\n}\n\n// If clearLangList is set to false, lang will be added to the front of the\n// languages array. The languages in the language array are searched in order\n// to find a translation. This allows the use of other languages as a fallback\n// if lang is missing some keys. The language array is preloaded with English.\n// To set the languages array to only include lang, set clearLangList to true.\nfunction locale(lang, message, clearLangList = false) {\n  if (clearLangList) {\n    $languages = [lang];\n  } else {\n    // Append to front of array.\n    // Translation method will use the first language in the list that has a\n    // matching key.\n    $languages.unshift(lang);\n  }\n\n  if (message) {\n    $messages[lang] = message;\n  }\n}\n\nexport default {\n  t,\n};\n\nexport {\n  locale,\n  t,\n  tf,\n};\n","export default {\n  toolbar: {\n    undo: 'Undo',\n    redo: 'Redo',\n    print: 'Print',\n    paintformat: 'Paint format',\n    clearformat: 'Clear format',\n    format: 'Format',\n    fontName: 'Font',\n    fontSize: 'Font size',\n    fontBold: 'Font bold',\n    fontItalic: 'Font italic',\n    underline: 'Underline',\n    strike: 'Strike',\n    color: 'Text color',\n    bgcolor: 'Fill color',\n    border: 'Borders',\n    merge: 'Merge cells',\n    align: 'Horizontal align',\n    valign: 'Vertical align',\n    textwrap: 'Text wrapping',\n    freeze: 'Freeze cell',\n    autofilter: 'Filter',\n    formula: 'Functions',\n    more: 'More',\n  },\n  contextmenu: {\n    copy: 'Copy',\n    cut: 'Cut',\n    paste: 'Paste',\n    pasteValue: 'Paste values only',\n    pasteFormat: 'Paste format only',\n    hide: 'Hide',\n    insertRowBefore: 'Insert row before',\n    insertRowAfter: 'Insert row after',\n    insertRowsBefore: 'Insert rows before',\n    insertRowsAfter: 'Insert rows after',\n    insertColumnBefore: 'Insert column before',\n    insertColumnAfter: 'Insert column after',\n    insertColumnsBefore: 'Insert columns before',\n    insertColumnsAfter: 'Insert columns after',\n    deleteSheet: 'Delete',\n    deleteRow: 'Delete row',\n    deleteRows: 'Delete rows',\n    deleteColumn: 'Delete column',\n    deleteColumns: 'Delete columns',\n    deleteCell: 'Delete cell',\n    deleteCellText: 'Delete cell text',\n    resetRowHeight: 'Reset height',\n    resetColumnWidth: 'Reset width',\n    validation: 'Data validations',\n    cellprintable: 'Enable export',\n    cellnonprintable: 'Disable export',\n    celleditable: 'Enable editing',\n    cellnoneditable: 'Disable editing',\n  },\n  print: {\n    size: 'Paper size',\n    orientation: 'Page orientation',\n    orientations: ['Landscape', 'Portrait'],\n  },\n  format: {\n    normal: 'Normal',\n    text: 'Plain Text',\n    number: 'Number',\n    percent: 'Percent',\n    rmb: 'RMB',\n    usd: 'USD',\n    eur: 'EUR',\n    date: 'Date',\n    time: 'Time',\n    datetime: 'Date time',\n    duration: 'Duration',\n  },\n  formula: {\n    sum: 'Sum',\n    average: 'Average',\n    max: 'Max',\n    min: 'Min',\n    _if: 'IF',\n    and: 'AND',\n    or: 'OR',\n    concat: 'Concat',\n  },\n  validation: {\n    required: 'it must be required',\n    notMatch: 'it not match its validation rule',\n    between: 'it is between {} and {}',\n    notBetween: 'it is not between {} and {}',\n    notIn: 'it is not in list',\n    equal: 'it equal to {}',\n    notEqual: 'it not equal to {}',\n    lessThan: 'it less than {}',\n    lessThanEqual: 'it less than or equal to {}',\n    greaterThan: 'it greater than {}',\n    greaterThanEqual: 'it greater than or equal to {}',\n  },\n  error: {\n    pasteForMergedCell: 'Unable to do this for merged cells',\n  },\n  warning: {\n    mergingMultipleValues: 'There are multiple values in the range. Only the first one will be kept.',\n  },\n  calendar: {\n    weeks: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n    months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],\n  },\n  button: {\n    next: 'Next',\n    cancel: 'Cancel',\n    remove: 'Remove',\n    save: 'Save',\n    ok: 'OK',\n  },\n  sort: {\n    desc: 'Sort Z -> A',\n    asc: 'Sort A -> Z',\n  },\n  filter: {\n    empty: 'empty',\n  },\n  dataValidation: {\n    mode: 'Mode',\n    range: 'Cell Range',\n    criteria: 'Criteria',\n    modeType: {\n      cell: 'Cell',\n      column: 'Column',\n      row: 'Row',\n    },\n    type: {\n      list: 'List',\n      number: 'Number',\n      date: 'Date',\n      phone: 'Phone',\n      email: 'Email',\n    },\n    operator: {\n      be: 'between',\n      nbe: 'not between',\n      lt: 'less than',\n      lte: 'less than or equal to',\n      gt: 'greater than',\n      gte: 'greater than or equal to',\n      eq: 'equal to',\n      neq: 'not equal to',\n    },\n  },\n};\n","import { t } from '../locale/locale';\nimport helper from './helper';\n\nconst rules = {\n  phone: /^[1-9]\\d{10}$/,\n  email: /w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/,\n};\n\nfunction returnMessage(flag, key, ...arg) {\n  let message = '';\n  if (!flag) {\n    message = t(`validation.${key}`, ...arg);\n  }\n  return [flag, message];\n}\n\nexport default class Validator {\n  // operator: b|nb|eq|neq|lt|lte|gt|gte\n  // type: date|number|list|phone|email\n  constructor(type, required, value, operator) {\n    this.required = required;\n    this.value = value;\n    this.type = type;\n    this.operator = operator;\n    this.message = '';\n  }\n\n  parseValue(v) {\n    const { type } = this;\n    if (type === 'date') {\n      return new Date(v);\n    }\n    if (type === 'number') {\n      return Number(v);\n    }\n    return v;\n  }\n\n  equals(other) {\n    let flag = this.type === other.type\n      && this.required === other.required\n      && this.operator === other.operator;\n    if (flag) {\n      if (Array.isArray(this.value)) {\n        flag = helper.arrayEquals(this.value, other.value);\n      } else {\n        flag = this.value === other.value;\n      }\n    }\n    return flag;\n  }\n\n  values() {\n    return this.value.split(',');\n  }\n\n  validate(v) {\n    const {\n      required, operator, value, type,\n    } = this;\n    if (required && /^\\s*$/.test(v)) {\n      return returnMessage(false, 'required');\n    }\n    if (/^\\s*$/.test(v)) return [true];\n    if (rules[type] && !rules[type].test(v)) {\n      return returnMessage(false, 'notMatch');\n    }\n    if (type === 'list') {\n      return returnMessage(this.values().includes(v), 'notIn');\n    }\n    if (operator) {\n      const v1 = this.parseValue(v);\n      if (operator === 'be') {\n        const [min, max] = value;\n        return returnMessage(\n          v1 >= this.parseValue(min) && v1 <= this.parseValue(max),\n          'between',\n          min,\n          max,\n        );\n      }\n      if (operator === 'nbe') {\n        const [min, max] = value;\n        return returnMessage(\n          v1 < this.parseValue(min) || v1 > this.parseValue(max),\n          'notBetween',\n          min,\n          max,\n        );\n      }\n      if (operator === 'eq') {\n        return returnMessage(\n          v1 === this.parseValue(value),\n          'equal',\n          value,\n        );\n      }\n      if (operator === 'neq') {\n        return returnMessage(\n          v1 !== this.parseValue(value),\n          'notEqual',\n          value,\n        );\n      }\n      if (operator === 'lt') {\n        return returnMessage(\n          v1 < this.parseValue(value),\n          'lessThan',\n          value,\n        );\n      }\n      if (operator === 'lte') {\n        return returnMessage(\n          v1 <= this.parseValue(value),\n          'lessThanEqual',\n          value,\n        );\n      }\n      if (operator === 'gt') {\n        return returnMessage(\n          v1 > this.parseValue(value),\n          'greaterThan',\n          value,\n        );\n      }\n      if (operator === 'gte') {\n        return returnMessage(\n          v1 >= this.parseValue(value),\n          'greaterThanEqual',\n          value,\n        );\n      }\n    }\n    return [true];\n  }\n}\n","import Validator from './validator';\nimport { CellRange } from './cell_range';\n\nclass Validation {\n  constructor(mode, refs, validator) {\n    this.refs = refs;\n    this.mode = mode; // cell\n    this.validator = validator;\n  }\n\n  includes(ri, ci) {\n    const { refs } = this;\n    for (let i = 0; i < refs.length; i += 1) {\n      const cr = CellRange.valueOf(refs[i]);\n      if (cr.includes(ri, ci)) return true;\n    }\n    return false;\n  }\n\n  addRef(ref) {\n    this.remove(CellRange.valueOf(ref));\n    this.refs.push(ref);\n  }\n\n  remove(cellRange) {\n    const nrefs = [];\n    this.refs.forEach((it) => {\n      const cr = CellRange.valueOf(it);\n      if (cr.intersects(cellRange)) {\n        const crs = cr.difference(cellRange);\n        crs.forEach(it1 => nrefs.push(it1.toString()));\n      } else {\n        nrefs.push(it);\n      }\n    });\n    this.refs = nrefs;\n  }\n\n  getData() {\n    const { refs, mode, validator } = this;\n    const {\n      type, required, operator, value,\n    } = validator;\n    return {\n      refs, mode, type, required, operator, value,\n    };\n  }\n\n  static valueOf({\n    refs, mode, type, required, operator, value,\n  }) {\n    return new Validation(mode, refs, new Validator(type, required, value, operator));\n  }\n}\nclass Validations {\n  constructor() {\n    this._ = [];\n    // ri_ci: errMessage\n    this.errors = new Map();\n  }\n\n  getError(ri, ci) {\n    return this.errors.get(`${ri}_${ci}`);\n  }\n\n  validate(ri, ci, text) {\n    const v = this.get(ri, ci);\n    const key = `${ri}_${ci}`;\n    const { errors } = this;\n    if (v !== null) {\n      const [flag, message] = v.validator.validate(text);\n      if (!flag) {\n        errors.set(key, message);\n      } else {\n        errors.delete(key);\n      }\n    } else {\n      errors.delete(key);\n    }\n    return true;\n  }\n\n  // type: date|number|phone|email|list\n  // validator: { required, value, operator }\n  add(mode, ref, {\n    type, required, value, operator,\n  }) {\n    const validator = new Validator(\n      type, required, value, operator,\n    );\n    const v = this.getByValidator(validator);\n    if (v !== null) {\n      v.addRef(ref);\n    } else {\n      this._.push(new Validation(mode, [ref], validator));\n    }\n  }\n\n  getByValidator(validator) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const v = this._[i];\n      if (v.validator.equals(validator)) {\n        return v;\n      }\n    }\n    return null;\n  }\n\n  get(ri, ci) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const v = this._[i];\n      if (v.includes(ri, ci)) return v;\n    }\n    return null;\n  }\n\n  remove(cellRange) {\n    this.each((it) => {\n      it.remove(cellRange);\n    });\n  }\n\n  each(cb) {\n    this._.forEach(it => cb(it));\n  }\n\n  getData() {\n    return this._.filter(it => it.refs.length > 0).map(it => it.getData());\n  }\n\n  setData(d) {\n    this._ = d.map(it => Validation.valueOf(it));\n  }\n}\n\nexport default {};\nexport {\n  Validations,\n};\n","/* global document */\n\nimport Selector from './selector';\nimport Scroll from './scroll';\nimport History from './history';\nimport Clipboard from './clipboard';\nimport AutoFilter from './auto_filter';\nimport { Merges } from './merge';\nimport helper from './helper';\nimport { Rows } from './row';\nimport { Cols } from './col';\nimport { Validations } from './validation';\nimport { CellRange } from './cell_range';\nimport { expr2xy, xy2expr, expr2expr } from './alphabet';\nimport { t } from '../locale/locale';\n\n// private methods\n/*\n * {\n *  name: ''\n *  freeze: [0, 0],\n *  formats: [],\n *  styles: [\n *    {\n *      bgcolor: '',\n *      align: '',\n *      valign: '',\n *      textwrap: false,\n *      strike: false,\n *      underline: false,\n *      color: '',\n *      format: 1,\n *      border: {\n *        left: [style, color],\n *        right: [style, color],\n *        top: [style, color],\n *        bottom: [style, color],\n *      },\n *      font: {\n *        name: 'Helvetica',\n *        size: 10,\n *        bold: false,\n *        italic: false,\n *      }\n *    }\n *  ],\n *  merges: [\n *    'A1:F11',\n *    ...\n *  ],\n *  rows: {\n *    1: {\n *      height: 50,\n *      style: 1,\n *      cells: {\n *        1: {\n *          style: 2,\n *          type: 'string',\n *          text: '',\n *          value: '', // cal result\n *        }\n *      }\n *    },\n *    ...\n *  },\n *  cols: {\n *    2: { width: 100, style: 1 }\n *  }\n * }\n */\nconst defaultSettings = {\n  mode: 'edit', // edit | read\n  autoFocus: true,\n  view: {\n    height: () => document.documentElement.clientHeight,\n    width: () => document.documentElement.clientWidth,\n  },\n  showGrid: true,\n  showToolbar: true,\n  showContextmenu: true,\n  showContextMenuForCells: true,\n  showBottomBar: true,\n  suggestFormulas: true,\n  row: {\n    len: 100,\n    height: 25,\n  },\n  col: {\n    len: 26,\n    width: 100,\n    indexWidth: 60,\n    minWidth: 60,\n  },\n  style: {\n    bgcolor: '#ffffff',\n    align: 'left',\n    valign: 'middle',\n    textwrap: false,\n    strike: false,\n    underline: false,\n    color: '#0a0a0a',\n    font: {\n      name: 'Arial',\n      size: 10,\n      bold: false,\n      italic: false,\n    },\n    format: 'normal',\n  },\n  cellHeaderStyle: {\n    bgcolor: '#f4f5f8',\n    selectedBgcolor: 'rgba(75, 137, 255, 0.08)',\n    cornerBgcolor: '#f4f5f8',\n    fontFamily: 'Source Sans Pro',\n  },\n  toolbar: {\n    misc: {\n      undo: true,\n      redo: true,\n      print: true,\n      paintFormat: true,\n      clearFormat: true,\n    },\n    format: {\n      format: true,\n    },\n    font: {\n      family: true,\n      size: true,\n    },\n    textStyle: {\n      bold: true,\n      italic: true,\n      underline: true,\n      strike: true,\n      color: true,\n    },\n    cell: {\n      fill: true,\n      borders: true,\n      merge: true,\n    },\n    cellText: {\n      horizontalAlignment: true,\n      verticalAlignment: true,\n      wrap: true,\n    },\n    tools: {\n      freezeCell: true,\n      filter: true,\n      formulas: true,\n    },\n    itemsCallback: () => {},\n    clipboard: undefined,\n  },\n  formulaBar: {\n    location: 'belowToolbar',\n  },\n  contextMenu: {\n    itemsCallback: () => {},\n    extraItems: [],\n    preShowCallback: () => {},\n  },\n  cellCustomFormatterCreator: () => {},\n};\n\n\nconst toolbarHeight = 41;\nconst bottombarHeight = 41;\nconst formulaBarHeight = 30;\n\n// src: cellRange\n// dst: cellRange\nfunction canPaste(src, dst, error = () => {}) {\n  const { merges } = this;\n  const cellRange = dst.clone();\n  const [srn, scn] = src.size();\n  const [drn, dcn] = dst.size();\n  if (srn > drn) {\n    cellRange.eri = dst.sri + srn - 1;\n  }\n  if (scn > dcn) {\n    cellRange.eci = dst.sci + scn - 1;\n  }\n  if (merges.intersects(cellRange)) {\n    error(t('error.pasteForMergedCell'));\n    return false;\n  }\n  return true;\n}\nfunction copyPaste(srcCellRange, dstCellRange, what, autofill = false) {\n  const { rows, merges } = this;\n  // delete dest merge\n  if (what === 'all' || what === 'format') {\n    rows.deleteCells(dstCellRange, what);\n    merges.deleteWithin(dstCellRange);\n  }\n  rows.copyPaste(srcCellRange, dstCellRange, what, autofill, (ri, ci, cell) => {\n    if (cell && cell.merge) {\n      // console.log('cell:', ri, ci, cell);\n      const [rn, cn] = cell.merge;\n      if (rn <= 0 && cn <= 0) return;\n      merges.add(new CellRange(ri, ci, ri + rn, ci + cn));\n    }\n  });\n}\n\nfunction cutPaste(srcCellRange, dstCellRange) {\n  const { clipboard, rows, merges } = this;\n  rows.cutPaste(srcCellRange, dstCellRange);\n  merges.move(srcCellRange,\n    dstCellRange.sri - srcCellRange.sri,\n    dstCellRange.sci - srcCellRange.sci);\n  clipboard.clear();\n}\n\n// bss: { top, bottom, left, right }\nfunction setStyleBorder(ri, ci, bss) {\n  const { styles, rows } = this;\n  const cell = rows.getCellOrNew(ri, ci);\n  let cstyle = {};\n  if (cell.style !== undefined) {\n    cstyle = helper.cloneDeep(styles[cell.style]);\n  }\n  cstyle = helper.merge(cstyle, { border: bss });\n  cell.style = this.addStyle(cstyle);\n}\n\nfunction setStyleBorders({ mode, style, color }) {\n  const { styles, selector, rows } = this;\n  const {\n    sri, sci, eri, eci,\n  } = selector.range;\n  const multiple = !this.isSingleSelected();\n  if (!multiple) {\n    if (mode === 'inside' || mode === 'horizontal' || mode === 'vertical') {\n      return;\n    }\n  }\n  if (mode === 'outside' && !multiple) {\n    setStyleBorder.call(this, sri, sci, {\n      top: [style, color], bottom: [style, color], left: [style, color], right: [style, color],\n    });\n  } else if (mode === 'none') {\n    selector.range.each((ri, ci) => {\n      const cell = rows.getCell(ri, ci);\n      if (cell && cell.style !== undefined) {\n        const ns = helper.cloneDeep(styles[cell.style]);\n        delete ns.border;\n        // ['bottom', 'top', 'left', 'right'].forEach((prop) => {\n        //   if (ns[prop]) delete ns[prop];\n        // });\n        cell.style = this.addStyle(ns);\n      }\n    });\n  } else if (mode === 'all' || mode === 'inside' || mode === 'outside'\n    || mode === 'horizontal' || mode === 'vertical') {\n    const merges = [];\n    for (let ri = sri; ri <= eri; ri += 1) {\n      for (let ci = sci; ci <= eci; ci += 1) {\n        // jump merges -- start\n        const mergeIndexes = [];\n        for (let ii = 0; ii < merges.length; ii += 1) {\n          const [mri, mci, rn, cn] = merges[ii];\n          if (ri === mri + rn + 1) mergeIndexes.push(ii);\n          if (mri <= ri && ri <= mri + rn) {\n            if (ci === mci) {\n              ci += cn + 1;\n              break;\n            }\n          }\n        }\n        mergeIndexes.forEach(it => merges.splice(it, 1));\n        if (ci > eci) break;\n        // jump merges -- end\n        const cell = rows.getCell(ri, ci);\n        let [rn, cn] = [0, 0];\n        if (cell && cell.merge) {\n          [rn, cn] = cell.merge;\n          merges.push([ri, ci, rn, cn]);\n        }\n        const mrl = rn > 0 && ri + rn === eri;\n        const mcl = cn > 0 && ci + cn === eci;\n        let bss = {};\n        if (mode === 'all') {\n          bss = {\n            bottom: [style, color],\n            top: [style, color],\n            left: [style, color],\n            right: [style, color],\n          };\n        } else if (mode === 'inside') {\n          if (!mcl && ci < eci) bss.right = [style, color];\n          if (!mrl && ri < eri) bss.bottom = [style, color];\n        } else if (mode === 'horizontal') {\n          if (!mrl && ri < eri) bss.bottom = [style, color];\n        } else if (mode === 'vertical') {\n          if (!mcl && ci < eci) bss.right = [style, color];\n        } else if (mode === 'outside' && multiple) {\n          if (sri === ri) bss.top = [style, color];\n          if (mrl || eri === ri) bss.bottom = [style, color];\n          if (sci === ci) bss.left = [style, color];\n          if (mcl || eci === ci) bss.right = [style, color];\n        }\n        if (Object.keys(bss).length > 0) {\n          setStyleBorder.call(this, ri, ci, bss);\n        }\n        ci += cn;\n      }\n    }\n  } else if (mode === 'top' || mode === 'bottom') {\n    for (let ci = sci; ci <= eci; ci += 1) {\n      if (mode === 'top') {\n        setStyleBorder.call(this, sri, ci, { top: [style, color] });\n        ci += rows.getCellMerge(sri, ci)[1];\n      }\n      if (mode === 'bottom') {\n        setStyleBorder.call(this, eri, ci, { bottom: [style, color] });\n        ci += rows.getCellMerge(eri, ci)[1];\n      }\n    }\n  } else if (mode === 'left' || mode === 'right') {\n    for (let ri = sri; ri <= eri; ri += 1) {\n      if (mode === 'left') {\n        setStyleBorder.call(this, ri, sci, { left: [style, color] });\n        ri += rows.getCellMerge(ri, sci)[0];\n      }\n      if (mode === 'right') {\n        setStyleBorder.call(this, ri, eci, { right: [style, color] });\n        ri += rows.getCellMerge(ri, eci)[0];\n      }\n    }\n  }\n}\n\nfunction getCellRowByY(y, scrollOffsety) {\n  const { rows } = this;\n  const fsh = this.freezeTotalHeight();\n  // console.log('y:', y, ', fsh:', fsh);\n  let inits = rows.height;\n  if (fsh + rows.height < y) inits -= scrollOffsety;\n\n  // handle ri in autofilter\n  const frset = this.exceptRowSet;\n\n  let ri = 0;\n  let top = inits;\n  let { height } = rows;\n  for (; ri < rows.len; ri += 1) {\n    if (top > y) break;\n    if (!frset.has(ri)) {\n      height = rows.getHeight(ri);\n      top += height;\n    }\n  }\n  top -= height;\n  // console.log('ri:', ri, ', top:', top, ', height:', height);\n\n  if (top <= 0) {\n    return { ri: -1, top: 0, height };\n  }\n\n  return { ri: ri - 1, top, height };\n}\n\nfunction getCellColByX(x, scrollOffsetx) {\n  const { cols } = this;\n  const fsw = this.freezeTotalWidth();\n  let inits = cols.indexWidth;\n  if (fsw + cols.indexWidth < x) inits -= scrollOffsetx;\n  const [ci, left, width] = helper.rangeReduceIf(\n    0,\n    cols.len,\n    inits,\n    cols.indexWidth,\n    x,\n    i => cols.getWidth(i),\n  );\n  if (left <= 0) {\n    return { ci: -1, left: 0, width: cols.indexWidth };\n  }\n  return { ci: ci - 1, left, width };\n}\n\nexport default class DataProxy {\n  constructor(name, settings) {\n    this.settings = helper.merge(defaultSettings, settings || {});\n    // save data begin\n    this.name = name || 'sheet';\n    this.freeze = [0, 0];\n    this.styles = []; // Array<Style>\n    this.merges = new Merges(); // [CellRange, ...]\n    this.rows = new Rows(this.settings.row);\n    this.cols = new Cols(this.settings.col);\n    this.validations = new Validations();\n    this.hyperlinks = {};\n    this.comments = {};\n    // save data end\n\n    // don't save object\n    this.selector = new Selector();\n    this.scroll = new Scroll();\n    this.history = new History();\n    this.clipboard = new Clipboard();\n    this.autoFilter = new AutoFilter();\n    this.change = () => {};\n    this.exceptRowSet = new Set();\n    this.sortedRowMap = new Map();\n    this.unsortedRowMap = new Map();\n    this.randomId = Math.random().toString(36).substr(2);\n  }\n\n  addValidation(mode, ref, validator) {\n    // console.log('mode:', mode, ', ref:', ref, ', validator:', validator);\n    this.changeData(() => {\n      this.validations.add(mode, ref, validator);\n    });\n  }\n\n  removeValidation() {\n    const { range } = this.selector;\n    this.changeData(() => {\n      this.validations.remove(range);\n    });\n  }\n\n  getSelectedValidator() {\n    const { ri, ci } = this.selector;\n    const v = this.validations.get(ri, ci);\n    return v ? v.validator : null;\n  }\n\n  getSelectedValidation() {\n    const { ri, ci, range } = this.selector;\n    const v = this.validations.get(ri, ci);\n    const ret = { ref: range.toString() };\n    if (v !== null) {\n      ret.mode = v.mode;\n      ret.validator = v.validator;\n    }\n    return ret;\n  }\n\n  canUndo() {\n    return this.history.canUndo();\n  }\n\n  canRedo() {\n    return this.history.canRedo();\n  }\n\n  undo(cb) {\n    this.history.undo(this.getData(), (d) => {\n      this.setData(d);\n      this.change(this.getData());\n      if (cb) {\n        cb();\n      }\n    });\n  }\n\n  redo(cb) {\n    this.history.redo(this.getData(), (d) => {\n      this.setData(d);\n      this.change(this.getData());\n      if (cb) {\n        cb();\n      }\n    });\n  }\n\n  copy() {\n    this.clipboard.copy(this.selector.range);\n  }\n\n  copyToSystemClipboard(evt) {\n    let copyText = [];\n    let copyObj = {\n      srcType: 'x-spreadsheet',\n      srcDataId: this.randomId,\n      cells: [], // Array<{ ri: number, ci: number, text: string, style: object | null }>\n      srcRange: {\n        sci: this.selector.range.sci,\n        eci: this.selector.range.eci,\n        sri: this.selector.range.sri,\n        eri: this.selector.range.eri,\n      }\n    };\n    const {\n      sri, eri, sci, eci,\n    } = this.selector.range;\n\n    for (let ri = sri; ri <= eri; ri += 1) {\n      const row = [];\n      for (let ci = sci; ci <= eci; ci += 1) {\n        const cell = this.getCell(ri, ci);\n        const text = (cell && cell.text) || '';\n        const renderedText = text.startsWith('=') ? cell._lastRenderedFormula : text;\n        const style = this.getCellStyle(ri, ci);\n        row.push(renderedText);\n        copyObj.cells.push({ ri, ci, text: text, style: style });\n      }\n      copyText.push(row);\n    }\n\n    // Adding \\n and why not adding \\r\\n is to support online office and client MS office and WPS\n    copyText = copyText.map(row => row.join('\\t')).join('\\n');\n\n    if (this.settings.clipboard && this.settings.clipboard.setData) {\n      this.settings.clipboard.setData({ text: copyText, json: JSON.stringify(copyObj) });\n    }\n    else {\n      // why used this\n      // cuz http protocol will be blocked request clipboard by browser\n      if (evt) {\n        evt.clipboardData.clearData();\n        evt.clipboardData.setData('text/plain', copyText);\n        evt.preventDefault();\n      }\n\n      // this need https protocol\n      /* global navigator */\n      if (navigator.clipboard) {\n        navigator.clipboard.writeText(copyText).then(() => {}, (err) => {\n          console.log('text copy to the system clipboard error  ', copyText, err);\n        });\n      }\n    }\n  }\n\n  cut() {\n    this.clipboard.cut(this.selector.range);\n  }\n\n  // what: all | text | format\n  paste(what = 'all', error = () => {}) {\n    // console.log('sIndexes:', sIndexes);\n    const { clipboard, selector } = this;\n    if (clipboard.isClear()) return false;\n    if (!canPaste.call(this, clipboard.range, selector.range, error)) return false;\n\n    this.changeData(() => {\n      if (clipboard.isCopy()) {\n        copyPaste.call(this, clipboard.range, selector.range, what);\n      } else if (clipboard.isCut()) {\n        cutPaste.call(this, clipboard.range, selector.range);\n      }\n    });\n    return true;\n  }\n\n  pasteFromText(txt) {\n    let lines = [];\n\n    if (/\\r\\n/.test(txt)) lines = txt.split('\\r\\n').map(it => it.replace(/\"/g, '').split('\\t'));\n    else lines = txt.split('\\n').map(it => it.replace(/\"/g, '').split('\\t'));\n\n    if (lines.length) {\n      const { rows, selector } = this;\n\n      this.changeData(() => {\n        rows.paste(lines, selector.range);\n      });\n    }\n  }\n  \n  pasteFromObj(obj) {\n    const dci = this.selector.range.sci - obj.srcRange.sci;\n    const dri = this.selector.range.sri - obj.srcRange.sri;\n    for (const cellData of obj.cells) {\n      const ci = cellData.ci + dci;\n      const ri = cellData.ri + dri;\n      const cell = this.rows.getCellOrNew(ri, ci);\n      this.rows.setCellText(ri, ci, this.translateFormula(cellData.text, dci, dri));\n      cell.style = cellData.style ? this.addStyle(cellData.style) : undefined;\n    }\n  }\n  \n  translateFormula(text, dci, dri) {\n    if (!text.startsWith('=')) {\n      return text;\n    }\n    text = text.replace(/\\$?[a-zA-Z]{1,3}\\$?\\d+/g, (word) => {\n      if (/^\\d+$/.test(word)) return word;\n      const isConstX = /\\$[a-zA-Z]{1,3}\\$?\\d+/.test(word);\n      const isConstY = /\\$?[a-zA-Z]{1,3}\\$\\d+/.test(word);\n      const _dci = isConstX ? 0 : dci;\n      const _dri = isConstY ? 0 : dri;\n      return expr2expr(word, _dci, _dri, () => true, isConstX, isConstY);\n    });\n    return text;\n  }\n\n  autofill(cellRange, what, error = () => {}) {\n    const srcRange = this.selector.range;\n    if (!canPaste.call(this, srcRange, cellRange, error)) return false;\n    this.changeData(() => {\n      copyPaste.call(this, srcRange, cellRange, what, true);\n    });\n    return true;\n  }\n\n  clearClipboard() {\n    this.clipboard.clear();\n  }\n\n  calSelectedRangeByEnd(ri, ci, isHeaderClick = false) {\n    const {\n      selector, rows, cols, merges,\n    } = this;\n    let {\n      sri, sci, eri, eci,\n    } = selector.range;\n    const cri = selector.ri;\n    const cci = selector.ci;\n    let [nri, nci] = [ri, ci];\n    if (ri < 0) nri = rows.len - 1;\n    if (ci < 0) nci = cols.len - 1;\n    if (nri > cri) [sri, eri] = [cri, nri];\n    else [sri, eri] = [nri, cri];\n    if (nci > cci) [sci, eci] = [cci, nci];\n    else [sci, eci] = [nci, cci];\n    if (isHeaderClick) {\n      selector.range = new CellRange(\n        sri, sci, eri, eci,\n      );\n    }\n    else {\n      selector.range = merges.union(new CellRange(\n        sri, sci, eri, eci,\n      ));\n      selector.range = merges.union(selector.range);\n    }\n    // console.log('selector.range:', selector.range);\n    return selector.range;\n  }\n\n  calSelectedRangeByStart(ri, ci) {\n    const {\n      selector, rows, cols, merges,\n    } = this;\n    let cellRange = merges.getFirstIncludes(ri, ci);\n    // console.log('cellRange:', cellRange, ri, ci, merges);\n    if (cellRange === null) {\n      cellRange = new CellRange(ri, ci, ri, ci);\n      if (ri === -1) {\n        cellRange.sri = 0;\n        cellRange.eri = rows.len - 1;\n      }\n      if (ci === -1) {\n        cellRange.sci = 0;\n        cellRange.eci = cols.len - 1;\n      }\n    }\n    selector.range = cellRange;\n    return cellRange;\n  }\n\n  setSelectedCellAttr(property, value) {\n    this.changeData(() => {\n      const { selector, styles, rows } = this;\n      if (property === 'merge') {\n        if (value) this.merge();\n        else this.unmerge();\n      } else if (property === 'border') {\n        setStyleBorders.call(this, value);\n      } else if (property === 'formula') {\n        // console.log('>>>', selector.multiple());\n        const { ri, ci, range } = selector;\n        if (selector.multiple()) {\n          const [rn, cn] = selector.size();\n          const {\n            sri, sci, eri, eci,\n          } = range;\n          if (rn > 1) {\n            for (let i = sci; i <= eci; i += 1) {\n              const cell = rows.getCellOrNew(eri + 1, i);\n              cell.text = `=${value}(${xy2expr(i, sri)}:${xy2expr(i, eri)})`;\n            }\n          } else if (cn > 1) {\n            const cell = rows.getCellOrNew(ri, eci + 1);\n            cell.text = `=${value}(${xy2expr(sci, ri)}:${xy2expr(eci, ri)})`;\n          }\n        } else {\n          const cell = rows.getCellOrNew(ri, ci);\n          cell.text = `=${value}()`;\n        }\n      } else {\n        selector.range.each((ri, ci) => {\n          const cell = rows.getCellOrNew(ri, ci);\n          let cstyle = {};\n          if (cell.style !== undefined) {\n            cstyle = helper.cloneDeep(styles[cell.style]);\n          }\n          if (property === 'format') {\n            cstyle.format = value;\n            cell.style = this.addStyle(cstyle);\n          } else if (property === 'font-bold' || property === 'font-italic'\n            || property === 'font-name' || property === 'font-size') {\n            const nfont = {};\n            nfont[property.split('-')[1]] = value;\n            cstyle.font = Object.assign(cstyle.font || {}, nfont);\n            cell.style = this.addStyle(cstyle);\n          } else if (property === 'strike' || property === 'textwrap'\n            || property === 'underline'\n            || property === 'align' || property === 'valign'\n            || property === 'color' || property === 'bgcolor'\n            || property == 'customFormatter') {\n            cstyle[property] = value;\n            cell.style = this.addStyle(cstyle, true);\n          } else {\n            cell[property] = value;\n          }\n        });\n      }\n    });\n  }\n\n  // state: input | finished\n  setSelectedCellText(text, state = 'input') {\n    const { autoFilter, selector, rows } = this;\n    const { ri, ci } = selector;\n    let nri = ri;\n    if (this.unsortedRowMap.has(ri)) {\n      nri = this.unsortedRowMap.get(ri);\n    }\n    const oldCell = rows.getCell(nri, ci);\n    const oldText = oldCell ? oldCell.text : '';\n    this.setCellText(nri, ci, text, state);\n    // replace filter.value\n    if (autoFilter.active()) {\n      const filter = autoFilter.getFilter(ci);\n      if (filter) {\n        const vIndex = filter.value.findIndex(v => v === oldText);\n        if (vIndex >= 0) {\n          filter.value.splice(vIndex, 1, text);\n        }\n        // console.log('filter:', filter, oldCell);\n      }\n    }\n    // this.resetAutoFilter();\n  }\n\n  getSelectedCell() {\n    const { ri, ci } = this.selector;\n    let nri = ri;\n    if (this.unsortedRowMap.has(ri)) {\n      nri = this.unsortedRowMap.get(ri);\n    }\n    return this.rows.getCell(nri, ci);\n  }\n\n  xyInSelectedRect(x, y) {\n    const {\n      left, top, width, height,\n    } = this.getSelectedRect();\n    const x1 = x - this.cols.indexWidth;\n    const y1 = y - this.rows.height;\n    // console.log('x:', x, ',y:', y, 'left:', left, 'top:', top);\n    return x1 > left && x1 < (left + width)\n      && y1 > top && y1 < (top + height);\n  }\n\n  getSelectedRect() {\n    return this.getRect(this.selector.range);\n  }\n  \n  getFirstSelectedCellRect() {\n    const sci = this.selector.ci;\n    const sri = this.selector.ri;\n    const cell = this.getCell(sri, sci);\n    const merge = cell && cell.merge ? cell.merge : [0, 0];\n    const eci = sci + merge[1];\n    const eri = sri + merge[0];\n    const range = {\n      sci: sci,\n      eci: eci,\n      sri: sri,\n      eri: eri,\n    };\n    return this.getRect(range);\n  }\n\n  getClipboardRect() {\n    const { clipboard } = this;\n    if (!clipboard.isClear()) {\n      return this.getRect(clipboard.range);\n    }\n    return { left: -100, top: -100 };\n  }\n\n  getRect(cellRange) {\n    const {\n      scroll, rows, cols, exceptRowSet,\n    } = this;\n    const {\n      sri, sci, eri, eci,\n    } = cellRange;\n    // console.log('sri:', sri, ',sci:', sci, ', eri:', eri, ', eci:', eci);\n    // no selector\n    if (sri < 0 && sci < 0) {\n      return {\n        left: 0, l: 0, top: 0, t: 0, scroll,\n      };\n    }\n    const left = cols.sumWidth(0, sci);\n    const top = rows.sumHeight(0, sri, exceptRowSet);\n    const height = rows.sumHeight(sri, eri + 1, exceptRowSet);\n    const width = cols.sumWidth(sci, eci + 1);\n    // console.log('sri:', sri, ', sci:', sci, ', eri:', eri, ', eci:', eci);\n    let left0 = left - scroll.x;\n    let top0 = top - scroll.y;\n    const fsh = this.freezeTotalHeight();\n    const fsw = this.freezeTotalWidth();\n    if (fsw > 0 && fsw > left) {\n      left0 = left;\n    }\n    if (fsh > 0 && fsh > top) {\n      top0 = top;\n    }\n    return {\n      l: left,\n      t: top,\n      left: left0,\n      top: top0,\n      height,\n      width,\n      scroll,\n    };\n  }\n\n  getCellRectByXY(x, y) {\n    const {\n      scroll, merges, rows, cols,\n    } = this;\n    let { ri, top, height } = getCellRowByY.call(this, y, scroll.y);\n    let { ci, left, width } = getCellColByX.call(this, x, scroll.x);\n    if (ci === -1) {\n      width = cols.totalWidth();\n    }\n    if (ri === -1) {\n      height = rows.totalHeight();\n    }\n    if (ri >= 0 || ci >= 0) {\n      const merge = merges.getFirstIncludes(ri, ci);\n      if (merge) {\n        ri = merge.sri;\n        ci = merge.sci;\n        ({\n          left, top, width, height,\n        } = this.cellRect(ri, ci));\n      }\n    }\n    return {\n      ri, ci, left, top, width, height,\n    };\n  }\n\n  isSingleSelected() {\n    const {\n      sri, sci, eri, eci,\n    } = this.selector.range;\n    const cell = this.getCell(sri, sci);\n    if (cell && cell.merge) {\n      const [rn, cn] = cell.merge;\n      if (sri + rn === eri && sci + cn === eci) return true;\n    }\n    return !this.selector.multiple();\n  }\n\n  canUnmerge() {\n    const {\n      sri, sci, eri, eci,\n    } = this.selector.range;\n    const cell = this.getCell(sri, sci);\n    if (cell && cell.merge) {\n      const [rn, cn] = cell.merge;\n      if (sri + rn === eri && sci + cn === eci) return true;\n    }\n    return false;\n  }\n\n  merge() {\n    const { selector, rows } = this;\n    if (this.isSingleSelected()) return;\n    const [rn, cn] = selector.size();\n    // console.log('merge:', rn, cn);\n    if (rn > 1 || cn > 1) {\n      const { sri, sci } = selector.range;\n      this.changeData(() => {\n        const values = this.collectMergeValues();\n        const value = values.length > 0 ? values[0] : \"\";\n        const cell = rows.getCellOrNew(sri, sci);\n        const firstCellStyle = this.getCellStyle(sri, sci);\n        const firstNonEmptyCellStyle = this.getMergeFirstNonEmptyCellStyle();\n        const mergedCellStyle = firstCellStyle ? firstCellStyle : firstNonEmptyCellStyle;\n        if (mergedCellStyle) {\n            cell.style = this.addStyle(mergedCellStyle);\n        }\n        cell.merge = [rn - 1, cn - 1];\n        cell.text = value;\n        this.merges.add(selector.range);\n        // delete merge cells\n        this.rows.deleteCells(selector.range);\n        // console.log('cell:', cell, this.d);\n        this.rows.setCell(sri, sci, cell);\n      });\n    }\n  }\n  \n  collectMergeValues() {\n    const { selector, rows } = this;\n    const values = [];\n    for (let ri = selector.range.sri; ri <= selector.range.eri; ++ri) {\n      for (let ci = selector.range.sci; ci <= selector.range.eci; ++ci) {\n        const cell = rows.getCell(ri, ci);\n        if (cell && cell.text && cell.text.length > 0) {\n          values.push(cell.text);\n        }\n      }\n    }\n    return values;\n  }\n  \n  getMergeFirstNonEmptyCellStyle() {\n    const { selector, rows } = this;\n    for (let ri = selector.range.sri; ri <= selector.range.eri; ++ri) {\n      for (let ci = selector.range.sci; ci <= selector.range.eci; ++ci) {\n        const cell = rows.getCell(ri, ci);\n        if (cell && cell.text && cell.text.length > 0) {\n          return this.getCellStyle(ri, ci);\n        }\n      }\n    }\n  }\n\n  unmerge() {\n    const { selector } = this;\n    if (!this.isSingleSelected()) return;\n    const { sri, sci } = selector.range;\n    this.changeData(() => {\n      this.rows.deleteCell(sri, sci, 'merge');\n      this.merges.deleteWithin(selector.range);\n    });\n  }\n\n  canAutofilter() {\n    return !this.autoFilter.active();\n  }\n\n  autofilter() {\n    const { autoFilter, selector } = this;\n    this.changeData(() => {\n      if (autoFilter.active()) {\n        autoFilter.clear();\n        this.exceptRowSet = new Set();\n        this.sortedRowMap = new Map();\n        this.unsortedRowMap = new Map();\n      } else {\n        autoFilter.ref = selector.range.toString();\n      }\n    });\n  }\n\n  setAutoFilter(ci, order, operator, value) {\n    const { autoFilter } = this;\n    autoFilter.addFilter(ci, operator, value);\n    autoFilter.setSort(ci, order);\n    this.resetAutoFilter();\n  }\n\n  resetAutoFilter() {\n    const { autoFilter, rows } = this;\n    if (!autoFilter.active()) return;\n    const { sort } = autoFilter;\n    const { rset, fset } = autoFilter.filteredRows((r, c) => rows.getCell(r, c));\n    const fary = Array.from(fset);\n    const oldAry = Array.from(fset);\n    if (sort) {\n      fary.sort((a, b) => {\n        if (sort.order === 'asc') return a - b;\n        if (sort.order === 'desc') return b - a;\n        return 0;\n      });\n    }\n    this.exceptRowSet = rset;\n    this.sortedRowMap = new Map();\n    this.unsortedRowMap = new Map();\n    fary.forEach((it, index) => {\n      this.sortedRowMap.set(oldAry[index], it);\n      this.unsortedRowMap.set(it, oldAry[index]);\n    });\n  }\n\n  deleteCell(what = 'all') {\n    const { selector } = this;\n    this.changeData(() => {\n      this.rows.deleteCells(selector.range, what);\n      if (what === 'all' || what === 'format') {\n        this.merges.deleteWithin(selector.range);\n      }\n    });\n  }\n\n  // type: row | column\n  // mode: before | after\n  insert(type, mode, n = 1) {\n    this.changeData(() => {\n      const { sri, eri, sci, eci } = this.selector.range;\n      const { rows, merges, cols } = this;\n      let si = sri;\n      if (type === 'row') {\n        rows.insert(mode === 'before' ? sri : (eri + 1), n);\n      } else if (type === 'column') {\n        rows.insertColumn(mode === 'before' ? sci : (eci + 1), n);\n        si = sci;\n        cols.len += n;\n      }\n      merges.shift(type, si, n, (ri, ci, rn, cn) => {\n        const cell = rows.getCell(ri, ci);\n        if (cell && cell.merge) {\n          cell.merge[0] += rn;\n          cell.merge[1] += cn;\n        }\n      });\n    });\n  }\n\n  // type: row | column\n  delete(type) {\n    this.changeData(() => {\n      const {\n        rows, merges, selector, cols,\n      } = this;\n      const { range } = selector;\n      const {\n        sri, sci, eri, eci,\n      } = selector.range;\n      const [rsize, csize] = selector.range.size();\n      let si = sri;\n      let size = rsize;\n      if (type === 'row') {\n        rows.delete(sri, eri);\n      } else if (type === 'column') {\n        rows.deleteColumn(sci, eci);\n        si = range.sci;\n        size = csize;\n        cols.len -= (eci - sci + 1);\n      }\n      // console.log('type:', type, ', si:', si, ', size:', size);\n      merges.shift(type, si, -size, (ri, ci, rn, cn) => {\n        // console.log('ri:', ri, ', ci:', ci, ', rn:', rn, ', cn:', cn);\n        const cell = rows.getCell(ri, ci);\n        if (cell && cell.merge) {\n          cell.merge[0] += rn;\n          cell.merge[1] += cn;\n          if (cell.merge[0] <= 0 && cell.merge[1] <= 0) {\n            delete cell.merge;\n          }\n        }\n      });\n    });\n  }\n\n  scrollx(x, cb) {\n    const { scroll, freeze, cols } = this;\n    const [, fci] = freeze;\n    const [\n      ci, left, width,\n    ] = helper.rangeReduceIf(fci, cols.len, 0, 0, x, i => cols.getWidth(i));\n    // console.log('fci:', fci, ', ci:', ci);\n    let x1 = left;\n    if (x > 0) x1 += width;\n    if (scroll.x !== x1) {\n      scroll.ci = x > 0 ? ci : 0;\n      scroll.x = x1;\n      cb();\n    }\n  }\n\n  scrolly(y, cb) {\n    const { scroll, freeze, rows } = this;\n    const [fri] = freeze;\n    const [\n      ri, top, height,\n    ] = helper.rangeReduceIf(fri, rows.len, 0, 0, y, i => rows.getHeight(i));\n    let y1 = top;\n    if (y > 0) y1 += height;\n    // console.log('ri:', ri, ' ,y:', y1);\n    if (scroll.y !== y1) {\n      scroll.ri = y > 0 ? ri : 0;\n      scroll.y = y1;\n      cb();\n    }\n  }\n\n  cellRect(ri, ci, allowHorizontalOverflow = false, textWidth = -1) {\n    const { rows, cols } = this;\n    const left = cols.sumWidth(0, ci);\n    const top = rows.sumHeight(0, ri);\n    const cell = rows.getCell(ri, ci);\n    let width = cols.getWidth(ci);\n    let height = rows.getHeight(ri);\n    let isCellMerged = false;\n    let isCellTextAlignedLeft = true;\n    if (cell !== null) {\n      const style = this.getCellStyle(ri, ci);\n      isCellTextAlignedLeft = style && style.align ? style.align === 'left' : true;\n      const isTextWrapOn = style ? !!style.textwrap : false;\n      if (isTextWrapOn) {\n        allowHorizontalOverflow = false;\n      }\n      if (cell.merge) {\n        isCellMerged = true;\n        const [rn, cn] = cell.merge;\n        // console.log('cell.merge:', cell.merge);\n        if (rn > 0) {\n          for (let i = 1; i <= rn; i += 1) {\n            height += rows.getHeight(ri + i);\n          }\n        }\n        if (cn > 0) {\n          for (let i = 1; i <= cn; i += 1) {\n            width += cols.getWidth(ci + i);\n          }\n        }\n      }\n    }\n    const hasHorizontalOverflow = allowHorizontalOverflow && !isCellMerged && isCellTextAlignedLeft && textWidth >= 0;\n    let extraWidth = 0;\n    if (hasHorizontalOverflow) {\n      const maxHorizontalOverflowExtraColumnsCount = 10;\n      let maxHorizontalOverflow = 0;\n      for (let dci = 1; dci <= maxHorizontalOverflowExtraColumnsCount; ++dci) {\n        const ci2 = ci + dci;\n        const cell2 = rows.getCell(ri, ci2);\n        if (cell2 && !this.isCellEmpty(cell2.text, this.getCellStyle(ri, ci2))) {\n          break;\n        }\n        const width2 = cols.getWidth(ci2);\n        maxHorizontalOverflow += width2;\n      }\n      const maxNeededExtraWidth = Math.max(0, textWidth - width);\n      extraWidth = Math.min(maxHorizontalOverflow, maxNeededExtraWidth);\n      width += extraWidth;\n    }\n    // console.log('data:', this.d);\n    return {\n      left, top, width, height, cell,\n      addedExtraWidth: extraWidth,\n    };\n  }\n  \n  isCellEmpty(text, style) {\n    const defaultStyle = this.defaultStyle();\n    if (text && text.length > 0) {\n      return false;\n    }\n    if (!style) {\n      return true;\n    }\n    for (const k in style) {\n      if (k === 'hasAlignSet') continue;\n      let styleVal = style[k];\n      let defaultStyleVal = defaultStyle[k];\n      if (k === 'font') {\n        styleVal = JSON.stringify(styleVal);\n        defaultStyleVal = JSON.stringify(defaultStyleVal);\n      }\n      if (styleVal !== defaultStyleVal) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  getCell(ri, ci) {\n    return this.rows.getCell(ri, ci);\n  }\n\n  getCellTextOrDefault(ri, ci) {\n    const cell = this.getCell(ri, ci);\n    return (cell && cell.text) ? cell.text : '';\n  }\n\n  getCellStyle(ri, ci) {\n    const cell = this.getCell(ri, ci);\n    if (cell && cell.style !== undefined) {\n      return this.styles[cell.style];\n    }\n    return null;\n  }\n\n  getCellStyleOrDefault(ri, ci) {\n    const { styles, rows } = this;\n    const cell = rows.getCell(ri, ci);\n    const cellStyle = (cell && cell.style !== undefined) ? styles[cell.style] : {};\n    const newCellStyle = helper.merge(this.defaultStyle(), cellStyle);\n    newCellStyle.hasAlignSet = !!cellStyle.align;\n    return newCellStyle;\n  }\n\n  getSelectedCellStyle() {\n    const { ri, ci } = this.selector;\n    return this.getCellStyleOrDefault(ri, ci);\n  }\n  \n  setSelectedCellCustomFormatter(formatter) {\n    this.setSelectedCellAttr('customFormatter', formatter);\n  }\n  \n  clearSelectedCellCustomFormatter() {\n    this.setSelectedCellAttr('customFormatter', undefined);\n  }\n\n  // state: input | finished\n  setCellText(ri, ci, text, state) {\n    const { rows, history, validations } = this;\n    const cell = rows.getCellOrNew(ri, ci);\n    if (state === 'finished') {\n      const origText = typeof(cell._origText) === 'string' ? cell._origText : '';\n      delete cell._origText;\n      rows.setCellText(ri, ci, origText);\n      if (origText !== text) {\n        history.add(this.getData());\n      }\n      rows.setCellText(ri, ci, text);\n    } else {\n      if (typeof(cell._origText) !== 'string') {\n        cell._origText = cell.text || '';\n      }\n      rows.setCellText(ri, ci, text);\n      this.change(this.getData());\n    }\n    // validator\n    validations.validate(ri, ci, text);\n  }\n\n  freezeIsActive() {\n    const [ri, ci] = this.freeze;\n    return ri > 0 || ci > 0;\n  }\n\n  setFreeze(ri, ci) {\n    this.changeData(() => {\n      this.freeze = [ri, ci];\n    });\n  }\n\n  freezeTotalWidth() {\n    return this.cols.sumWidth(0, this.freeze[1]);\n  }\n\n  freezeTotalHeight() {\n    return this.rows.sumHeight(0, this.freeze[0]);\n  }\n\n  setRowHeight(ri, height) {\n    this.changeData(() => {\n      this.rows.setHeight(ri, height);\n    });\n  }\n\n  setColWidth(ci, width) {\n    this.changeData(() => {\n      this.cols.setWidth(ci, width);\n    });\n  }\n\n  viewHeight() {\n    const { view, showToolbar, showBottomBar, formulaBar } = this.settings;\n    let h = view.height();\n    if (showBottomBar) {\n      h -= bottombarHeight;\n    }\n    if (showToolbar) {\n      h -= toolbarHeight;\n    }\n    if (formulaBar.location === 'belowToolbar') {\n      h -= formulaBarHeight;\n    }\n    return h;\n  }\n\n  viewWidth() {\n    return this.settings.view.width();\n  }\n\n  freezeViewRange() {\n    const [ri, ci] = this.freeze;\n    return new CellRange(0, 0, ri - 1, ci - 1, this.freezeTotalWidth(), this.freezeTotalHeight());\n  }\n\n  contentRange() {\n    const { rows, cols } = this;\n    const [ri, ci] = rows.maxCell();\n    const h = rows.sumHeight(0, ri + 1);\n    const w = cols.sumWidth(0, ci + 1);\n    return new CellRange(0, 0, ri, ci, w, h);\n  }\n\n  exceptRowTotalHeight(sri, eri) {\n    const { exceptRowSet, rows } = this;\n    const exceptRows = Array.from(exceptRowSet);\n    let exceptRowTH = 0;\n    exceptRows.forEach((ri) => {\n      if (ri < sri || ri > eri) {\n        const height = rows.getHeight(ri);\n        exceptRowTH += height;\n      }\n    });\n    return exceptRowTH;\n  }\n\n  viewRange() {\n    const {\n      scroll, rows, cols, freeze, exceptRowSet,\n    } = this;\n    // console.log('scroll:', scroll, ', freeze:', freeze)\n    let { ri, ci } = scroll;\n    if (ri <= 0) [ri] = freeze;\n    if (ci <= 0) [, ci] = freeze;\n\n    let [x, y] = [0, 0];\n    let [eri, eci] = [rows.len, cols.len];\n    for (let i = ri; i < rows.len; i += 1) {\n      if (!exceptRowSet.has(i)) {\n        y += rows.getHeight(i);\n        eri = i;\n      }\n      if (y > this.viewHeight()) break;\n    }\n    for (let j = ci; j < cols.len; j += 1) {\n      x += cols.getWidth(j);\n      eci = j;\n      if (x > this.viewWidth()) break;\n    }\n    // console.log(ri, ci, eri, eci, x, y);\n    return new CellRange(ri, ci, eri, eci, x, y);\n  }\n\n  eachMergesInView(viewRange, cb) {\n    this.merges.filterIntersects(viewRange)\n      .forEach(it => cb(it));\n  }\n\n  hideRowsOrCols() {\n    const { rows, cols, selector } = this;\n    const [rlen, clen] = selector.size();\n    const {\n      sri, sci, eri, eci,\n    } = selector.range;\n    if (rlen === rows.len) {\n      for (let ci = sci; ci <= eci; ci += 1) {\n        cols.setHide(ci, true);\n      }\n    } else if (clen === cols.len) {\n      for (let ri = sri; ri <= eri; ri += 1) {\n        rows.setHide(ri, true);\n      }\n    }\n  }\n\n  // type: row | col\n  // index row-index | col-index\n  unhideRowsOrCols(type, index) {\n    this[`${type}s`].unhide(index);\n  }\n\n  rowEach(min, max, cb) {\n    let y = 0;\n    const { rows } = this;\n    const frset = this.exceptRowSet;\n    const frary = [...frset];\n    let offset = 0;\n    for (let i = 0; i < frary.length; i += 1) {\n      if (frary[i] < min) {\n        offset += 1;\n      }\n    }\n    // console.log('min:', min, ', max:', max, ', scroll:', scroll);\n    for (let i = min + offset; i <= max + offset; i += 1) {\n      if (frset.has(i)) {\n        offset += 1;\n      } else {\n        const rowHeight = rows.getHeight(i);\n        if (rowHeight > 0) {\n          cb(i, y, rowHeight);\n          y += rowHeight;\n          if (y > this.viewHeight()) break;\n        }\n      }\n    }\n  }\n\n  colEach(min, max, cb) {\n    let x = 0;\n    const { cols } = this;\n    for (let i = min; i <= max; i += 1) {\n      const colWidth = cols.getWidth(i);\n      if (colWidth > 0) {\n        cb(i, x, colWidth);\n        x += colWidth;\n        if (x > this.viewWidth()) break;\n      }\n    }\n  }\n\n  defaultStyle() {\n    return this.settings.style;\n  }\n\n  addStyle(nstyle, force) {\n    const { styles } = this;\n    // console.log('old.styles:', styles, nstyle);\n    if (!force) {\n      for (let i = 0; i < styles.length; i += 1) {\n        const style = styles[i];\n        if (helper.equals(style, nstyle)) return i;\n      }\n    }\n    styles.push(nstyle);\n    return styles.length - 1;\n  }\n\n  changeData(cb) {\n    this.history.add(this.getData());\n    cb();\n    this.change(this.getData());\n  }\n\n  setData(d) {\n    Object.keys(d).forEach((property) => {\n      if (property === 'merges' || property === 'rows'\n        || property === 'cols' || property === 'validations') {\n        this[property].setData(d[property]);\n      } else if (property === 'freeze') {\n        const [x, y] = expr2xy(d[property]);\n        this.freeze = [y, x];\n      } else if (property === 'autofilter') {\n        this.autoFilter.setData(d[property]);\n      } else if (d[property] !== undefined) {\n        this[property] = d[property];\n      }\n    });\n    return this;\n  }\n\n  getData() {\n    const {\n      name, freeze, styles, merges, rows, cols, validations, autoFilter,\n    } = this;\n    return {\n      name,\n      freeze: xy2expr(freeze[1], freeze[0]),\n      styles,\n      merges: merges.getData(),\n      rows: rows.getData(),\n      cols: cols.getData(),\n      validations: validations.getData(),\n      autofilter: autoFilter.getData(),\n    };\n  }\n}\n","/* global window */\nexport function bind(target, name, fn) {\n  target.addEventListener(name, fn);\n}\nexport function unbind(target, name, fn) {\n  target.removeEventListener(name, fn);\n}\nexport function unbindClickoutside(el) {\n  if (el.xclickoutside) {\n    unbind(window.document.body, 'click', el.xclickoutside);\n    delete el.xclickoutside;\n  }\n}\n\n// the left mouse button: mousedown → mouseup → click\n// the right mouse button: mousedown → contenxtmenu → mouseup\n// the right mouse button in firefox(>65.0): mousedown → contenxtmenu → mouseup → click on window\nexport function bindClickoutside(el, cb) {\n  el.xclickoutside = (evt) => {\n    // ignore double click\n    // console.log('evt:', evt);\n    if (evt.detail === 2 || el.contains(evt.target)) return;\n    if (cb) cb(el);\n    else {\n      el.hide();\n      unbindClickoutside(el);\n    }\n  };\n  bind(window.document.body, 'click', el.xclickoutside);\n}\nexport function mouseMoveUp(target, movefunc, upfunc) {\n  bind(target, 'mousemove', movefunc);\n  const t = target;\n  t.xEvtUp = (evt) => {\n    // console.log('mouseup>>>');\n    unbind(target, 'mousemove', movefunc);\n    unbind(target, 'mouseup', target.xEvtUp);\n    upfunc(evt);\n  };\n  bind(target, 'mouseup', target.xEvtUp);\n}\n\nfunction calTouchDirection(spanx, spany, evt, cb) {\n  let direction = '';\n  // console.log('spanx:', spanx, ', spany:', spany);\n  if (Math.abs(spanx) > Math.abs(spany)) {\n    // horizontal\n    direction = spanx > 0 ? 'right' : 'left';\n    cb(direction, spanx, evt);\n  } else {\n    // vertical\n    direction = spany > 0 ? 'down' : 'up';\n    cb(direction, spany, evt);\n  }\n}\n// cb = (direction, distance) => {}\nexport function bindTouch(target, { move, end }) {\n  let startx = 0;\n  let starty = 0;\n  bind(target, 'touchstart', (evt) => {\n    const { pageX, pageY } = evt.touches[0];\n    startx = pageX;\n    starty = pageY;\n  });\n  bind(target, 'touchmove', (evt) => {\n    if (!move) return;\n    const { pageX, pageY } = evt.changedTouches[0];\n    const spanx = pageX - startx;\n    const spany = pageY - starty;\n    if (Math.abs(spanx) > 10 || Math.abs(spany) > 10) {\n      // console.log('spanx:', spanx, ', spany:', spany);\n      calTouchDirection(spanx, spany, evt, move);\n      startx = pageX;\n      starty = pageY;\n    }\n    evt.preventDefault();\n  });\n  bind(target, 'touchend', (evt) => {\n    if (!end) return;\n    const { pageX, pageY } = evt.changedTouches[0];\n    const spanx = pageX - startx;\n    const spany = pageY - starty;\n    calTouchDirection(spanx, spany, evt, end);\n  });\n}\n\n// eventemiter\nexport function createEventEmitter() {\n  const listeners = new Map();\n\n  function on(eventName, callback) {\n    const push = () => {\n      const currentListener = listeners.get(eventName);\n      return (Array.isArray(currentListener)\n          && currentListener.push(callback))\n          || false;\n    };\n\n    const create = () => listeners.set(eventName, [].concat(callback));\n\n    return (listeners.has(eventName)\n        && push())\n        || create();\n  }\n\n  function fire(eventName, args) {\n    const exec = () => {\n      const currentListener = listeners.get(eventName);\n      for (const callback of currentListener) callback.call(null, ...args);\n    };\n\n    return listeners.has(eventName)\n        && exec();\n  }\n\n  function removeListener(eventName, callback) {\n    const remove = () => {\n      const currentListener = listeners.get(eventName);\n      const idx = currentListener.indexOf(callback);\n      return (idx >= 0)\n          && currentListener.splice(idx, 1)\n          && listeners.get(eventName).length === 0\n          && listeners.delete(eventName);\n    };\n\n    return listeners.has(eventName)\n        && remove();\n  }\n\n  function once(eventName, callback) {\n    const execCalllback = (...args) => {\n      callback.call(null, ...args);\n      removeListener(eventName, execCalllback);\n    };\n\n    return on(eventName, execCalllback);\n  }\n\n  function removeAllListeners() {\n    listeners.clear();\n  }\n\n  return {\n    get current() {\n      return listeners;\n    },\n    on,\n    once,\n    fire,\n    removeListener,\n    removeAllListeners,\n  };\n}\n","/* global window */\nexport const cssPrefix = 'x-spreadsheet';\nexport const dpr = window.devicePixelRatio || 1;\nexport default {\n  cssPrefix,\n  dpr,\n};\n","/* global window */\nimport { h } from './element';\nimport { mouseMoveUp } from './event';\nimport { cssPrefix } from '../config';\n\nexport default class Resizer {\n  constructor(vertical = false, minDistance) {\n    this.moving = false;\n    this.vertical = vertical;\n    this.el = h('div', `${cssPrefix}-resizer ${vertical ? 'vertical' : 'horizontal'}`).children(\n      this.unhideHoverEl = h('div', `${cssPrefix}-resizer-hover`)\n        .on('dblclick.stop', evt => this.mousedblclickHandler(evt))\n        .css('position', 'absolute').hide(),\n      this.hoverEl = h('div', `${cssPrefix}-resizer-hover`)\n        .on('mousedown.stop', evt => this.mousedownHandler(evt)),\n      this.lineEl = h('div', `${cssPrefix}-resizer-line`).hide(),\n    ).hide();\n    // cell rect\n    this.cRect = null;\n    this.finishedFn = null;\n    this.minDistance = minDistance;\n    this.unhideFn = () => {};\n  }\n\n  showUnhide(index) {\n    this.unhideIndex = index;\n    this.unhideHoverEl.show();\n  }\n\n  hideUnhide() {\n    this.unhideHoverEl.hide();\n  }\n\n  // rect : {top, left, width, height}\n  // line : {width, height}\n  show(rect, line) {\n    const {\n      moving, vertical, hoverEl, lineEl, el,\n      unhideHoverEl,\n    } = this;\n    if (moving) return;\n    this.cRect = rect;\n    const {\n      left, top, width, height,\n    } = rect;\n    el.offset({\n      left: vertical ? left + width - 5 : left,\n      top: vertical ? top : top + height - 5,\n    }).show();\n    hoverEl.offset({\n      width: vertical ? 5 : width,\n      height: vertical ? height : 5,\n    });\n    lineEl.offset({\n      width: vertical ? 0 : line.width,\n      height: vertical ? line.height : 0,\n    });\n    unhideHoverEl.offset({\n      left: vertical ? 5 - width : left,\n      top: vertical ? top : 5 - height,\n      width: vertical ? 5 : width,\n      height: vertical ? height : 5,\n    });\n  }\n\n  hide() {\n    this.el.offset({\n      left: 0,\n      top: 0,\n    }).hide();\n    this.hideUnhide();\n  }\n\n  mousedblclickHandler() {\n    if (this.unhideIndex) this.unhideFn(this.unhideIndex);\n  }\n\n  mousedownHandler(evt) {\n    let startEvt = evt;\n    const {\n      el, lineEl, cRect, vertical, minDistance,\n    } = this;\n    let distance = vertical ? cRect.width : cRect.height;\n    // console.log('distance:', distance);\n    lineEl.show();\n    mouseMoveUp(window, (e) => {\n      this.moving = true;\n      if (startEvt !== null && e.buttons === 1) {\n        // console.log('top:', top, ', left:', top, ', cRect:', cRect);\n        if (vertical) {\n          distance += e.movementX;\n          if (distance > minDistance) {\n            el.css('left', `${cRect.left + distance}px`);\n          }\n        } else {\n          distance += e.movementY;\n          if (distance > minDistance) {\n            el.css('top', `${cRect.top + distance}px`);\n          }\n        }\n        startEvt = e;\n      }\n    }, () => {\n      startEvt = null;\n      lineEl.hide();\n      this.moving = false;\n      this.hide();\n      if (this.finishedFn) {\n        if (distance < minDistance) distance = minDistance;\n        this.finishedFn(cRect, distance);\n      }\n    });\n  }\n}\n","import { h } from './element';\nimport { cssPrefix } from '../config';\n\nexport default class Scrollbar {\n  constructor(vertical) {\n    this.vertical = vertical;\n    this.moveFn = null;\n    this.el = h('div', `${cssPrefix}-scrollbar ${vertical ? 'vertical' : 'horizontal'}`)\n      .child(this.contentEl = h('div', ''))\n      .on('mousemove.stop', () => {})\n      .on('scroll.stop', (evt) => {\n        const { scrollTop, scrollLeft } = evt.target;\n        // console.log('scrollTop:', scrollTop);\n        if (this.moveFn) {\n          this.moveFn(this.vertical ? scrollTop : scrollLeft, evt);\n        }\n        // console.log('evt:::', evt);\n      });\n  }\n\n  move(v) {\n    this.el.scroll(v);\n    return this;\n  }\n\n  scroll() {\n    return this.el.scroll();\n  }\n\n  set(distance, contentDistance) {\n    const d = distance - 1;\n    // console.log('distance:', distance, ', contentDistance:', contentDistance);\n    if (contentDistance > d) {\n      const cssKey = this.vertical ? 'height' : 'width';\n      // console.log('d:', d);\n      this.el.css(cssKey, `${d - 15}px`).show();\n      this.contentEl\n        .css(this.vertical ? 'width' : 'height', '1px')\n        .css(cssKey, `${contentDistance}px`);\n    } else {\n      if (!this.el.isHidden()) {\n        this.move({ left: 0, top: 0 });\n        this.el.hide();\n      }\n    }\n    return this;\n  }\n}\n","import { h } from './element';\nimport { cssPrefix } from '../config';\nimport { CellRange } from '../core/cell_range';\n\nconst selectorHeightBorderWidth = 2 * 2 - 1;\nlet startZIndex = 10;\n\nclass SelectorElement {\n  constructor(useHideInput = false, autoFocus = true) {\n    this.useHideInput = useHideInput;\n    this.autoFocus = autoFocus;\n    this.inputChange = () => {};\n    this.cornerEl = h('div', `${cssPrefix}-selector-corner`);\n    this.areaElFirst = h('div', `${cssPrefix}-selector-area-first`);\n    this.areaEl = h('div', `${cssPrefix}-selector-area`)\n      .child(this.cornerEl)\n      .child(this.areaElFirst)\n      .hide();\n    this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();\n    this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();\n    this.el = h('div', `${cssPrefix}-selector`)\n      .css('z-index', `${startZIndex}`)\n      .children(this.areaEl, this.clipboardEl, this.autofillEl)\n      .hide();\n    if (useHideInput) {\n      this.hideInput = h('input', '')\n        .on('compositionend', (evt) => {\n          this.inputChange(evt.target.value);\n        });\n      this.el.child(this.hideInputDiv = h('div', 'hide-input').child(this.hideInput));\n      this.el.child(this.hideInputDiv = h('div', 'hide-input').child(this.hideInput));\n    }\n    startZIndex += 1;\n  }\n\n  setOffset(v) {\n    this.el.offset(v).show();\n    return this;\n  }\n\n  hide() {\n    this.el.hide();\n    return this;\n  }\n\n  setAreaOffset(v, vFirst) {\n    const {\n      left, top, width, height,\n    } = v;\n    const of = {\n      width: width - selectorHeightBorderWidth + 0.8,\n      height: height - selectorHeightBorderWidth + 0.8,\n      left: left - 0.8,\n      top: top - 0.8,\n    };\n    const ofFirst = {\n      width: vFirst.width - selectorHeightBorderWidth + 0.8,\n      height: vFirst.height - selectorHeightBorderWidth + 0.8,\n      left: vFirst.left - left,\n      top: vFirst.top - top,\n    };\n    this.areaElFirst.offset(ofFirst)\n    this.areaEl.offset(of).show();\n    if (this.useHideInput) {\n      this.hideInputDiv.offset(of);\n      if (this.autoFocus) {\n        this.hideInput.val('').focus();\n      } else {\n        this.hideInput.val('');\n      }\n    }\n  }\n  \n  focus() {\n    if (this.hideInput) {\n      this.hideInput.focus();\n    }\n  }\n\n  setClipboardOffset(v) {\n    const {\n      left, top, width, height,\n    } = v;\n    this.clipboardEl.offset({\n      left,\n      top,\n      width: width - 5,\n      height: height - 5,\n    });\n  }\n\n  showAutofill(v) {\n    const {\n      left, top, width, height,\n    } = v;\n    this.autofillEl.offset({\n      width: width - selectorHeightBorderWidth,\n      height: height - selectorHeightBorderWidth,\n      left,\n      top,\n    }).show();\n  }\n\n  hideAutofill() {\n    this.autofillEl.hide();\n  }\n\n  showClipboard() {\n    this.clipboardEl.show();\n  }\n\n  hideClipboard() {\n    this.clipboardEl.hide();\n  }\n}\n\nfunction calBRAreaOffset(offset) {\n  const { data } = this;\n  const {\n    left, top, width, height, scroll, l, t,\n  } = offset;\n  const ftwidth = data.freezeTotalWidth();\n  const ftheight = data.freezeTotalHeight();\n  let left0 = left - ftwidth;\n  if (ftwidth > l) left0 -= scroll.x;\n  let top0 = top - ftheight;\n  if (ftheight > t) top0 -= scroll.y;\n  return {\n    left: left0,\n    top: top0,\n    width,\n    height,\n  };\n}\n\nfunction calTAreaOffset(offset) {\n  const { data } = this;\n  const {\n    left, width, height, l, t, scroll,\n  } = offset;\n  const ftwidth = data.freezeTotalWidth();\n  let left0 = left - ftwidth;\n  if (ftwidth > l) left0 -= scroll.x;\n  return {\n    left: left0, top: t, width, height,\n  };\n}\n\nfunction calLAreaOffset(offset) {\n  const { data } = this;\n  const {\n    top, width, height, l, t, scroll,\n  } = offset;\n  const ftheight = data.freezeTotalHeight();\n  let top0 = top - ftheight;\n  // console.log('ftheight:', ftheight, ', t:', t);\n  if (ftheight > t) top0 -= scroll.y;\n  return {\n    left: l, top: top0, width, height,\n  };\n}\n\nfunction setBRAreaOffset(offset, offsetFirst) {\n  const { br } = this;\n  br.setAreaOffset(calBRAreaOffset.call(this, offset), calBRAreaOffset.call(this, offsetFirst));\n}\n\nfunction setTLAreaOffset(offset, offsetFirst) {\n  const { tl } = this;\n  tl.setAreaOffset(offset, offsetFirst);\n}\n\nfunction setTAreaOffset(offset, offsetFirst) {\n  const { t } = this;\n  t.setAreaOffset(calTAreaOffset.call(this, offset), calTAreaOffset.call(this, offsetFirst));\n}\n\nfunction setLAreaOffset(offset, offsetFirst) {\n  const { l } = this;\n  l.setAreaOffset(calLAreaOffset.call(this, offset), calLAreaOffset.call(this, offsetFirst));\n}\n\nfunction setLClipboardOffset(offset) {\n  const { l } = this;\n  l.setClipboardOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setBRClipboardOffset(offset) {\n  const { br } = this;\n  br.setClipboardOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLClipboardOffset(offset) {\n  const { tl } = this;\n  tl.setClipboardOffset(offset);\n}\n\nfunction setTClipboardOffset(offset) {\n  const { t } = this;\n  t.setClipboardOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setAllAreaOffset(offset, offsetFirst) {\n  setBRAreaOffset.call(this, offset, offsetFirst);\n  setTLAreaOffset.call(this, offset, offsetFirst);\n  setTAreaOffset.call(this, offset, offsetFirst);\n  setLAreaOffset.call(this, offset, offsetFirst);\n}\n\nfunction setAllClipboardOffset(offset) {\n  setBRClipboardOffset.call(this, offset);\n  setTLClipboardOffset.call(this, offset);\n  setTClipboardOffset.call(this, offset);\n  setLClipboardOffset.call(this, offset);\n}\n\nexport default class Selector {\n  constructor(data) {\n    const { autoFocus } = data.settings;\n    this.inputChange = () => {};\n    this.data = data;\n    this.br = new SelectorElement(true, autoFocus);\n    this.t = new SelectorElement();\n    this.l = new SelectorElement();\n    this.tl = new SelectorElement();\n    this.br.inputChange = (v) => {\n      this.inputChange(v);\n    };\n    this.br.el.show();\n    this.offset = null;\n    this.areaOffset = null;\n    this.indexes = null;\n    this.range = null;\n    this.arange = null;\n    this.el = h('div', `${cssPrefix}-selectors`)\n      .children(\n        this.tl.el,\n        this.t.el,\n        this.l.el,\n        this.br.el,\n      ).hide();\n\n    // for performance\n    this.lastri = -1;\n    this.lastci = -1;\n\n    startZIndex += 1;\n  }\n  \n  focus() {\n    this.br.focus();\n  }\n\n  resetData(data) {\n    this.data = data;\n    this.range = data.selector.range;\n    this.resetAreaOffset();\n  }\n\n  hide() {\n    this.el.hide();\n  }\n\n  resetOffset() {\n    const {\n      data, tl, t, l, br,\n    } = this;\n    const freezeHeight = data.freezeTotalHeight();\n    const freezeWidth = data.freezeTotalWidth();\n    if (freezeHeight > 0 || freezeWidth > 0) {\n      tl.setOffset({ width: freezeWidth, height: freezeHeight });\n      t.setOffset({ left: freezeWidth, height: freezeHeight });\n      l.setOffset({ top: freezeHeight, width: freezeWidth });\n      br.setOffset({ left: freezeWidth, top: freezeHeight });\n    } else {\n      tl.hide();\n      t.hide();\n      l.hide();\n      br.setOffset({ left: 0, top: 0 });\n    }\n  }\n\n  resetAreaOffset() {\n    // console.log('offset:', offset);\n    const offset = this.data.getSelectedRect();\n    const offsetFirst = this.data.getFirstSelectedCellRect();\n    const coffset = this.data.getClipboardRect();\n    setAllAreaOffset.call(this, offset, offsetFirst);\n    setAllClipboardOffset.call(this, coffset);\n    this.resetOffset();\n  }\n\n  resetBRTAreaOffset() {\n    const offset = this.data.getSelectedRect();\n    const offsetFirst = this.data.getFirstSelectedCellRect();\n    const coffset = this.data.getClipboardRect();\n    setBRAreaOffset.call(this, offset, offsetFirst);\n    setTAreaOffset.call(this, offset, offsetFirst);\n    setBRClipboardOffset.call(this, coffset);\n    setTClipboardOffset.call(this, coffset);\n    this.resetOffset();\n  }\n\n  resetBRLAreaOffset() {\n    const offset = this.data.getSelectedRect();\n    const offsetFirst = this.data.getFirstSelectedCellRect();\n    const coffset = this.data.getClipboardRect();\n    setBRAreaOffset.call(this, offset, offsetFirst);\n    setLAreaOffset.call(this, offset, offsetFirst);\n    setBRClipboardOffset.call(this, coffset);\n    setLClipboardOffset.call(this, coffset);\n    this.resetOffset();\n  }\n\n  set(ri, ci, indexesUpdated = true) {\n    const { data } = this;\n    const cellRange = data.calSelectedRangeByStart(ri, ci);\n    const { sri, sci } = cellRange;\n    if (indexesUpdated) {\n      let [cri, cci] = [ri, ci];\n      if (ri < 0) cri = 0;\n      if (ci < 0) cci = 0;\n      data.selector.setIndexes(cri, cci);\n      this.indexes = [cri, cci];\n    }\n\n    this.moveIndexes = [sri, sci];\n    // this.sIndexes = sIndexes;\n    // this.eIndexes = eIndexes;\n    this.range = cellRange;\n    this.resetAreaOffset();\n    this.el.show();\n  }\n\n  setEnd(ri, ci, moving = true, isHeaderClick = false) {\n    const { data, lastri, lastci } = this;\n    if (moving) {\n      if (ri === lastri && ci === lastci) return;\n      this.lastri = ri;\n      this.lastci = ci;\n    }\n    this.range = data.calSelectedRangeByEnd(ri, ci, isHeaderClick);\n    setAllAreaOffset.call(this, this.data.getSelectedRect(), this.data.getFirstSelectedCellRect());\n  }\n\n  reset() {\n    // console.log('::::', this.data);\n    const { eri, eci } = this.data.selector.range;\n    this.setEnd(eri, eci);\n  }\n\n  showAutofill(ri, ci) {\n    if (ri === -1 && ci === -1) return;\n    // console.log('ri:', ri, ', ci:', ci);\n    // const [sri, sci] = this.sIndexes;\n    // const [eri, eci] = this.eIndexes;\n    const {\n      sri, sci, eri, eci,\n    } = this.range;\n    const [nri, nci] = [ri, ci];\n    // const rn = eri - sri;\n    // const cn = eci - sci;\n    const srn = sri - ri;\n    const scn = sci - ci;\n    const ern = eri - ri;\n    const ecn = eci - ci;\n    if (scn > 0) {\n      // left\n      // console.log('left');\n      this.arange = new CellRange(sri, nci, eri, sci - 1);\n      // this.saIndexes = [sri, nci];\n      // this.eaIndexes = [eri, sci - 1];\n      // data.calRangeIndexes2(\n    } else if (srn > 0) {\n      // top\n      // console.log('top');\n      // nri = sri;\n      this.arange = new CellRange(nri, sci, sri - 1, eci);\n      // this.saIndexes = [nri, sci];\n      // this.eaIndexes = [sri - 1, eci];\n    } else if (ecn < 0) {\n      // right\n      // console.log('right');\n      // nci = eci;\n      this.arange = new CellRange(sri, eci + 1, eri, nci);\n      // this.saIndexes = [sri, eci + 1];\n      // this.eaIndexes = [eri, nci];\n    } else if (ern < 0) {\n      // bottom\n      // console.log('bottom');\n      // nri = eri;\n      this.arange = new CellRange(eri + 1, sci, nri, eci);\n      // this.saIndexes = [eri + 1, sci];\n      // this.eaIndexes = [nri, eci];\n    } else {\n      // console.log('else:');\n      this.arange = null;\n      // this.saIndexes = null;\n      // this.eaIndexes = null;\n      return;\n    }\n    if (this.arange !== null) {\n      // console.log(this.saIndexes, ':', this.eaIndexes);\n      const offset = this.data.getRect(this.arange);\n      offset.width += 2;\n      offset.height += 2;\n      const {\n        br, l, t, tl,\n      } = this;\n      br.showAutofill(calBRAreaOffset.call(this, offset));\n      l.showAutofill(calLAreaOffset.call(this, offset));\n      t.showAutofill(calTAreaOffset.call(this, offset));\n      tl.showAutofill(offset);\n    }\n  }\n\n  hideAutofill() {\n    ['br', 'l', 't', 'tl'].forEach((property) => {\n      this[property].hideAutofill();\n    });\n  }\n\n  showClipboard() {\n    const coffset = this.data.getClipboardRect();\n    setAllClipboardOffset.call(this, coffset);\n    ['br', 'l', 't', 'tl'].forEach((property) => {\n      this[property].showClipboard();\n    });\n  }\n\n  hideClipboard() {\n    ['br', 'l', 't', 'tl'].forEach((property) => {\n      this[property].hideClipboard();\n    });\n  }\n}\n","import { h } from './element';\nimport { bindClickoutside, unbindClickoutside } from './event';\nimport { cssPrefix } from '../config';\n\nfunction inputMovePrev(evt) {\n  evt.preventDefault();\n  evt.stopPropagation();\n  const { filterItems } = this;\n  if (filterItems.length <= 0) return;\n  if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\n  this.itemIndex -= 1;\n  if (this.itemIndex < 0) {\n    this.itemIndex = filterItems.length - 1;\n  }\n  filterItems[this.itemIndex].toggle();\n}\n\nfunction inputMoveNext(evt) {\n  evt.stopPropagation();\n  const { filterItems } = this;\n  if (filterItems.length <= 0) return;\n  if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\n  this.itemIndex += 1;\n  if (this.itemIndex > filterItems.length - 1) {\n    this.itemIndex = 0;\n  }\n  filterItems[this.itemIndex].toggle();\n}\n\nfunction inputEnter(evt) {\n  evt.preventDefault();\n  const { filterItems } = this;\n  if (filterItems.length <= 0) return;\n  evt.stopPropagation();\n  if (this.itemIndex < 0) this.itemIndex = 0;\n  filterItems[this.itemIndex].el.click();\n  this.hide();\n}\n\nfunction inputKeydownHandler(evt) {\n  const { keyCode } = evt;\n  if (evt.ctrlKey) {\n    evt.stopPropagation();\n  }\n  switch (keyCode) {\n    case 37: // left\n      evt.stopPropagation();\n      break;\n    case 38: // up\n      inputMovePrev.call(this, evt);\n      break;\n    case 39: // right\n      evt.stopPropagation();\n      break;\n    case 40: // down\n      inputMoveNext.call(this, evt);\n      break;\n    case 13: // enter\n      inputEnter.call(this, evt);\n      break;\n    case 9:\n      inputEnter.call(this, evt);\n      break;\n    default:\n      evt.stopPropagation();\n      break;\n  }\n}\n\nexport default class Suggest {\n  constructor(items, itemClick, width = '200px', disabled = false) {\n    this.filterItems = [];\n    this.items = items;\n    this.el = h('div', `${cssPrefix}-suggest`).css('width', width).hide();\n    this.itemClick = itemClick;\n    this.itemIndex = -1;\n    this.disabled = disabled;\n  }\n\n  setOffset(v) {\n    this.el.cssRemoveKeys('top', 'bottom')\n      .offset(v);\n  }\n\n  hide() {\n    if (this.disabled) {\n      return;\n    }\n    const { el } = this;\n    this.filterItems = [];\n    this.itemIndex = -1;\n    el.hide();\n    unbindClickoutside(this.el.parent());\n  }\n\n  setItems(items) {\n    this.items = items;\n    // this.search('');\n  }\n\n  search(word) {\n    if (this.disabled) {\n      return;\n    }\n    let { items } = this;\n    if (!/^\\s*$/.test(word)) {\n      items = items.filter(it => (it.key || it).startsWith(word.toUpperCase()));\n    }\n    items = items.map((it) => {\n      let { title } = it;\n      if (title) {\n        if (typeof title === 'function') {\n          title = title();\n        }\n      } else {\n        title = it;\n      }\n      const item = h('div', `${cssPrefix}-item`)\n        .child(title)\n        .on('click.stop', () => {\n          this.itemClick(it);\n          this.hide();\n        });\n      if (it.label) {\n        item.child(h('div', 'label').html(it.label));\n      }\n      return item;\n    });\n    this.filterItems = items;\n    if (items.length <= 0) {\n      return;\n    }\n    const { el } = this;\n    // items[0].toggle();\n    el.html('').children(...items).show();\n    bindClickoutside(el.parent(), () => { this.hide(); });\n  }\n\n  bindInputEvents(input) {\n    input.on('keydown', evt => inputKeydownHandler.call(this, evt));\n  }\n}\n","import { Element, h } from './element';\nimport { cssPrefix } from '../config';\n\nexport default class Icon extends Element {\n  constructor(name) {\n    super('div', `${cssPrefix}-icon`);\n    this.iconNameEl = h('div', `${cssPrefix}-icon-img ${name}`);\n    this.child(this.iconNameEl);\n  }\n\n  setName(name) {\n    this.iconNameEl.className(`${cssPrefix}-icon-img ${name}`);\n  }\n}\n","import { h } from './element';\nimport Icon from './icon';\nimport { t } from '../locale/locale';\n\nfunction addMonth(date, step) {\n  date.setMonth(date.getMonth() + step);\n}\n\nfunction weekday(date, index) {\n  const d = new Date(date);\n  d.setDate(index - date.getDay() + 1);\n  return d;\n}\n\nfunction monthDays(year, month, cdate) {\n  // the first day of month\n  const startDate = new Date(year, month, 1, 23, 59, 59);\n  const datess = [[], [], [], [], [], []];\n  for (let i = 0; i < 6; i += 1) {\n    for (let j = 0; j < 7; j += 1) {\n      const index = i * 7 + j;\n      const d = weekday(startDate, index);\n      const disabled = d.getMonth() !== month;\n      // console.log('d:', d, ', cdate:', cdate);\n      const active = d.getMonth() === cdate.getMonth() && d.getDate() === cdate.getDate();\n      datess[i][j] = { d, disabled, active };\n    }\n  }\n  return datess;\n}\n\nexport default class Calendar {\n  constructor(value) {\n    this.value = value;\n    this.cvalue = new Date(value);\n\n    this.headerLeftEl = h('div', 'calendar-header-left');\n    this.bodyEl = h('tbody', '');\n    this.buildAll();\n    this.el = h('div', 'x-spreadsheet-calendar')\n      .children(\n        h('div', 'calendar-header').children(\n          this.headerLeftEl,\n          h('div', 'calendar-header-right').children(\n            h('a', 'calendar-prev')\n              .on('click.stop', () => this.prev())\n              .child(new Icon('chevron-left')),\n            h('a', 'calendar-next')\n              .on('click.stop', () => this.next())\n              .child(new Icon('chevron-right')),\n          ),\n        ),\n        h('table', 'calendar-body').children(\n          h('thead', '').child(\n            h('tr', '').children(\n              ...t('calendar.weeks').map(week => h('th', 'cell').child(week)),\n            ),\n          ),\n          this.bodyEl,\n        ),\n      );\n    this.selectChange = () => {};\n  }\n\n  setValue(value) {\n    this.value = value;\n    this.cvalue = new Date(value);\n    this.buildAll();\n  }\n\n  prev() {\n    const { value } = this;\n    addMonth(value, -1);\n    this.buildAll();\n  }\n\n  next() {\n    const { value } = this;\n    addMonth(value, 1);\n    this.buildAll();\n  }\n\n  buildAll() {\n    this.buildHeaderLeft();\n    this.buildBody();\n  }\n\n  buildHeaderLeft() {\n    const { value } = this;\n    this.headerLeftEl.html(`${t('calendar.months')[value.getMonth()]} ${value.getFullYear()}`);\n  }\n\n  buildBody() {\n    const { value, cvalue, bodyEl } = this;\n    const mDays = monthDays(value.getFullYear(), value.getMonth(), cvalue);\n    const trs = mDays.map((it) => {\n      const tds = it.map((it1) => {\n        let cls = 'cell';\n        if (it1.disabled) cls += ' disabled';\n        if (it1.active) cls += ' active';\n        return h('td', '').child(\n          h('div', cls)\n            .on('click.stop', () => {\n              this.selectChange(it1.d);\n            })\n            .child(it1.d.getDate().toString()),\n        );\n      });\n      return h('tr', '').children(...tds);\n    });\n    bodyEl.html('').children(...trs);\n  }\n}\n","import Calendar from './calendar';\nimport { h } from './element';\nimport { cssPrefix } from '../config';\n\nexport default class Datepicker {\n  constructor() {\n    this.calendar = new Calendar(new Date());\n    this.el = h('div', `${cssPrefix}-datepicker`).child(\n      this.calendar.el,\n    ).hide();\n  }\n\n  setValue(date) {\n    // console.log(':::::::', date, typeof date, date instanceof string);\n    const { calendar } = this;\n    if (typeof date === 'string') {\n      // console.log(/^\\d{4}-\\d{1,2}-\\d{1,2}$/.test(date));\n      if (/^\\d{4}-\\d{1,2}-\\d{1,2}$/.test(date)) {\n        calendar.setValue(new Date(date.replace(new RegExp('-', 'g'), '/')));\n      }\n    } else if (date instanceof Date) {\n      calendar.setValue(date);\n    }\n    return this;\n  }\n\n  change(cb) {\n    this.calendar.selectChange = (d) => {\n      cb(d);\n      this.hide();\n    };\n  }\n\n  show() {\n    this.el.show();\n  }\n\n  hide() {\n    this.el.hide();\n  }\n}\n","//* global window */\nimport { h } from './element';\nimport Suggest from './suggest';\nimport Datepicker from './datepicker';\nimport { cssPrefix } from '../config';\n// import { mouseMoveUp } from '../event';\n\nfunction resetTextareaSize() {\n  const { inputText } = this;\n  if (!/^\\s*$/.test(inputText)) {\n    const {\n      textlineEl, textEl, areaOffset,\n    } = this;\n    const txts = inputText.split('\\n');\n    const maxTxtSize = Math.max(...txts.map(it => it.length));\n    const tlOffset = textlineEl.offset();\n    const fontWidth = tlOffset.width / inputText.length;\n    const tlineWidth = (maxTxtSize + 1) * fontWidth + 5;\n    const maxWidth = this.viewFn().width - areaOffset.left - fontWidth;\n    let h1 = txts.length;\n    if (tlineWidth > areaOffset.width) {\n      let twidth = tlineWidth;\n      if (tlineWidth > maxWidth) {\n        twidth = maxWidth;\n        h1 += parseInt(tlineWidth / maxWidth, 10);\n        h1 += (tlineWidth % maxWidth) > 0 ? 1 : 0;\n      }\n      textEl.css('width', `${twidth}px`);\n    }\n    h1 *= this.rowHeight;\n    if (h1 > areaOffset.height) {\n      textEl.css('height', `${h1}px`);\n    }\n  }\n}\n\nfunction insertText({ target }, itxt) {\n  const { value, selectionEnd } = target;\n  const ntxt = `${value.slice(0, selectionEnd)}${itxt}${value.slice(selectionEnd)}`;\n  target.value = ntxt;\n  target.setSelectionRange(selectionEnd + 1, selectionEnd + 1);\n\n  this.inputText = ntxt;\n  this.textlineEl.html(ntxt);\n  resetTextareaSize.call(this);\n}\n\nfunction keydownEventHandler(evt) {\n  const { keyCode, altKey, shiftKey } = evt;\n  this.checkChooserTrigger(evt);\n  const arrowExits = !this.viaF2;\n  if (keyCode === 38 || keyCode === 40) {\n    if (arrowExits) {\n      this.clear();\n      if (this.moveCursorFn) {\n        this.moveCursorFn(keyCode === 38 ? -1 : 1, shiftKey, false);\n      }\n    }\n    else {\n      evt.stopImmediatePropagation();\n    }\n    return;\n  }\n  if (keyCode === 37 || keyCode === 39) {\n    if (arrowExits) {\n      this.clear();\n      if (this.moveCursorFn) {\n        this.moveCursorFn(keyCode === 37 ? -1 : 1, shiftKey, true);\n      }\n      return;\n    }\n    setTimeout(() => {\n      this.toggleChooserHint();\n    }, 0);\n  }\n  if (keyCode !== 13 && keyCode !== 9) evt.stopPropagation();\n  if (keyCode === 13 && shiftKey) {\n    insertText.call(this, evt, '\\n');\n    evt.stopPropagation();\n  }\n  if (keyCode === 13 && !altKey) evt.preventDefault();\n  if (keyCode === 27) {\n    this.inputText = this.initialText;\n    this.change('input', this.inputText);\n    this.clear();\n  }\n}\n\nfunction clickEventHandler(evt) {\n  this.toggleChooserHint();\n}\n\nfunction inputEventHandler(evt) {\n  const v = evt.target.value;\n  // console.log(evt, 'v:', v);\n  const { suggest, textlineEl, validator } = this;\n  const { cell } = this;\n  if (cell !== null) {\n    if (('editable' in cell && cell.editable === true) || (cell.editable === undefined)) {\n      this.inputText = v;\n      if (validator) {\n        if (validator.type === 'list') {\n          suggest.search(v);\n        } else {\n          suggest.hide();\n        }\n      } else {\n        const start = v.lastIndexOf('=');\n        if (start !== -1) {\n          suggest.search(v.substring(start + 1));\n        } else {\n          suggest.hide();\n        }\n      }\n      this.toggleChooserHint();\n      textlineEl.html(v);\n      resetTextareaSize.call(this);\n      this.change('input', v);\n    } else {\n      evt.target.value = cell.text;\n    }\n  } else {\n    this.inputText = v;\n    if (validator) {\n      if (validator.type === 'list') {\n        suggest.search(v);\n      } else {\n        suggest.hide();\n      }\n    } else {\n      const start = v.lastIndexOf('=');\n      if (start !== -1) {\n        suggest.search(v.substring(start + 1));\n      } else {\n        suggest.hide();\n      }\n    }\n    this.toggleChooserHint();\n    textlineEl.html(v);\n    resetTextareaSize.call(this);\n    this.change('input', v);\n  }\n}\n\nfunction setTextareaRange(position) {\n  const { el } = this.textEl;\n  setTimeout(() => {\n    el.focus();\n    el.setSelectionRange(position, position);\n    this.toggleChooserHint();\n  }, 0);\n}\n\nfunction setText(text, position, preventFocus) {\n  const { textEl, textlineEl } = this;\n  // firefox bug\n  if (!preventFocus) {\n    textEl.el.blur();\n  }\n\n  textEl.val(text);\n  textlineEl.html(text);\n  if (!preventFocus) {\n    setTextareaRange.call(this, position);\n  }\n}\n\nfunction suggestItemClick(it) {\n  const { inputText, validator } = this;\n  let position = 0;\n  if (validator && validator.type === 'list') {\n    this.inputText = it;\n    position = this.inputText.length;\n  } else {\n    const start = inputText.lastIndexOf('=');\n    const sit = inputText.substring(0, start + 1);\n    let eit = inputText.substring(start + 1);\n    if (eit.indexOf(')') !== -1) {\n      eit = eit.substring(eit.indexOf(')'));\n    } else {\n      eit = '';\n    }\n    this.inputText = `${sit + it.key}(`;\n    // console.log('inputText:', this.inputText);\n    position = this.inputText.length;\n    this.inputText += `)${eit}`;\n  }\n  setText.call(this, this.inputText, position);\n}\n\nfunction resetSuggestItems() {\n  this.suggest.setItems(this.formulas);\n}\n\nfunction dateFormat(d) {\n  let month = d.getMonth() + 1;\n  let date = d.getDate();\n  if (month < 10) month = `0${month}`;\n  if (date < 10) date = `0${date}`;\n  return `${d.getFullYear()}-${month}-${date}`;\n}\n\nexport default class Editor {\n  constructor(formulas, viewFn, rowHeight, moveCursorFn, suggestFormulas, choosers, spreadsheet) {\n    this.viewFn = viewFn;\n    this.rowHeight = rowHeight;\n    this.formulas = formulas;\n    this.moveCursorFn = moveCursorFn;\n    this.choosers = choosers;\n    this.spreadsheet = spreadsheet;\n    this.suggest = new Suggest(formulas, (it) => {\n      suggestItemClick.call(this, it);\n    }, '200px', !suggestFormulas);\n    this.datepicker = new Datepicker();\n    this.datepicker.change((d) => {\n      // console.log('d:', d);\n      this.setText(dateFormat(d));\n      this.clear();\n    });\n    this.areaEl = h('div', `${cssPrefix}-editor-area`)\n      .children(\n        this.textEl = h('textarea', '')\n          .on('input', evt => inputEventHandler.call(this, evt))\n          .on('paste.stop', () => {})\n          .on('keydown', evt => keydownEventHandler.call(this, evt))\n          .on('click', evt => clickEventHandler.call(this, evt)),\n        this.textlineEl = h('div', 'textline'),\n        this.suggest.el,\n        this.datepicker.el,\n        this.htmlFormulaOverlay = h('div', `${cssPrefix}-html-formula-overlay`),\n      )\n      .on('mousemove.stop', () => {})\n      .on('mousedown.stop', () => {});\n    this.el = h('div', `${cssPrefix}-editor`)\n      .child(this.areaEl).hide();\n    this.suggest.bindInputEvents(this.textEl);\n\n    this.areaOffset = null;\n    this.freeze = { w: 0, h: 0 };\n    this.cell = null;\n    this.inputText = '';\n    this.change = () => {};\n    this.isOn = false;\n    this.onClearActions = [];\n  }\n\n  setFreezeLengths(width, height) {\n    this.freeze.w = width;\n    this.freeze.h = height;\n  }\n\n  clear() {\n    this.isOn = false;\n    for (const act of this.onClearActions) {\n        act();\n    }\n    this.onClearActions = [];\n    // const { cell } = this;\n    // const cellText = (cell && cell.text) || '';\n    if (this.inputText !== '') {\n      this.change('finished', this.inputText);\n    }\n    this.cell = null;\n    this.areaOffset = null;\n    this.inputText = '';\n    this.initialText = '';\n    this.el.hide();\n    this.textEl.val('');\n    this.textlineEl.html('');\n    resetSuggestItems.call(this);\n    this.datepicker.hide();\n    this.hideChooserHint();\n  }\n\n  setOffset(offset, suggestPosition = 'top') {\n    const {\n      textEl, areaEl, suggest, freeze, el,\n    } = this;\n    if (offset) {\n      this.areaOffset = offset;\n      const {\n        left, top, width, height, l, t,\n      } = offset;\n      // console.log('left:', left, ',top:', top, ', freeze:', freeze);\n      const elOffset = { left: 0, top: 0 };\n      // top left\n      if (freeze.w > l && freeze.h > t) {\n        //\n      } else if (freeze.w < l && freeze.h < t) {\n        elOffset.left = freeze.w;\n        elOffset.top = freeze.h;\n      } else if (freeze.w > l) {\n        elOffset.top = freeze.h;\n      } else if (freeze.h > t) {\n        elOffset.left = freeze.w;\n      }\n      el.offset(elOffset);\n      areaEl.offset({ left: left - elOffset.left - 0.8, top: top - elOffset.top - 0.8 });\n      textEl.offset({ width: width - 10 + 0.8, height: height - 5 + 0.8 });\n      const sOffset = { left: 0 };\n      sOffset[suggestPosition] = height;\n      suggest.setOffset(sOffset);\n      suggest.hide();\n    }\n  }\n\n  setCell(cell, validator, initialText, viaF2) {\n    this.isOn = true;\n    this.onClearActions = [];\n    // console.log('::', validator);\n    const { el, datepicker, suggest } = this;\n    el.show();\n    this.cell = cell;\n    const text = (cell && cell.text) || '';\n    this.setText(text);\n    this.initialText = typeof(initialText) === \"string\" ? initialText : text;\n    this.viaF2 = !!viaF2;\n\n    this.validator = validator;\n    if (validator) {\n      const { type } = validator;\n      if (type === 'date') {\n        datepicker.show();\n        if (!/^\\s*$/.test(text)) {\n          datepicker.setValue(text);\n        }\n      }\n      if (type === 'list') {\n        suggest.setItems(validator.values());\n        suggest.search('');\n      }\n    }\n  }\n\n  setText(text, preventFocus) {\n    this.inputText = text;\n    // console.log('text>>:', text);\n    setText.call(this, text, text.length, preventFocus);\n    resetTextareaSize.call(this);\n  }\n  \n  appendText(text) {\n    this.setText(this.inputText + text);\n  }\n  \n  injectText(text, idxStart, idxEnd = -1) {\n    const left = this.inputText.substr(0, idxStart);\n    const right = this.inputText.substr(idxEnd >= 0 ? idxEnd : idxStart);\n    this.setText(left + text + right);\n  }\n  \n  getCursorPosition() {\n    return [this.textEl.el.selectionStart, this.textEl.el.selectionEnd];\n  }\n  \n  setCursorPosition(idxStart, idxEnd = -1) {\n    this.textEl.el.selectionStart = idxStart;\n    this.textEl.el.selectionEnd = idxEnd >= 0 ? idxEnd : idxStart;\n  }\n  \n  isEnteringFormula() {\n    return this.inputText && this.inputText.startsWith('=');\n  }\n  \n  toggleChooserHint() {\n    if (document.activeElement != this.textEl.el) {\n      return;\n    }\n    const text = this.inputText;\n    const selection = {\n      start: this.textEl.el.selectionStart,\n      end: this.textEl.el.selectionEnd,\n    };\n    \n    let hint = null;\n    let currentChooser = null;\n    for (const chooser of this.choosers) {\n      const chooserHint = chooser.getHint.call(this.spreadsheet, text, selection);\n      if (chooserHint !== false) {\n        hint = chooserHint;\n        currentChooser = chooser;\n        break;\n      }\n    }\n    \n    if (hint) {\n      this.showChooserHint(hint.html, hint, currentChooser);\n    }\n    else {\n      this.hideChooserHint();\n    }\n  }\n  \n  showChooserHint(html, hint, chooser) {\n    if (!this.chooserHintEl) {\n      this.chooserHintEl = h('div', `${cssPrefix}-chooser-hint`);\n      this.areaEl.child(this.chooserHintEl);\n    }\n    this.chooserHintEl.el.innerHTML = html;\n    this.currentChooserHint = hint;\n    this.currentChooser = chooser;\n  }\n  \n  hideChooserHint() {\n    if (this.chooserHintEl) {\n      try {\n        this.areaEl.removeChild(this.chooserHintEl);\n      }\n      catch {\n      }\n      try {\n        this.chooserHintEl.el.remove();\n      }\n      catch {\n      }\n      this.currentChooser = null;\n      this.currentChooserHint = null;\n      this.chooserHintEl = null;\n    }\n  }\n\n  checkChooserTrigger(evt) {\n    if (!this.currentChooser) {\n      return;\n    }\n    const trigger = this.currentChooserHint.triggers.filter(trigger => {\n      if (evt.keyCode !== trigger.keyCode) {\n        return false;\n      }\n      if (typeof(trigger.ctrlOrMeta) === 'boolean' && (evt.ctrlKey !== trigger.ctrlOrMeta && evt.metaKey !== trigger.ctrlOrMeta)) {\n        return false;\n      }\n      if (typeof(trigger.shift) === 'boolean' && evt.shiftKey !== trigger.shift) {\n        return false;\n      }\n      if (typeof(trigger.alt) === 'boolean' && evt.altKey !== trigger.alt) {\n        return false;\n      }\n      return true;\n    })[0];\n    if (!trigger) {\n      return;\n    }\n    const text = this.inputText;\n    const selection = {\n      start: this.textEl.el.selectionStart,\n      end: this.textEl.el.selectionEnd,\n    };\n    const res = this.currentChooser.onTriggered.call(this.spreadsheet, text, selection);\n    if (!res) {\n      return;\n    }\n    res.then(data => {\n      const { text, cursorPosition } = data;\n      this.setText(text);\n      this.setCursorPosition(cursorPosition.start, cursorPosition.end);\n      setTimeout(() => {\n        this.setCursorPosition(cursorPosition.start, cursorPosition.end);\n      }, 0);\n    });\n  }\n  \n  setFormulaHtml(formulaHtml) {\n    this.htmlFormulaOverlay.el.innerHTML = formulaHtml;\n    if (formulaHtml) {\n      this.textEl.el.style.color = 'rgba(0, 0, 0, 0)';\n    }\n    else {\n      this.textEl.el.style.color = '';\n    }\n  }\n  \n}\n","import { Element } from './element';\nimport { cssPrefix } from '../config';\nimport { t } from '../locale/locale';\n\nexport default class Button extends Element {\n  // type: primary\n  constructor(title, type = '') {\n    super('div', `${cssPrefix}-button ${type}`);\n    this.child(t(`button.${title}`));\n  }\n}\n","/* global window */\nfunction dpr() {\n  return window.devicePixelRatio || 1;\n}\n\nfunction thinLineWidth() {\n  return dpr() - 0.5;\n}\n\nfunction npx(px) {\n  return parseInt(px * dpr(), 10);\n}\n\nfunction revNpx(px) {\n  return px / dpr();\n}\n\nfunction npxLine(px) {\n  const n = npx(px);\n  return n > 0 ? n - 0.5 : 0.5;\n}\n\nclass DrawBox {\n  constructor(x, y, w, h, padding = 0, addedExtraWidth = 0) {\n    this.x = x;\n    this.y = y;\n    this.width = w;\n    this.height = h;\n    this.padding = padding;\n    this.addedExtraWidth = addedExtraWidth;\n    this.bgcolor = '#ffffff';\n    // border: [width, style, color]\n    this.borderTop = null;\n    this.borderRight = null;\n    this.borderBottom = null;\n    this.borderLeft = null;\n  }\n\n  setBorders({\n    top, bottom, left, right,\n  }) {\n    if (top) this.borderTop = top;\n    if (right) this.borderRight = right;\n    if (bottom) this.borderBottom = bottom;\n    if (left) this.borderLeft = left;\n  }\n\n  innerWidth() {\n    return this.width - (this.padding * 2) - 2;\n  }\n\n  innerHeight() {\n    return this.height - (this.padding * 2) - 2;\n  }\n\n  textx(align) {\n    const { width, padding } = this;\n    let { x } = this;\n    if (align === 'left') {\n      x += padding;\n    } else if (align === 'center') {\n      x += width / 2;\n    } else if (align === 'right') {\n      x += width - padding;\n    }\n    return x;\n  }\n\n  texty(align, h) {\n    const { height, padding } = this;\n    let { y } = this;\n    if (align === 'top') {\n      y += padding;\n    } else if (align === 'middle') {\n      y += height / 2 - h / 2;\n    } else if (align === 'bottom') {\n      y += height - padding - h;\n    }\n    return y;\n  }\n\n  topxys() {\n    const { x, y, width } = this;\n    return [[x, y], [x + width, y]];\n  }\n\n  rightxys() {\n    const {\n      x, y, width, height,\n    } = this;\n    return [[x + width, y], [x + width, y + height]];\n  }\n\n  bottomxys() {\n    const {\n      x, y, width, height,\n    } = this;\n    return [[x, y + height], [x + width, y + height]];\n  }\n\n  leftxys() {\n    const {\n      x, y, height,\n    } = this;\n    return [[x, y], [x, y + height]];\n  }\n}\n\nfunction drawFontLine(type, tx, ty, align, valign, blheight, blwidth) {\n  const floffset = { x: 0, y: 0 };\n  if (type === 'underline') {\n    if (valign === 'bottom') {\n      floffset.y = 0;\n    } else if (valign === 'top') {\n      floffset.y = -(blheight + 2);\n    } else {\n      floffset.y = -blheight / 2;\n    }\n  } else if (type === 'strike') {\n    if (valign === 'bottom') {\n      floffset.y = blheight / 2;\n    } else if (valign === 'top') {\n      floffset.y = -((blheight / 2) + 2);\n    }\n  }\n\n  if (align === 'center') {\n    floffset.x = blwidth / 2;\n  } else if (align === 'right') {\n    floffset.x = blwidth;\n  }\n  this.line(\n    [tx - floffset.x, ty - floffset.y],\n    [tx - floffset.x + blwidth, ty - floffset.y],\n  );\n}\n\nclass Draw {\n  constructor(el, width, height, clickableElementFinders, clickableElementsContainer, spreadsheet) {\n    this.el = el;\n    this.ctx = el.getContext('2d');\n    this.resize(width, height);\n    this.ctx.scale(dpr(), dpr());\n    this.clickableElementFinders = clickableElementFinders;\n    this.clickableElementsContainer = clickableElementsContainer;\n    this.spreadsheet = spreadsheet;\n  }\n\n  resize(width, height) {\n    // console.log('dpr:', dpr);\n    this.el.style.width = `${width}px`;\n    this.el.style.height = `${height}px`;\n    this.el.width = npx(width);\n    this.el.height = npx(height);\n  }\n\n  clear() {\n    const { width, height } = this.el;\n    this.ctx.clearRect(0, 0, width, height);\n    return this;\n  }\n\n  attr(options) {\n    Object.assign(this.ctx, options);\n    return this;\n  }\n\n  save() {\n    this.ctx.save();\n    this.ctx.beginPath();\n    return this;\n  }\n\n  restore() {\n    this.ctx.restore();\n    return this;\n  }\n  \n  clipRect(x, y,  w, h) {\n    this.ctx.rect(x, y, w, h);\n    this.ctx.clip();\n  }\n\n  beginPath() {\n    this.ctx.beginPath();\n    return this;\n  }\n\n  translate(x, y) {\n    this.ctx.translate(npx(x), npx(y));\n    return this;\n  }\n\n  scale(x, y) {\n    this.ctx.scale(x, y);\n    return this;\n  }\n\n  clearRect(x, y, w, h) {\n    this.ctx.clearRect(x, y, w, h);\n    return this;\n  }\n\n  fillRect(x, y, w, h) {\n    this.ctx.fillRect(npx(x) - 0.5, npx(y) - 0.5, npx(w), npx(h));\n    return this;\n  }\n\n  fillText(text, x, y) {\n    this.ctx.fillText(text, npx(x), npx(y));\n    return this;\n  }\n  \n  getTextWidth(text, font = null) {\n    if (font) {\n      this.ctx.save();\n      this.attr({\n        font: `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`,\n      });\n    }\n    const width = this.ctx.measureText(text).width;\n    if (font) {\n      this.ctx.restore();\n    }\n    return width;\n  }\n\n  /*\n    txt: render text\n    box: DrawBox\n    attr: {\n      align: left | center | right\n      valign: top | middle | bottom\n      color: '#333333',\n      strike: false,\n      font: {\n        name: 'Arial',\n        size: 14,\n        bold: false,\n        italic: false,\n      }\n    }\n    textWrap: text wrapping\n  */\n  text(mtxt, box, attr = {}, textWrap = true, clipX, clipY, areaId, scrollX, scrollY, frozenWidth, frozenHeight, missingHeightCb) {\n    const { ctx } = this;\n    const {\n      hasAlignSet, align: _align, valign, font, color, strike, underline,\n    } = attr;\n    const align = (hasAlignSet || isNaN(mtxt)) ? _align : 'right';\n    const baseTx = box.textx(align);\n    ctx.save();\n    ctx.beginPath();\n    this.attr({\n      textBaseline: valign,\n      font: `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`,\n      fillStyle: color,\n      strokeStyle: color,\n    });\n    const txts = `${mtxt}`.split('\\n');\n    const biw = box.innerWidth();\n    const ntxts = [];\n    txts.forEach((_it) => {\n      const [clickable, it, texts] = this.parseClickableElements(_it);\n      const txtWidth = this.getTextWidth(it);\n      if (textWrap && txtWidth > npx(biw)) {\n        let textLine = { w: 0, len: 0, start: 0 };\n        let lastSpaceIdx = -1;\n        let wAfterLastSpace = 0;\n        for (let i = 0; i < it.length; i += 1) {\n          if (textLine.w >= npx(biw)) {\n            if (lastSpaceIdx > -1) {\n              textLine.len = lastSpaceIdx - textLine.start;\n              textLine.w -= wAfterLastSpace;\n            }\n            const segments = this.getTextSegments(texts, textLine.start, textLine.len);\n            ntxts.push(segments);\n            if (lastSpaceIdx > -1) {\n              i = lastSpaceIdx + 1;\n              lastSpaceIdx = -1;\n              wAfterLastSpace = 0;\n            }\n            textLine = { w: 0, len: 0, start: i };\n          }\n          textLine.len += 1;\n          let cw = this.getTextWidth(it[i]) + 1;\n          textLine.w += cw;\n          wAfterLastSpace += cw;\n          if (it[i] === ' ' || it[i] === '\\t') {\n            lastSpaceIdx = i;\n            wAfterLastSpace = 0;\n          }\n        }\n        if (textLine.len > 0) {\n          const segments = this.getTextSegments(texts, textLine.start, textLine.len);\n          ntxts.push(segments);\n        }\n      } else {\n        ntxts.push(texts);\n      }\n    });\n    const txtHeight = (ntxts.length - 1) * (font.size + 2);\n    \n    if (textWrap) {\n        const totalTextHeight = txtHeight + font.size;\n        const boxInnerHeight = box.innerHeight();\n        const boxTotalHeight = box.height;\n        if (totalTextHeight > boxInnerHeight) {\n            const missingBoxHeight = Math.ceil(totalTextHeight - boxInnerHeight);\n            const requiredBoxTotalHeight = boxTotalHeight + missingBoxHeight;\n            if (missingHeightCb) {\n                missingHeightCb(requiredBoxTotalHeight);\n            }\n        }\n    }\n    \n    let ty = box.texty(valign, txtHeight);\n    ntxts.forEach((txts) => {\n      let dx = 0;\n      const textWidths = [];\n      let totalWidth = 0;\n      for (const txt of txts) {\n        const txtWidth = revNpx(this.getTextWidth(txt.text));\n        textWidths.push(txtWidth);\n        totalWidth += txtWidth;\n      }\n      let tx = baseTx;\n      if (align == 'right') {\n        tx -= totalWidth;\n      }\n      else if (align == 'center') {\n        tx -= totalWidth / 2;\n      }\n      for (const i in txts) {\n        const txt = txts[i];\n        const txtWidth = textWidths[i];\n        if (!txt.el) {\n          this.fillText(txt.text, tx + dx, ty);\n        }\n        if (strike) {\n          drawFontLine.call(this, 'strike', tx + dx, ty, align, valign, font.size, txtWidth);\n        }\n        if (underline) {\n          drawFontLine.call(this, 'underline', tx + dx, ty, align, valign, font.size, txtWidth);\n        }\n        if (txt.el && this.clickableElementsContainer) {\n          const newEl = document.createElement(\"div\");\n          newEl.innerHTML = '<div class=\"spreadsheet-trigger-container\"><div class=\"spreadsheet-trigger\">' + txt.el.finder.render.call(this.spreadsheet, txt.text, txt.el.data) + '</div></div>';\n          this.clickableElementsContainer.el.appendChild(newEl.children[0]);\n          const elem = this.clickableElementsContainer.el.children[this.clickableElementsContainer.el.children.length - 1];\n          const elem2 = elem.children[0];\n          elem.style.width = box.width + 'px';\n          elem.style.height = box.height + 'px';\n          const boxX = box.x - (areaId === 'frozen-left' || areaId === 'frozen-corner' ? scrollX : 0);\n          const boxY = box.y - (areaId === 'frozen-top' || areaId === 'frozen-corner' ? scrollY : 0);\n          elem.style.left = boxX + 'px';\n          elem.style.top = boxY + 'px';\n          const clipLeft = Math.max(0, clipX - box.x - (areaId === 'frozen-left' ? frozenWidth : 0));\n          const clipTop = Math.max(0, clipY - box.y - (areaId === 'frozen-top' ? frozenHeight : 0));\n          elem.style.clip = `rect(${clipTop}px, 10000px, 10000px, ${clipLeft}px)`;\n          elem2.style.left = Math.floor(tx + dx - box.x) + 'px';\n          let dt = 0;\n          if (valign == 'top') {\n            dt = (font.size + 2) / 2 - 1;\n          }\n          else if (valign == 'bottom') {\n            dt = -(font.size + 2) / 2 + 1;\n          }\n          elem2.style.top = Math.floor(ty - 8 - box.y + dt) + 'px';\n          elem2.addEventListener(\"click\", evt => {\n            if (evt.ctrlKey || evt.metaKey) {\n              txt.el.finder.onCtrlClick.call(this.spreadsheet, txt.el.data);\n            }\n          });\n        }\n        dx += txtWidth;\n      }\n      ty += font.size + 2;\n    });\n    ctx.restore();\n    return this;\n  }\n  \n  getTextSegments(texts, start, length) {\n    const segments = [];\n    let prevLen = 0;\n    for (const data of texts) {\n      const dataStart = prevLen;\n      prevLen = dataStart + data.text.length;\n      const dataEnd = dataStart + data.text.length;\n      if (dataEnd < start || dataStart > start + length) {\n        continue;\n      }\n      if (dataStart >= start && dataEnd <= start + length) {\n        segments.push(data);\n        continue;\n      }\n      if (dataStart >= start && dataEnd > start + length) {\n        // rm tail\n        const d = data.text.length - (dataEnd - (start + length));\n        const txt = data.text.substr(0, d);\n        if (txt.length > 0) {\n          segments.push({\n            text: txt,\n            el: data.el,\n          });\n        }\n        continue;\n      }\n      if (dataStart < start && dataEnd <= start + length) {\n        // rm head\n        const d = start - dataStart;\n        const txt = data.text.substr(d);\n        if (txt.length > 0) {\n          segments.push({\n            text: txt,\n            el: data.el,\n          });\n        }\n        continue;\n      }\n      if (dataStart < start && dataEnd > start + length) {\n        // rm head & tail\n        const d1 = start - dataStart;\n        const d2 = data.text.length - (dataEnd - (start + length));\n        const txt = data.text.substr(d1, d2 - d1);\n        if (txt.length > 0) {\n          segments.push({\n            text: txt,\n            el: data.el,\n          });\n        }\n        continue;\n      }\n    }\n    return segments;\n  }\n  \n  parseClickableElements(text) {\n    if (!this.clickableElementFinders) {\n      return [];\n    }\n    const els = [];\n    const texts = [];\n    for (const finder of this.clickableElementFinders) {\n      const found = finder.finder(text);\n      els.push(...found.map(x => {\n        x.finder = finder;\n        return x;\n      }));\n    }\n    const idxsToRemove = [];\n    for (let i = 0; i < els.length; ++i) {\n      const el = els[i];\n      for (let j = 0; j < els.length; ++j) {\n        if (i === j) {\n          continue;\n        }\n        const el2 = els[j];\n        if (el.start >= el2.start && el.start < el2.start + el2.length) {\n          idxsToRemove.push(i);\n          break;\n        }\n      }\n    }\n    for (let i = idxsToRemove.length - 1; i >= 0; --i) {\n      els.splice(idxsToRemove[i], 1);\n    }\n    let prevEnd = -1;\n    for (const idx in els) {\n      const el = els[idx];\n      const left = text.substr(0, el.start);\n      const forEl = text.substr(el.start, el.length);\n      const right = text.substr(el.start + el.length);\n      const leftPartial = prevEnd < 0 ? left : left.substr(prevEnd);\n      if (leftPartial.length > 0) {\n        texts.push({ text: leftPartial });\n      }\n      prevEnd = el.start + el.length;\n      const txt = ' '.repeat(el.extraPreSpaces) + forEl + ' '.repeat(el.extraPostSpaces);\n      if (txt.length > 0) {\n        texts.push({\n          text: txt,\n          el: el,\n        });\n      }\n      if (right.length > 0 && parseInt(idx) + 1 === els.length) {\n        texts.push({ text: right });\n      }\n    }\n    \n    if (texts.length === 0) {\n      texts.push({ text: text });\n    }\n    \n    let newText = texts.map(txt => txt.text).join('');\n    \n    return [els, newText, texts];\n  }\n\n  border(style, color) {\n    const { ctx } = this;\n    ctx.lineWidth = thinLineWidth;\n    ctx.strokeStyle = color;\n    // console.log('style:', style);\n    if (style === 'medium') {\n      ctx.lineWidth = npx(2) - 0.5;\n    } else if (style === 'thick') {\n      ctx.lineWidth = npx(3);\n    } else if (style === 'dashed') {\n      ctx.setLineDash([npx(3), npx(2)]);\n    } else if (style === 'dotted') {\n      ctx.setLineDash([npx(1), npx(1)]);\n    } else if (style === 'double') {\n      ctx.setLineDash([npx(2), 0]);\n    }\n    return this;\n  }\n\n  line(...xys) {\n    const { ctx } = this;\n    if (xys.length > 1) {\n      ctx.beginPath();\n      const [x, y] = xys[0];\n      ctx.moveTo(npxLine(x), npxLine(y));\n      for (let i = 1; i < xys.length; i += 1) {\n        const [x1, y1] = xys[i];\n        ctx.lineTo(npxLine(x1), npxLine(y1));\n      }\n      ctx.stroke();\n    }\n    return this;\n  }\n\n  strokeBorders(box) {\n    const { ctx } = this;\n    ctx.save();\n    // border\n    const {\n      borderTop, borderRight, borderBottom, borderLeft,\n    } = box;\n    if (borderTop) {\n      this.border(...borderTop);\n      // console.log('box.topxys:', box.topxys());\n      this.line(...box.topxys());\n    }\n    if (borderRight) {\n      this.border(...borderRight);\n      this.line(...box.rightxys());\n    }\n    if (borderBottom) {\n      this.border(...borderBottom);\n      this.line(...box.bottomxys());\n    }\n    if (borderLeft) {\n      this.border(...borderLeft);\n      this.line(...box.leftxys());\n    }\n    ctx.restore();\n  }\n\n  dropdown(box) {\n    const { ctx } = this;\n    const {\n      x, y, width, height,\n    } = box;\n    const sx = x + width - 15;\n    const sy = y + height - 15;\n    ctx.save();\n    ctx.beginPath();\n    ctx.moveTo(npx(sx), npx(sy));\n    ctx.lineTo(npx(sx + 8), npx(sy));\n    ctx.lineTo(npx(sx + 4), npx(sy + 6));\n    ctx.closePath();\n    ctx.fillStyle = 'rgba(0, 0, 0, .45)';\n    ctx.fill();\n    ctx.restore();\n  }\n\n  error(box) {\n    const { ctx } = this;\n    const { x, y, width } = box;\n    const sx = x + width - 1;\n    ctx.save();\n    ctx.beginPath();\n    ctx.moveTo(npx(sx - 8), npx(y - 1));\n    ctx.lineTo(npx(sx), npx(y - 1));\n    ctx.lineTo(npx(sx), npx(y + 8));\n    ctx.closePath();\n    ctx.fillStyle = 'rgba(255, 0, 0, .65)';\n    ctx.fill();\n    ctx.restore();\n  }\n\n  frozen(box) {\n    const { ctx } = this;\n    const { x, y, width } = box;\n    const sx = x + width - 1;\n    ctx.save();\n    ctx.beginPath();\n    ctx.moveTo(npx(sx - 8), npx(y - 1));\n    ctx.lineTo(npx(sx), npx(y - 1));\n    ctx.lineTo(npx(sx), npx(y + 8));\n    ctx.closePath();\n    ctx.fillStyle = 'rgba(0, 255, 0, .85)';\n    ctx.fill();\n    ctx.restore();\n  }\n\n  rect(box, dtextcb, addExtraPaddingTop, addExtraPaddingLeft) {\n    const { ctx } = this;\n    const {\n      x, y, width, height, bgcolor,\n    } = box;\n    ctx.save();\n    ctx.beginPath();\n    ctx.fillStyle = bgcolor || '#fff';\n    ctx.rect(\n        npxLine(x + 1) - (addExtraPaddingLeft ? 0 : 0.5),\n        npxLine(y + 1) - (addExtraPaddingTop ? 0 : 0.5),\n        npx(width - 2) + 0 + (addExtraPaddingLeft ? 0 : 1),\n        npx(height - 2) + 0 + (addExtraPaddingTop ? 0 : 1)\n    );\n    ctx.clip();\n    ctx.fill();\n    dtextcb();\n    ctx.restore();\n  }\n}\n\nexport default {};\nexport {\n  Draw,\n  DrawBox,\n  thinLineWidth,\n  npx,\n  revNpx,\n};\n","// docs\nimport './_.prototypes';\n\n/** default font list\n * @type {BaseFont[]}\n */\nconst baseFonts = [\n  { key: 'Arial', title: 'Arial' },\n  { key: 'Helvetica', title: 'Helvetica' },\n  { key: 'Source Sans Pro', title: 'Source Sans Pro' },\n  { key: 'Comic Sans MS', title: 'Comic Sans MS' },\n  { key: 'Courier New', title: 'Courier New' },\n  { key: 'Verdana', title: 'Verdana' },\n  { key: 'Lato', title: 'Lato' },\n];\n\n/** default fontSize list\n * @type {FontSize[]}\n */\nconst fontSizes = [\n  { pt: 7.5, px: 10 },\n  { pt: 8, px: 11 },\n  { pt: 9, px: 12 },\n  { pt: 10, px: 13 },\n  { pt: 10.5, px: 14 },\n  { pt: 11, px: 15 },\n  { pt: 12, px: 16 },\n  { pt: 14, px: 18.7 },\n  { pt: 15, px: 20 },\n  { pt: 16, px: 21.3 },\n  { pt: 18, px: 24 },\n  { pt: 22, px: 29.3 },\n  { pt: 24, px: 32 },\n  { pt: 26, px: 34.7 },\n  { pt: 36, px: 48 },\n  { pt: 42, px: 56 },\n  // { pt: 54, px: 71.7 },\n  // { pt: 63, px: 83.7 },\n  // { pt: 72, px: 95.6 },\n];\n\n/** map pt to px\n * @date 2019-10-10\n * @param {fontsizePT} pt\n * @returns {fontsizePX}\n */\nfunction getFontSizePxByPt(pt) {\n  for (let i = 0; i < fontSizes.length; i += 1) {\n    const fontSize = fontSizes[i];\n    if (fontSize.pt === pt) {\n      return fontSize.px;\n    }\n  }\n  return pt;\n}\n\n/** transform baseFonts to map\n * @date 2019-10-10\n * @param {BaseFont[]} [ary=[]]\n * @returns {object}\n */\nfunction fonts(ary = []) {\n  const map = {};\n  baseFonts.concat(ary).forEach((f) => {\n    map[f.key] = f;\n  });\n  return map;\n}\n\nexport default {};\nexport {\n  fontSizes,\n  fonts,\n  baseFonts,\n  getFontSizePxByPt,\n};\n","/**\n  formula:\n    key\n    title\n    render\n*/\n/**\n * @typedef {object} Formula\n * @property {string} key\n * @property {function} title\n * @property {function} render\n */\nimport { tf } from '../locale/locale';\nimport { numberCalc } from './helper';\n\n/** @type {Formula[]} */\nconst baseFormulas = [\n  {\n    key: 'SUM',\n    title: tf('formula.sum'),\n    render: ary => ary.reduce((a, b) => numberCalc('+', a, b), 0),\n  },\n  {\n    key: 'AVERAGE',\n    title: tf('formula.average'),\n    render: ary => ary.reduce((a, b) => Number(a) + Number(b), 0) / ary.length,\n  },\n  {\n    key: 'MAX',\n    title: tf('formula.max'),\n    render: ary => Math.max(...ary.map(v => Number(v))),\n  },\n  {\n    key: 'MIN',\n    title: tf('formula.min'),\n    render: ary => Math.min(...ary.map(v => Number(v))),\n  },\n  {\n    key: 'IF',\n    title: tf('formula._if'),\n    render: ([b, t, f]) => (b ? t : f),\n  },\n  {\n    key: 'AND',\n    title: tf('formula.and'),\n    render: ary => ary.every(it => it),\n  },\n  {\n    key: 'OR',\n    title: tf('formula.or'),\n    render: ary => ary.some(it => it),\n  },\n  {\n    key: 'CONCAT',\n    title: tf('formula.concat'),\n    render: ary => ary.join(''),\n  },\n  /* support:  1 + A1 + B2 * 3\n  {\n    key: 'DIVIDE',\n    title: tf('formula.divide'),\n    render: ary => ary.reduce((a, b) => Number(a) / Number(b)),\n  },\n  {\n    key: 'PRODUCT',\n    title: tf('formula.product'),\n    render: ary => ary.reduce((a, b) => Number(a) * Number(b),1),\n  },\n  {\n    key: 'SUBTRACT',\n    title: tf('formula.subtract'),\n    render: ary => ary.reduce((a, b) => Number(a) - Number(b)),\n  },\n  */\n];\n\nconst formulas = baseFormulas;\n\n// const formulas = (formulaAry = []) => {\n//   const formulaMap = {};\n//   baseFormulas.concat(formulaAry).forEach((f) => {\n//     formulaMap[f.key] = f;\n//   });\n//   return formulaMap;\n// };\nconst formulam = {};\nbaseFormulas.forEach((f) => {\n  formulam[f.key] = f;\n});\n\nexport default {\n};\n\nconst addCustomFormula = (key, title, render) => {\n  formulas.push({ key, title: () => title, render });\n  formulam[key] = formulas[formulas.length - 1];\n};\n\nexport {\n  formulam,\n  formulas,\n  baseFormulas,\n  addCustomFormula,\n};\n","import { expr2xy, xy2expr } from './alphabet';\nimport { numberCalc } from './helper';\nimport { formulam } from './formula';\n\n// Converting infix expression to a suffix expression\n// src: AVERAGE(SUM(A1,A2), B1) + 50 + B20\n// return: [A1, A2], SUM[, B1],AVERAGE,50,+,B20,+\nconst infixExprToSuffixExpr = (src) => {\n  const operatorStack = [];\n  const stack = [];\n  let subStrs = []; // SUM, A1, B2, 50 ...\n  let fnArgType = 0; // 1 => , 2 => :\n  let fnArgOperator = '';\n  let fnArgsLens = [];\n  let oldc = '';\n  for (let i = 0; i < src.length; i += 1) {\n    const c = src.charAt(i);\n    if (c !== ' ') {\n      if (c == '#' && src.substr(i, 4).toUpperCase() == '#REF') {\n        stack.push('\"#REF');\n        i += 3;\n      } else if (c >= 'a' && c <= 'z') {\n        subStrs.push(c.toUpperCase());\n      } else if ((c >= '0' && c <= '9') || (c >= 'A' && c <= 'Z') || c === '.' || c == '$') {\n        subStrs.push(c);\n      } else if (c === '\"') {\n        i += 1;\n        while (src.charAt(i) !== '\"' && i < src.length) {\n          subStrs.push(src.charAt(i));\n          i += 1;\n        }\n        stack.push(`\"${subStrs.join('')}`);\n        subStrs = [];\n      } else if (c === '-' && /[+\\-*/,(]/.test(oldc)) {\n        subStrs.push(c);\n      } else {\n        // console.log('subStrs:', subStrs.join(''), stack);\n        if (c !== '(' && subStrs.length > 0) {\n          stack.push(subStrs.join(''));\n        }\n        if (c === ')') {\n          let c1 = operatorStack.pop();\n          if (fnArgType === 2) {\n            // fn argument range => A1:B5\n            try {\n              let [ex, ey] = expr2xy(stack.pop());\n              let [sx, sy] = expr2xy(stack.pop());\n              if (ex < sx) {\n                [sx, ex] = [ex, sx];\n              }\n              if (ey < sy) {\n                [sy, ey] = [ey, sy];\n              }\n              // console.log('::', sx, sy, ex, ey);\n              let rangelen = 0;\n              for (let x = sx; x <= ex; x += 1) {\n                for (let y = sy; y <= ey; y += 1) {\n                  stack.push(xy2expr(x, y));\n                  rangelen += 1;\n                }\n              }\n              stack.push([c1, rangelen]);\n            } catch (e) {\n              // console.log(e);\n            }\n          } else if (fnArgType === 1 || fnArgType === 3) {\n            if (fnArgType === 3) stack.push(fnArgOperator);\n            // fn argument => A1,A2,B5\n            stack.push([c1, fnArgsLens[fnArgsLens.length - 1]]);\n            fnArgsLens.splice(fnArgsLens.length - 1, 1);\n          } else {\n            // console.log('c1:', c1, fnArgType, stack, operatorStack);\n            while (c1 !== '(') {\n              if (isFormulaName(c1)) {\n                stack.push([c1,fnArgsLens[fnArgsLens.length - 1]]);\n                fnArgsLens.splice(fnArgsLens.length - 1, 1);\n              }\n              else {\n                stack.push(c1);\n              }\n              if (operatorStack.length <= 0) break;\n              c1 = operatorStack.pop();\n            }\n          }\n          fnArgType = 0;\n        } else if (c === '=' || c === '>' || c === '<') {\n          const nc = src.charAt(i + 1);\n          fnArgOperator = c;\n          if (nc === '=' || nc === '-') {\n            fnArgOperator += nc;\n            i += 1;\n          }\n          fnArgType = 3;\n        } else if (c === ':') {\n          fnArgType = 2;\n        } else if (c === ',') {\n          if (fnArgType === 3) {\n            stack.push(fnArgOperator);\n          }\n          fnArgType = 1;\n          if (fnArgsLens.length === 0) {\n            fnArgsLens.push(1);\n          }\n          fnArgsLens[fnArgsLens.length - 1] += 1;\n        } else if (c === '(') {\n          if (subStrs.length > 0) {\n            // function\n            operatorStack.push(subStrs.join(''));\n            if (isFormulaName(subStrs.join(''))) {\n              fnArgsLens.push(1);\n            }\n          }\n          else {\n            const startIdx = i + 1;\n            const endIdx = getClosingBracketIndex(src, startIdx);\n            if (endIdx >= 0) {\n              const inner = infixExprToSuffixExpr(src.substring(startIdx, endIdx));\n              i = endIdx;\n              stack.push(...inner);\n            }\n          }\n        } else {\n          // priority: */ > +-\n          // console.log('xxxx:', operatorStack, c, stack);\n          if (operatorStack.length > 0 && (c === '+' || c === '-')) {\n            let top = operatorStack[operatorStack.length - 1];\n            if (top !== '(') stack.push(operatorStack.pop());\n            if (top === '*' || top === '/') {\n              while (operatorStack.length > 0) {\n                top = operatorStack[operatorStack.length - 1];\n                if (top !== '(') stack.push(operatorStack.pop());\n                else break;\n              }\n            }\n          } else if (operatorStack.length > 0) {\n            const top = operatorStack[operatorStack.length - 1];\n            if (top === '*' || top === '/') stack.push(operatorStack.pop());\n          }\n          operatorStack.push(c);\n        }\n        subStrs = [];\n      }\n      oldc = c;\n    }\n  }\n  if (subStrs.length > 0) {\n    stack.push(subStrs.join(''));\n  }\n  while (operatorStack.length > 0) {\n    stack.push(operatorStack.pop());\n  }\n  return stack;\n};\n\nconst isFormulaName = text => {\n  if (typeof(text) !== 'string') {\n    return false;\n  }\n  return text in formulam;\n};\n\nconst getClosingBracketIndex = (str, startIdx) => {\n  let depth = 1;\n  for (let i = startIdx; i < str.length; ++i) {\n    const c = str[i];\n    if (c === ')') {\n      depth--;\n      if (depth === 0) {\n        return i;\n      }\n    }\n    else if (c === '(') {\n      depth++;\n    }\n  }\n  return -1;\n};\n\nconst evalSubExpr = (subExpr, cellRender) => {\n  const [fl] = subExpr;\n  let expr = subExpr;\n  if (fl === '\"') {\n    return subExpr.substring(1);\n  }\n  let ret = 1;\n  if (fl === '-') {\n    expr = subExpr.substring(1);\n    ret = -1;\n  }\n  if (expr[0] >= '0' && expr[0] <= '9') {\n    return ret * Number(expr);\n  }\n  const [x, y] = expr2xy(expr);\n  const cellValue = cellRender(x, y);\n  if (ret === 1 && typeof(cellValue) === 'string'){ \n    return cellValue === '' ? 0 : cellValue;\n  }\n  return ret * cellValue;\n};\n\n// evaluate the suffix expression\n// srcStack: <= infixExprToSufixExpr\n// formulaMap: {'SUM': {}, ...}\n// cellRender: (x, y) => {}\nconst evalSuffixExpr = (spreadsheet, srcStack, formulaMap, cellRender, cellList) => {\n  for (const cell of cellList) {\n    if (srcStack.includes(cell)) {\n      return '#ERR';\n    }\n  }\n  const stack = [];\n  // console.log(':::::formulaMap:', formulaMap);\n  for (let i = 0; i < srcStack.length; i += 1) {\n    // console.log(':::>>>', srcStack[i]);\n    const expr = srcStack[i];\n    const fc = expr[0];\n    if (expr === '+') {\n      const top = stack.pop();\n      stack.push(numberCalc('+', stack.pop(), top));\n    } else if (expr === '-') {\n      if (stack.length === 1) {\n        const top = stack.pop();\n        stack.push(numberCalc('*', top, -1));\n      } else {\n        const top = stack.pop();\n        stack.push(numberCalc('-', stack.pop(), top));\n      }\n    } else if (expr === '*') {\n      stack.push(numberCalc('*', stack.pop(), stack.pop()));\n    } else if (expr === '/') {\n      const top = stack.pop();\n      stack.push(numberCalc('/', stack.pop(), top));\n    } else if (fc === '=' || fc === '>' || fc === '<') {\n      let top = stack.pop();\n      if (!Number.isNaN(top)) top = Number(top);\n      let left = stack.pop();\n      if (!Number.isNaN(left)) left = Number(left);\n      let ret = false;\n      if (fc === '=') {\n        ret = (left === top);\n      } else if (expr === '>') {\n        ret = (left > top);\n      } else if (expr === '>=') {\n        ret = (left >= top);\n      } else if (expr === '<') {\n        ret = (left < top);\n      } else if (expr === '<=') {\n        ret = (left <= top);\n      }\n      stack.push(ret);\n    } else if (Array.isArray(expr)) {\n      const [formula, len] = expr;\n      const params = [];\n      for (let j = 0; j < len; j += 1) {\n        params.push(stack.pop());\n      }\n      try {\n        stack.push(formulaMap[formula].render.call(spreadsheet, params.reverse()));\n      }\n      catch {\n        return '#ERR';\n      }\n    } else {\n      if (cellList.includes(expr)) {\n        return '#ERR';\n      }\n      if ((fc >= 'a' && fc <= 'z') || (fc >= 'A' && fc <= 'Z')) {\n        cellList.push(expr);\n      }\n      stack.push(evalSubExpr(expr, cellRender));\n      cellList.pop();\n    }\n    // console.log('stack:', stack);\n  }\n  if (typeof(stack[0]) === 'number' && isNaN(stack[0])) {\n    return '#ERR';\n  }\n  if (typeof(stack[0]) === 'string' && (stack[0].includes('#ERR') || stack[0].includes('NaN'))) {\n    return '#ERR';\n  }\n  return `${stack[0]}`;\n};\n\nfunction isFormulaSyntaxValid(str) {\n  const stack = [];\n  for (let i = 0; i < str.length; ++i) {\n    const c = str[i];\n    if (c === '(') {\n      stack.push('(');\n    }\n    else if (c === ')') {\n      if (stack.pop() !== '(') {\n        return false;\n      }\n    }\n  }\n  return stack.length === 0;\n}\n\nconst cellRender = (spreadsheet, src, formulaMap, getCellText, cellList = []) => {\n  if (src[0] === '=') {\n    if (!isFormulaSyntaxValid(src)) {\n      return '#ERR';\n    }\n    const stack = infixExprToSuffixExpr(src.substring(1));\n    if (stack.length <= 0) return src;\n    return evalSuffixExpr(\n      spreadsheet,\n      stack,\n      formulaMap,\n      (x, y) => cellRender(spreadsheet, getCellText(x, y), formulaMap, getCellText, cellList),\n      cellList,\n    );\n  }\n  return src;\n};\n\nexport default {\n  render: cellRender,\n};\nexport {\n  infixExprToSuffixExpr,\n};\n","import { tf } from '../locale/locale';\n\nconst formatStringRender = v => v;\n\nconst formatNumberRender = (v) => {\n  // match \"-12.1\" or \"12\" or \"12.1\"\n  if (/^(-?\\d*.?\\d*)$/.test(v)) {\n    const v1 = Number(v).toFixed(2).toString();\n    const [first, ...parts] = v1.split('\\\\.');\n    return [first.replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1,'), ...parts];\n  }\n  return v;\n};\n\nconst baseFormats = [\n  {\n    key: 'normal',\n    title: tf('format.normal'),\n    type: 'string',\n    render: formatStringRender,\n  },\n  {\n    key: 'text',\n    title: tf('format.text'),\n    type: 'string',\n    render: formatStringRender,\n  },\n  {\n    key: 'number',\n    title: tf('format.number'),\n    type: 'number',\n    label: '1,000.12',\n    render: formatNumberRender,\n  },\n  {\n    key: 'percent',\n    title: tf('format.percent'),\n    type: 'number',\n    label: '10.12%',\n    render: v => `${v}%`,\n  },\n  {\n    key: 'rmb',\n    title: tf('format.rmb'),\n    type: 'number',\n    label: '￥10.00',\n    render: v => `￥${formatNumberRender(v)}`,\n  },\n  {\n    key: 'usd',\n    title: tf('format.usd'),\n    type: 'number',\n    label: '$10.00',\n    render: v => `$${formatNumberRender(v)}`,\n  },\n  {\n    key: 'eur',\n    title: tf('format.eur'),\n    type: 'number',\n    label: '€10.00',\n    render: v => `€${formatNumberRender(v)}`,\n  },\n  {\n    key: 'date',\n    title: tf('format.date'),\n    type: 'date',\n    label: '26/09/2008',\n    render: formatStringRender,\n  },\n  {\n    key: 'time',\n    title: tf('format.time'),\n    type: 'date',\n    label: '15:59:00',\n    render: formatStringRender,\n  },\n  {\n    key: 'datetime',\n    title: tf('format.datetime'),\n    type: 'date',\n    label: '26/09/2008 15:59:00',\n    render: formatStringRender,\n  },\n  {\n    key: 'duration',\n    title: tf('format.duration'),\n    type: 'date',\n    label: '24:01:00',\n    render: formatStringRender,\n  },\n];\n\n// const formats = (ary = []) => {\n//   const map = {};\n//   baseFormats.concat(ary).forEach((f) => {\n//     map[f.key] = f;\n//   });\n//   return map;\n// };\nconst formatm = {};\nbaseFormats.forEach((f) => {\n  formatm[f.key] = f;\n});\n\nexport default {\n};\nexport {\n  formatm,\n  baseFormats,\n};\n","import { stringAt } from '../core/alphabet';\nimport { getFontSizePxByPt } from '../core/font';\nimport _cell from '../core/cell';\nimport { formulam } from '../core/formula';\nimport { formatm } from '../core/format';\n\nimport {\n  Draw, DrawBox, thinLineWidth, npx, revNpx,\n} from '../canvas/draw';\n// gobal var\nconst cellPaddingWidth = 5;\nconst tableGridStyle = {\n  fillStyle: '#fff',\n  lineWidth: thinLineWidth,\n  strokeStyle: '#e6e6e6',\n};\n\nfunction getDrawBox(data, rindex, cindex, yoffset = 0, textWidth = -1) {\n  if (textWidth >= 0) {\n    textWidth = revNpx(textWidth + cellPaddingWidth * 2);\n  }\n  const {\n    left, top, width, height, addedExtraWidth,\n  } = data.cellRect(rindex, cindex, true, textWidth);\n  return new DrawBox(left, top + yoffset, width, height, cellPaddingWidth, addedExtraWidth);\n}\n/*\nfunction renderCellBorders(bboxes, translateFunc) {\n  const { draw } = this;\n  if (bboxes) {\n    const rset = new Set();\n    // console.log('bboxes:', bboxes);\n    bboxes.forEach(({ ri, ci, box }) => {\n      if (!rset.has(ri)) {\n        rset.add(ri);\n        translateFunc(ri);\n      }\n      draw.strokeBorders(box);\n    });\n  }\n}\n*/\n\nfunction getHighlightInfo(spreadsheet, rindex, cindex) {\n  if (spreadsheet.highlightFormulaCells) {\n    const highlightInfo = spreadsheet.highlightFormulaCells.find(coords => coords[0] == cindex && coords[1] == rindex);\n    return highlightInfo;\n  }\n  return null;\n}\n\nexport function renderCell(spreadsheet, draw, data, rindex, cindex, yoffset = 0, clipX, clipY, areaId = 'main', scrollX, scrollY, frozenWidth, frozenHeight, renderedBorders) {\n  const { sortedRowMap, rows, cols } = data;\n  if (rows.isHide(rindex) || cols.isHide(cindex)) return;\n  let nrindex = rindex;\n  if (sortedRowMap.has(rindex)) {\n    nrindex = sortedRowMap.get(rindex);\n  }\n\n  const cell = data.getCell(nrindex, cindex);\n  const highlightInfo = getHighlightInfo(spreadsheet, rindex, cindex);\n  if (cell === null && !highlightInfo) return;\n  let frozen = false;\n  if (cell && 'editable' in cell && cell.editable === false) {\n    frozen = true;\n  }\n\n  const style = data.getCellStyleOrDefault(nrindex, cindex);\n  // render text\n  let cellText = '';\n  if (cell) {\n    if (!data.settings.evalPaused) {\n      cellText = _cell.render(spreadsheet, cell.text || '', formulam, (y, x) => (data.getCellTextOrDefault(x, y)));\n      cell._lastRenderedFormula = cellText;\n    } else {\n      cellText = cell.text || '';\n    }\n    if (style.customFormatter) {\n      if (!style.customFormatter.prepareCellStyle && data.settings.cellCustomFormatterCreator) {\n        data.settings.cellCustomFormatterCreator(style);\n      }\n      if (style.customFormatter.prepareCellStyle) {\n        style.customFormatter.prepareCellStyle(cellText, style);\n      }\n    }\n  }\n  const font = Object.assign({}, style.font);\n  font.size = getFontSizePxByPt(font.size);\n  const dbox = getDrawBox(data, rindex, cindex, yoffset, Math.ceil(draw.getTextWidth(cellText, font)));\n  dbox.bgcolor = style.bgcolor;\n  if (style.border !== undefined) {\n    const skipRightBorder = dbox.addedExtraWidth > 0;\n    const styleBorder = Object.assign({}, style.border);\n    if (skipRightBorder) {\n      delete styleBorder.right;\n    }\n    dbox.setBorders(styleBorder);\n    // bboxes.push({ ri: rindex, ci: cindex, box: dbox });\n    draw.strokeBorders(dbox);\n  }\n  if (highlightInfo) {\n    const borderStyle = ['thick', highlightInfo[2]];\n    dbox.setBorders({\n      top: borderStyle,\n      right: borderStyle,\n      bottom: borderStyle,\n      left: borderStyle,\n    });\n    draw.strokeBorders(dbox);\n  }\n  renderedBorders[`${rindex}_${cindex}`] = {\n      top: dbox.borderTop ? dbox.borderTop[0] : 'none',\n      right: dbox.borderRight ? dbox.borderRight[0] : 'none',\n      bottom: dbox.borderBottom ? dbox.borderBottom[0] : 'none',\n      left: dbox.borderLeft ? dbox.borderLeft[0] : 'none',\n  };\n  if (cell === null) return;\n  if (data.isCellEmpty(cellText, style) && !cell.merge) return;\n  const prevBottomBorder = renderedBorders[`${rindex - 1}_${cindex}`] ? renderedBorders[`${rindex - 1}_${cindex}`].bottom : 'none';\n  const prevRightBorder = renderedBorders[`${rindex}_${cindex - 1}`] ? renderedBorders[`${rindex}_${cindex - 1}`].right : 'none';\n  draw.rect(\n    dbox,\n    () => {\n        if (style.format) {\n          // console.log(data.formatm, '>>', cell.format);\n          cellText = formatm[style.format].render(cellText);\n        }\n        if (style.customFormatter) {\n          if (!style.customFormatter.formatCellText && data.settings.cellCustomFormatterCreator) {\n            data.settings.cellCustomFormatterCreator(style);\n          }\n          if (style.customFormatter.formatCellText) {\n            cellText = style.customFormatter.formatCellText(cellText);\n          }\n        }\n        const font = Object.assign({}, style.font);\n        font.size = getFontSizePxByPt(font.size);\n        // console.log('style:', style);\n        draw.text(cellText, dbox, {\n          hasAlignSet: style.hasAlignSet,\n          align: style.align,\n          valign: style.valign,\n          font,\n          color: style.color,\n          strike: style.strike,\n          underline: style.underline,\n        }, style.textwrap, clipX, clipY, areaId, scrollX, scrollY, frozenWidth, frozenHeight, requiredBoxTotalHeight => {\n          setTimeout(() => {\n            spreadsheet.sheet.resizeRowAfterClearingEditor(rindex, requiredBoxTotalHeight);\n          }, 0);\n        });\n        // error\n        const error = data.validations.getError(rindex, cindex);\n        if (error) {\n        // console.log('error:', rindex, cindex, error);\n          draw.error(dbox);\n        }\n        if (frozen) {\n          draw.frozen(dbox);\n        }\n    },\n    prevBottomBorder === 'thick',\n    prevRightBorder === 'thick',\n  );\n}\n\nfunction renderAutofilter(viewRange) {\n  const { data, draw } = this;\n  if (viewRange) {\n    const { autoFilter } = data;\n    if (!autoFilter.active()) return;\n    const afRange = autoFilter.hrange();\n    if (viewRange.intersects(afRange)) {\n      afRange.each((ri, ci) => {\n        const dbox = getDrawBox(data, ri, ci);\n        draw.dropdown(dbox);\n      });\n    }\n  }\n}\n\nfunction renderContent(spreadsheet, viewRange, fw, fh, tx, ty, areaId = 'main', frozenWidth, frozenHeight, scrollX, scrollY) {\n  const { draw, data } = this;\n  draw.save();\n  draw.translate(fw, fh)\n    .translate(tx, ty);\n\n  const { exceptRowSet } = data;\n  // const exceptRows = Array.from(exceptRowSet);\n  const filteredTranslateFunc = (ri) => {\n    const ret = exceptRowSet.has(ri);\n    if (ret) {\n      const height = data.rows.getHeight(ri);\n      draw.translate(0, -height);\n    }\n    return !ret;\n  };\n\n  const exceptRowTotalHeight = data.exceptRowTotalHeight(viewRange.sri, viewRange.eri);\n  const renderedBorders = {};\n  // 1 render cell\n  draw.save();\n  draw.translate(0, -exceptRowTotalHeight);\n  viewRange.each((ri, ci) => {\n    renderCell(spreadsheet, draw, data, ri, ci, 0, 0, 0, areaId, scrollX, scrollY, frozenWidth, frozenHeight, renderedBorders);\n  }, ri => filteredTranslateFunc(ri));\n  draw.restore();\n\n\n  // 2 render mergeCell\n  const rset = new Set();\n  draw.save();\n  draw.translate(0, -exceptRowTotalHeight);\n  if (areaId === 'main') {\n    draw.clipRect(\n      npx(-tx + frozenWidth),\n      npx(-ty + frozenHeight),\n      npx(viewRange.w),\n      npx(viewRange.h)\n    );\n  }\n  else if (areaId === 'frozen-left') {\n    draw.clipRect(\n      npx(0),\n      npx(-ty + frozenHeight),\n      npx(viewRange.w),\n      npx(viewRange.h)\n    );\n  }\n  else if (areaId === 'frozen-top') {\n    draw.clipRect(\n      npx(-tx + frozenWidth),\n      npx(0),\n      npx(viewRange.w),\n      npx(viewRange.h)\n    );\n  }\n  data.eachMergesInView(viewRange, ({ sri, sci, eri }) => {\n    if (!exceptRowSet.has(sri)) {\n      renderCell(spreadsheet, draw, data, sri, sci, 0, frozenWidth - tx, frozenHeight - ty, areaId, scrollX, scrollY, frozenWidth, frozenHeight, renderedBorders);\n    } else if (!rset.has(sri)) {\n      rset.add(sri);\n      const height = data.rows.sumHeight(sri, eri + 1);\n      draw.translate(0, -height);\n    }\n  });\n  draw.restore();\n\n  // 3 render autofilter\n  renderAutofilter.call(this, viewRange);\n\n  draw.restore();\n}\n\nfunction renderSelectedHeaderCell(x, y, w, h) {\n  const { draw } = this;\n  draw.save();\n  draw.attr({ fillStyle: this.spreadsheet.data.settings.cellHeaderStyle.selectedBgcolor })\n    .fillRect(x, y, w, h);\n  draw.restore();\n}\n\n// viewRange\n// type: all | left | top\n// w: the fixed width of header\n// h: the fixed height of header\n// tx: moving distance on x-axis\n// ty: moving distance on y-axis\nfunction renderFixedHeaders(type, viewRange, w, h, tx, ty) {\n  const { draw, data } = this;\n  const sumHeight = viewRange.h; // rows.sumHeight(viewRange.sri, viewRange.eri + 1);\n  const sumWidth = viewRange.w; // cols.sumWidth(viewRange.sci, viewRange.eci + 1);\n  const nty = ty + h;\n  const ntx = tx + w;\n\n  draw.save();\n  // draw rect background\n  draw.attr({ fillStyle: this.spreadsheet.data.settings.cellHeaderStyle.bgcolor });\n  if (type === 'all' || type === 'left') draw.fillRect(0, nty, w, sumHeight);\n  if (type === 'all' || type === 'top') draw.fillRect(ntx, 0, sumWidth, h);\n\n  const {\n    sri, sci, eri, eci,\n  } = data.selector.range;\n  // console.log(data.selectIndexes);\n  // draw text\n  // text font, align...\n  draw.attr({\n    textAlign: 'center',\n    textBaseline: 'middle',\n    font: `500 ${npx(12)}px ${this.spreadsheet.data.settings.cellHeaderStyle.fontFamily}`,\n    fillStyle: '#585757',\n    lineWidth: thinLineWidth(),\n    strokeStyle: '#e6e6e6',\n  });\n  // y-header-text\n  if (type === 'all' || type === 'left') {\n    data.rowEach(viewRange.sri, viewRange.eri, (i, y1, rowHeight) => {\n      const y = nty + y1;\n      const ii = i;\n      draw.line([0, y], [w, y]);\n      if (sri <= ii && ii < eri + 1) {\n        renderSelectedHeaderCell.call(this, 0, y, w, rowHeight);\n      }\n      draw.fillText(ii + 1, w / 2, y + (rowHeight / 2));\n      if (i > 0 && data.rows.isHide(i - 1)) {\n        draw.save();\n        draw.attr({ strokeStyle: '#c6c6c6' });\n        draw.line([5, y + 5], [w - 5, y + 5]);\n        draw.restore();\n      }\n    });\n    draw.line([0, sumHeight + nty], [w, sumHeight + nty]);\n    draw.line([w, nty], [w, sumHeight + nty]);\n  }\n  // x-header-text\n  if (type === 'all' || type === 'top') {\n    data.colEach(viewRange.sci, viewRange.eci, (i, x1, colWidth) => {\n      const x = ntx + x1;\n      const ii = i;\n      draw.line([x, 0], [x, h]);\n      if (sci <= ii && ii < eci + 1) {\n        renderSelectedHeaderCell.call(this, x, 0, colWidth, h);\n      }\n      draw.fillText(stringAt(ii), x + (colWidth / 2), h / 2);\n      if (i > 0 && data.cols.isHide(i - 1)) {\n        draw.save();\n        draw.attr({ strokeStyle: '#c6c6c6' });\n        draw.line([x + 5, 5], [x + 5, h - 5]);\n        draw.restore();\n      }\n    });\n    draw.line([sumWidth + ntx, 0], [sumWidth + ntx, h]);\n    draw.line([0, h], [sumWidth + ntx, h]);\n  }\n  draw.restore();\n}\n\nfunction renderFixedLeftTopCell(fw, fh) {\n  const { draw } = this;\n  draw.save();\n  // left-top-cell\n  draw.attr({ fillStyle: this.spreadsheet.data.settings.cellHeaderStyle.cornerBgcolor })\n    .fillRect(0, 0, fw, fh);\n  draw.restore();\n}\n\nfunction renderContentGrid({\n  sri, sci, eri, eci, w, h,\n}, fw, fh, tx, ty) {\n  const { draw, data } = this;\n  const { settings } = data;\n\n  draw.save();\n  draw.attr(tableGridStyle)\n    .translate(fw + tx, fh + ty);\n  // const sumWidth = cols.sumWidth(sci, eci + 1);\n  // const sumHeight = rows.sumHeight(sri, eri + 1);\n  // console.log('sumWidth:', sumWidth);\n  // draw.clearRect(0, 0, w, h);\n  if (!settings.showGrid) {\n    draw.restore();\n    return;\n  }\n  // console.log('rowStart:', rowStart, ', rowLen:', rowLen);\n  data.rowEach(sri, eri, (i, y, ch) => {\n    // console.log('y:', y);\n    if (i !== sri) draw.line([0, y], [w, y]);\n    if (i === eri) draw.line([0, y + ch], [w, y + ch]);\n  });\n  data.colEach(sci, eci, (i, x, cw) => {\n    if (i !== sci) draw.line([x, 0], [x, h]);\n    if (i === eci) draw.line([x + cw, 0], [x + cw, h]);\n  });\n  draw.restore();\n}\n\nfunction renderFreezeHighlightLine(fw, fh, ftw, fth) {\n  const { draw, data } = this;\n  const twidth = data.viewWidth() - fw;\n  const theight = data.viewHeight() - fh;\n  draw.save()\n    .translate(fw, fh)\n    .attr({ strokeStyle: 'rgba(75, 137, 255, .6)' });\n  draw.line([0, fth], [twidth, fth]);\n  draw.line([ftw, 0], [ftw, theight]);\n  draw.restore();\n}\n\n/** end */\nclass Table {\n  constructor(el, data, spreadsheet, clickableElementsInner) {\n    this.el = el;\n    this.draw = new Draw(el, data.viewWidth(), data.viewHeight(), spreadsheet.getClickableElementFinders(), clickableElementsInner, spreadsheet);\n    this.data = data;\n    this.spreadsheet = spreadsheet;\n    this.clickableElementsInner = clickableElementsInner;\n  }\n\n  resetData(data) {\n    this.data = data;\n    this.render();\n  }\n\n  render() {\n    this.clickableElementsInner.el.innerHTML = '';\n    // resize canvas\n    const { data } = this;\n    const { rows, cols } = data;\n    // fixed width of header\n    const fw = cols.indexWidth;\n    // fixed height of header\n    const fh = rows.height;\n\n    this.draw.resize(data.viewWidth(), data.viewHeight());\n    this.clear();\n\n    const viewRange = data.viewRange();\n    // renderAll.call(this, viewRange, data.scroll);\n    const tx = data.freezeTotalWidth();\n    const ty = data.freezeTotalHeight();\n    const { x, y } = data.scroll;\n    // 1\n    renderContentGrid.call(this, viewRange, fw, fh, tx, ty);\n    renderContent.call(this, this.spreadsheet, viewRange, fw, fh, -x, -y, 'main', tx, ty, -x, -y);\n    renderFixedHeaders.call(this, 'all', viewRange, fw, fh, tx, ty);\n    renderFixedLeftTopCell.call(this, fw, fh);\n    const [fri, fci] = data.freeze;\n    if (fri > 0 || fci > 0) {\n      // 2\n      if (fri > 0) {\n        const vr = viewRange.clone();\n        vr.sri = 0;\n        vr.eri = fri - 1;\n        vr.h = ty;\n        renderContentGrid.call(this, vr, fw, fh, tx, 0);\n        renderContent.call(this, this.spreadsheet, vr, fw, fh, -x, 0, 'frozen-top', tx, ty, -x, -y);\n        renderFixedHeaders.call(this, 'top', vr, fw, fh, tx, 0);\n      }\n      // 3\n      if (fci > 0) {\n        const vr = viewRange.clone();\n        vr.sci = 0;\n        vr.eci = fci - 1;\n        vr.w = tx;\n        renderContentGrid.call(this, vr, fw, fh, 0, ty);\n        renderFixedHeaders.call(this, 'left', vr, fw, fh, 0, ty);\n        renderContent.call(this, this.spreadsheet, vr, fw, fh, 0, -y, 'frozen-left', tx, ty, -x, -y);\n      }\n      // 4\n      const freezeViewRange = data.freezeViewRange();\n      renderContentGrid.call(this, freezeViewRange, fw, fh, 0, 0);\n      renderFixedHeaders.call(this, 'all', freezeViewRange, fw, fh, 0, 0);\n      renderContent.call(this, this.spreadsheet, freezeViewRange, fw, fh, 0, 0, 'frozen-corner', tx, ty, -x, -y);\n      // 5\n      renderFreezeHighlightLine.call(this, fw, fh, tx, ty);\n    }\n  }\n\n  clear() {\n    this.draw.clear();\n  }\n}\n\nexport default Table;\n","/* global window document */\nimport { h } from './element';\nimport { cssPrefix } from '../config';\nimport Button from './button';\nimport { Draw } from '../canvas/draw';\nimport { renderCell } from './table';\nimport { t } from '../locale/locale';\n\n// resolution: 72 => 595 x 842\n// 150 => 1240 x 1754\n// 200 => 1654 x 2339\n// 300 => 2479 x 3508\n// 96 * cm / 2.54 , 96 * cm / 2.54\n\nconst PAGER_SIZES = [\n  ['A3', 11.69, 16.54],\n  ['A4', 8.27, 11.69],\n  ['A5', 5.83, 8.27],\n  ['B4', 9.84, 13.90],\n  ['B5', 6.93, 9.84],\n];\n\nconst PAGER_ORIENTATIONS = ['landscape', 'portrait'];\n\nfunction inches2px(inc) {\n  return parseInt(96 * inc, 10);\n}\n\nfunction btnClick(type) {\n  if (type === 'cancel') {\n    this.el.hide();\n  } else {\n    this.toPrint();\n  }\n}\n\nfunction pagerSizeChange(evt) {\n  const { paper } = this;\n  const { value } = evt.target;\n  const ps = PAGER_SIZES[value];\n  paper.w = inches2px(ps[1]);\n  paper.h = inches2px(ps[2]);\n  // console.log('paper:', ps, paper);\n  this.preview();\n}\nfunction pagerOrientationChange(evt) {\n  const { paper } = this;\n  const { value } = evt.target;\n  const v = PAGER_ORIENTATIONS[value];\n  paper.orientation = v;\n  this.preview();\n}\n\nexport default class Print {\n  constructor(data, spreadsheet) {\n    this.paper = {\n      w: inches2px(PAGER_SIZES[0][1]),\n      h: inches2px(PAGER_SIZES[0][2]),\n      padding: 50,\n      orientation: PAGER_ORIENTATIONS[0],\n      get width() {\n        return this.orientation === 'landscape' ? this.h : this.w;\n      },\n      get height() {\n        return this.orientation === 'landscape' ? this.w : this.h;\n      },\n    };\n    this.data = data;\n    this.spreadsheet = spreadsheet;\n    this.el = h('div', `${cssPrefix}-print`)\n      .children(\n        h('div', `${cssPrefix}-print-bar`)\n          .children(\n            h('div', '-title').child('Print settings'),\n            h('div', '-right').children(\n              h('div', `${cssPrefix}-buttons`).children(\n                new Button('cancel').on('click', btnClick.bind(this, 'cancel')),\n                new Button('next', 'primary').on('click', btnClick.bind(this, 'next')),\n              ),\n            ),\n          ),\n        h('div', `${cssPrefix}-print-content`)\n          .children(\n            this.contentEl = h('div', '-content'),\n            h('div', '-sider').child(\n              h('form', '').children(\n                h('fieldset', '').children(\n                  h('label', '').child(`${t('print.size')}`),\n                  h('select', '').children(\n                    ...PAGER_SIZES.map((it, index) => h('option', '').attr('value', index).child(`${it[0]} ( ${it[1]}''x${it[2]}'' )`)),\n                  ).on('change', pagerSizeChange.bind(this)),\n                ),\n                h('fieldset', '').children(\n                  h('label', '').child(`${t('print.orientation')}`),\n                  h('select', '').children(\n                    ...PAGER_ORIENTATIONS.map((it, index) => h('option', '').attr('value', index).child(`${t('print.orientations')[index]}`)),\n                  ).on('change', pagerOrientationChange.bind(this)),\n                ),\n              ),\n            ),\n          ),\n      ).hide();\n  }\n\n  resetData(data) {\n    this.data = data;\n  }\n\n  preview() {\n    const { data, paper } = this;\n    const { width, height, padding } = paper;\n    const iwidth = width - padding * 2;\n    const iheight = height - padding * 2;\n    const cr = data.contentRange();\n    const pages = parseInt(cr.h / iheight, 10) + 1;\n    const scale = iwidth / cr.w;\n    let left = padding;\n    const top = padding;\n    if (scale > 1) {\n      left += (iwidth - cr.w) / 2;\n    }\n    let ri = 0;\n    let yoffset = 0;\n    this.contentEl.html('');\n    this.canvases = [];\n    const mViewRange = {\n      sri: 0,\n      sci: 0,\n      eri: 0,\n      eci: 0,\n    };\n    for (let i = 0; i < pages; i += 1) {\n      let th = 0;\n      let yo = 0;\n      const wrap = h('div', `${cssPrefix}-canvas-card`);\n      const canvas = h('canvas', `${cssPrefix}-canvas`);\n      this.canvases.push(canvas.el);\n      const draw = new Draw(canvas.el, width, height);\n      // cell-content\n      draw.save();\n      draw.translate(left, top);\n      if (scale < 1) draw.scale(scale, scale);\n      // console.log('ri:', ri, cr.eri, yoffset);\n      for (; ri <= cr.eri; ri += 1) {\n        const rh = data.rows.getHeight(ri);\n        th += rh;\n        if (th < iheight) {\n          for (let ci = 0; ci <= cr.eci; ci += 1) {\n            renderCell(this.spreadsheet, draw, data, ri, ci, yoffset);\n            mViewRange.eci = ci;\n          }\n        } else {\n          yo = -(th - rh);\n          break;\n        }\n      }\n      mViewRange.eri = ri;\n      draw.restore();\n      // merge-cell\n      draw.save();\n      draw.translate(left, top);\n      if (scale < 1) draw.scale(scale, scale);\n      const yof = yoffset;\n      data.eachMergesInView(mViewRange, ({ sri, sci }) => {\n        renderCell(this.spreadsheet, draw, data, sri, sci, yof);\n      });\n      draw.restore();\n\n      mViewRange.sri = mViewRange.eri;\n      mViewRange.sci = mViewRange.eci;\n      yoffset += yo;\n      this.contentEl.child(h('div', `${cssPrefix}-canvas-card-wraper`).child(wrap.child(canvas)));\n    }\n    this.el.show();\n  }\n\n  toPrint() {\n    this.el.hide();\n    const { paper } = this;\n    const iframe = h('iframe', '').hide();\n    const { el } = iframe;\n    window.document.body.appendChild(el);\n    const { contentWindow } = el;\n    const idoc = contentWindow.document;\n    const style = document.createElement('style');\n    style.innerHTML = `\n      @page { size: ${paper.width}px ${paper.height}px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    `;\n    idoc.head.appendChild(style);\n    this.canvases.forEach((it) => {\n      const cn = it.cloneNode(false);\n      const ctx = cn.getContext('2d');\n      // ctx.imageSmoothingEnabled = true;\n      ctx.drawImage(it, 0, 0);\n      idoc.body.appendChild(cn);\n    });\n    contentWindow.print();\n  }\n}\n","import { h } from './element';\nimport { bindClickoutside, unbindClickoutside } from './event';\nimport { cssPrefix } from '../config';\nimport { tf } from '../locale/locale';\n\nconst menuItems = [\n  { key: 'copy', title: tf('contextmenu.copy'), label: 'Ctrl+C' },\n  { key: 'cut', title: tf('contextmenu.cut'), label: 'Ctrl+X' },\n  { key: 'paste', title: tf('contextmenu.paste'), label: 'Ctrl+V' },\n  { key: 'paste-value', title: tf('contextmenu.pasteValue'), label: 'Ctrl+Shift+V' },\n  { key: 'paste-format', title: tf('contextmenu.pasteFormat'), label: 'Ctrl+Alt+V' },\n  { key: 'divider' },\n  { key: 'insert-row-before', title: tf('contextmenu.insertRowBefore') },\n  { key: 'insert-row-after', title: tf('contextmenu.insertRowAfter') },\n  { key: 'insert-rows-before', title: tf('contextmenu.insertRowsBefore') },\n  { key: 'insert-rows-after', title: tf('contextmenu.insertRowsAfter') },\n  { key: 'insert-column-before', title: tf('contextmenu.insertColumnBefore') },\n  { key: 'insert-column-after', title: tf('contextmenu.insertColumnAfter') },\n  { key: 'insert-columns-before', title: tf('contextmenu.insertColumnsBefore') },\n  { key: 'insert-columns-after', title: tf('contextmenu.insertColumnsAfter') },\n  { key: 'divider' },\n  { key: 'delete-row', title: tf('contextmenu.deleteRow') },\n  { key: 'delete-rows', title: tf('contextmenu.deleteRows') },\n  { key: 'delete-column', title: tf('contextmenu.deleteColumn') },\n  { key: 'delete-columns', title: tf('contextmenu.deleteColumns') },\n  { key: 'delete-cell-text', title: tf('contextmenu.deleteCellText') },\n  { key: 'hide', title: tf('contextmenu.hide') },\n  { key: 'divider' },\n  { key: 'reset-row-height', title: tf('contextmenu.resetRowHeight') },\n  { key: 'reset-column-width', title: tf('contextmenu.resetColumnWidth') },\n  { key: 'divider' },\n  { key: 'validation', title: tf('contextmenu.validation') },\n  { key: 'divider' },\n  { key: 'cell-printable', title: tf('contextmenu.cellprintable') },\n  { key: 'cell-non-printable', title: tf('contextmenu.cellnonprintable') },\n  { key: 'divider' },\n  { key: 'cell-editable', title: tf('contextmenu.celleditable') },\n  { key: 'cell-non-editable', title: tf('contextmenu.cellnoneditable') },\n];\n\nfunction buildMenuItem(item) {\n  let el = null;\n  if (item.key === 'divider') {\n    el = h('div', `${cssPrefix}-item divider`);\n  }\n  else {\n    el = h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        if (item.callback) {\n          item.callback(this.targetRange);\n        }\n        this.itemClick(item.key);\n        this.hide();\n      })\n      .children(\n        item.title(),\n        h('div', 'label').child(item.label || ''),\n      );\n  }\n  el.attr(\"data-key\", item.key);\n  el.key = item.key;\n  return el;\n}\n\nfunction buildMenu(extraItems) {\n  const processedMenuItems = [...menuItems];\n  if (extraItems && extraItems.length > 0) {\n    processedMenuItems.push({ key: 'divider' });\n    for (const item of extraItems) {\n      processedMenuItems.push(item);\n    }\n  }\n  if (this.contextMenuOptions && this.contextMenuOptions.itemsCallback) {\n    this.contextMenuOptions.itemsCallback(processedMenuItems);\n  }\n  return processedMenuItems.map(it => buildMenuItem.call(this, it));\n}\n\nexport default class ContextMenu {\n  constructor(viewFn, isHide = false, isHideForRange = false, contextMenuOptions = null) {\n    this.contextMenuOptions = contextMenuOptions;\n    this.menuItems = buildMenu.call(this, contextMenuOptions.extraItems);\n    this.el = h('div', `${cssPrefix}-contextmenu`)\n      .children(...this.menuItems)\n      .hide();\n    this.viewFn = viewFn;\n    this.itemClick = () => {};\n    this.isHide = isHide;\n    this.isHideForRange = isHideForRange;\n    this.setTargetRange({ sci: 0, eci: 0, sri: 0, eri: 0 });\n  }\n\n  setTargetRange(range) {\n    this.targetRange = range;\n    const hideEl = this.getItemByKey('hide');\n    let mode = 'range';\n    if (range.sci < 0) {\n      mode = 'row';\n    }\n    else if (range.sri < 0) {\n      mode = 'col';\n    }\n    this.mode = mode;\n    if (mode === 'range') {\n      if (this.isHideForRange) {\n        this.hide();\n      }\n      if (hideEl) {\n        hideEl.hide();\n      }\n    } else {\n      if (hideEl) {\n        hideEl.show();\n      }\n    }\n    for (const item of this.contextMenuOptions.extraItems) {\n      const show = item.isVisibleCallback(range);\n      this.toggleShowElements([this.getItemByKey(item.key)], show);\n    }\n    this.toggleShowSingleColumnElements(range.sci >= 0 && range.sci === range.eci);\n    this.toggleShowMultiColumnElements(range.sci >= 0 && range.sci !== range.eci);\n    this.toggleShowSingleRowElements(range.sri >= 0 && range.sri === range.eri);\n    this.toggleShowMultiRowElements(range.sri >= 0 && range.sri !== range.eri);\n    this.toggleShowElements([this.getItemByKey('reset-column-width')], range.sci >= 0);\n    this.toggleShowElements([this.getItemByKey('reset-row-height')], range.sri >= 0);\n    \n    for (const item of this.menuItems) {\n      if (item.key === 'divider') {\n        item.show();\n      }\n    }\n    \n    let hasPrevVisibleItem = false;\n    for (let i = 0; i < this.menuItems.length; ++i) {\n      const item = this.menuItems[i];\n      if (item.key === 'divider') {\n        if (!hasPrevVisibleItem) {\n          item.hide();\n        }\n        hasPrevVisibleItem = false;\n      }\n      else {\n        hasPrevVisibleItem = hasPrevVisibleItem || !item.isHidden();\n      }\n    }\n    hasPrevVisibleItem = false;\n    for (let i = this.menuItems.length - 1; i > 0; --i) {\n      const item = this.menuItems[i]; \n      if (item.key === 'divider') {\n        if (!hasPrevVisibleItem) {\n          item.hide();\n        }\n        hasPrevVisibleItem = false;\n      }\n      else {\n        hasPrevVisibleItem = hasPrevVisibleItem || !item.isHidden();\n      }\n    }\n  }\n  \n  getItemByKey(key) {\n    for (const item of this.menuItems) {\n      if (item.key === key) {\n        return item;\n      }\n    }\n    return null;\n  }\n  \n  toggleShowSingleColumnElements(show) {\n    const elements = [\n      this.getItemByKey('delete-column'),\n      this.getItemByKey('insert-column-before'),\n      this.getItemByKey('insert-column-after'),\n    ];\n    this.toggleShowElements(elements, show);\n  }\n  \n  toggleShowMultiColumnElements(show) {\n    const elements = [\n      this.getItemByKey('delete-columns'),\n      this.getItemByKey('insert-columns-before'),\n      this.getItemByKey('insert-columns-after'),\n    ];\n    this.toggleShowElements(elements, show);\n  }\n  \n  toggleShowSingleRowElements(show) {\n    const elements = [\n      this.getItemByKey('delete-row'),\n      this.getItemByKey('insert-row-before'),\n      this.getItemByKey('insert-row-after'),\n    ];\n    this.toggleShowElements(elements, show);\n  }\n  \n  toggleShowMultiRowElements(show) {\n    const elements = [\n      this.getItemByKey('delete-rows'),\n      this.getItemByKey('insert-rows-before'),\n      this.getItemByKey('insert-rows-after'),\n    ];\n    this.toggleShowElements(elements, show);\n  }\n  \n  toggleShowElements(elements, show) {\n    const hide = !show;\n    for (const element of elements) {\n      if (element) {\n        if (hide) {\n          element.hide();\n        }\n        else {\n          element.show();\n        }\n      }\n    }\n  }\n\n  hide() {\n    const { el } = this;\n    el.hide();\n    unbindClickoutside(el);\n  }\n\n  setPosition(x, y) {\n    if (this.isHide) return;\n    if (this.isHideForRange && this.mode === 'range') return;\n    const { el } = this;\n    if (this.origElements) {\n      const el = this.el.el;\n      for (let i = el.children.length - 1; i >= 0; --i) {\n        el.removeChild(el.children[i]);\n      }\n      for (let i = 0; i < this.origElements.length; ++i) {\n        el.appendChild(this.origElements[i]);\n      }\n    }\n    this.origElements = this.el.el.querySelectorAll('.x-spreadsheet-item');\n    if (this.contextMenuOptions && this.contextMenuOptions.preShowCallback) {\n      this.contextMenuOptions.preShowCallback(el.el, this.targetRange);\n    }\n    const { width } = el.show().offset();\n    const view = this.viewFn();\n    const vhf = view.height / 2;\n    let left = x;\n    if (view.width - x <= width) {\n      left -= width;\n    }\n    el.css('left', `${left}px`);\n    if (y > vhf) {\n      el.css('bottom', `${view.height - y}px`)\n        .css('max-height', `${y}px`)\n        .css('top', 'auto');\n    } else {\n      el.css('top', `${y}px`)\n        .css('max-height', `${view.height - y}px`)\n        .css('bottom', 'auto');\n    }\n    bindClickoutside(el);\n  }\n}\n","import { cssPrefix } from '../../config';\nimport tooltip from '../tooltip';\nimport { h } from '../element';\nimport { t } from '../../locale/locale';\n\nexport default class Item {\n  // tooltip\n  // tag: the subclass type\n  // shortcut: shortcut key\n  constructor(tag, shortcut, value) {\n    this.tip = '';\n    if (tag) this.tip = t(`toolbar.${tag.replace(/-[a-z]/g, c => c[1].toUpperCase())}`);\n    if (shortcut) this.tip += ` (${shortcut})`;\n    this.tag = tag;\n    this.shortcut = shortcut;\n    this.value = value;\n    this.el = this.element();\n    this.change = () => {};\n  }\n\n  element() {\n    const { tip } = this;\n    return h('div', `${cssPrefix}-toolbar-btn ${cssPrefix}-toolbar-btn--${this.tag}`)\n      .on('mouseenter', (evt) => {\n        if (this.tip) tooltip(this.tip, evt.target);\n      })\n      .attr('data-tooltip', tip);\n  }\n\n  setState() {}\n}\n","/* global document */\nimport { h } from './element';\nimport { bind } from './event';\nimport { cssPrefix } from '../config';\n\nexport default function tooltip(html, target) {\n  if (target.classList.contains('active')) {\n    return;\n  }\n  const {\n    left, top, width, height,\n  } = target.getBoundingClientRect();\n  const el = h('div', `${cssPrefix}-tooltip`).html(html).show();\n  document.body.appendChild(el.el);\n  const elBox = el.box();\n  // console.log('elBox:', elBox);\n  el.css('left', `${left + (width / 2) - (elBox.width / 2)}px`)\n    .css('top', `${top + height + 2}px`);\n\n  bind(target, 'mouseleave', () => {\n    if (document.body.contains(el.el)) {\n      document.body.removeChild(el.el);\n    }\n  });\n\n  bind(target, 'click', () => {\n    if (document.body.contains(el.el)) {\n      document.body.removeChild(el.el);\n    }\n  });\n}\n","import Item from './item';\n\nexport default class DropdownItem extends Item {\n  dropdown() {}\n\n  getValue(v) {\n    return v;\n  }\n\n  element() {\n    const { tag } = this;\n    this.dd = this.dropdown();\n    this.dd.change = it => this.change(tag, this.getValue(it));\n    return super.element().child(\n      this.dd,\n    );\n  }\n\n  setState(v) {\n    if (v) {\n      this.value = v;\n      this.dd.setTitle(v);\n    }\n  }\n}\n","import { Element, h } from './element';\nimport { bindClickoutside, unbindClickoutside } from './event';\nimport { cssPrefix } from '../config';\n\nexport default class Dropdown extends Element {\n  constructor(title, width, showArrow, placement, ...children) {\n    super('div', `${cssPrefix}-dropdown ${placement}`);\n    this.title = title;\n    this.change = () => {};\n    this.headerClick = () => {};\n    if (typeof title === 'string') {\n      this.title = h('div', `${cssPrefix}-dropdown-title`).child(title);\n    } else if (showArrow) {\n      this.title.addClass('arrow-left');\n    }\n    this.contentEl = h('div', `${cssPrefix}-dropdown-content`)\n      .css('width', width)\n      .hide();\n\n    this.setContentChildren(...children);\n\n    this.headerEl = h('div', `${cssPrefix}-dropdown-header`);\n    this.headerEl.on('click', () => {\n      if (this.contentEl.css('display') !== 'block') {\n        this.show();\n      } else {\n        this.hide();\n      }\n    }).children(\n      this.title,\n      showArrow ? h('div', `${cssPrefix}-icon arrow-right`).child(\n        h('div', `${cssPrefix}-icon-img arrow-down`),\n      ) : '',\n    );\n    this.children(this.headerEl, this.contentEl);\n  }\n\n  setContentChildren(...children) {\n    this.contentEl.html('');\n    if (children.length > 0) {\n      this.contentEl.children(...children);\n    }\n  }\n\n  setTitle(title) {\n    this.title.html(title);\n    this.hide();\n  }\n\n  show() {\n    const { contentEl } = this;\n    contentEl.show();\n    this.parent().active();\n    bindClickoutside(this.parent(), () => {\n      this.hide();\n    });\n  }\n\n  hide() {\n    this.parent().active(false);\n    this.contentEl.hide();\n    unbindClickoutside(this.parent());\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nfunction buildItemWithIcon(iconName) {\n  return h('div', `${cssPrefix}-item`).child(new Icon(iconName));\n}\n\nexport default class DropdownAlign extends Dropdown {\n  constructor(aligns, align) {\n    const icon = new Icon(`align-${align}`);\n    const naligns = aligns.map(it => buildItemWithIcon(`align-${it}`)\n      .on('click', () => {\n        this.setTitle(it);\n        this.change(it);\n      }));\n    super(icon, 'auto', true, 'bottom-left', ...naligns);\n  }\n\n  setTitle(align) {\n    this.title.setName(`align-${align}`);\n    this.hide();\n  }\n}\n","import DropdownItem from './dropdown_item';\nimport DropdownAlign from '../dropdown_align';\n\nexport default class Align extends DropdownItem {\n  constructor(value) {\n    super('align', '', value);\n  }\n\n  dropdown() {\n    const { value } = this;\n    return new DropdownAlign(['left', 'center', 'right'], value);\n  }\n}\n","import DropdownItem from './dropdown_item';\nimport DropdownAlign from '../dropdown_align';\n\nexport default class Valign extends DropdownItem {\n  constructor(value) {\n    super('valign', '', value);\n  }\n\n  dropdown() {\n    const { value } = this;\n    return new DropdownAlign(['top', 'middle', 'bottom'], value);\n  }\n}\n","import Item from './item';\nimport Icon from '../icon';\n\nexport default class ToggleItem extends Item {\n  element() {\n    const { tag } = this;\n    return super.element()\n      .child(new Icon(tag))\n      .on('click', () => this.click());\n  }\n\n  click() {\n    this.change(this.tag, this.toggle());\n  }\n\n  setState(active) {\n    this.el.active(active);\n  }\n\n  toggle() {\n    return this.el.toggle();\n  }\n\n  active() {\n    return this.el.hasClass('active');\n  }\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Autofilter extends ToggleItem {\n  constructor() {\n    super('autofilter');\n  }\n\n  setState() {}\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Bold extends ToggleItem {\n  constructor() {\n    super('font-bold', 'Ctrl+B');\n  }\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Italic extends ToggleItem {\n  constructor() {\n    super('font-italic', 'Ctrl+I');\n  }\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Strike extends ToggleItem {\n  constructor() {\n    super('strike', 'Ctrl+U');\n  }\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Underline extends ToggleItem {\n  constructor() {\n    super('underline', 'Ctrl+U');\n  }\n}\n","import { h } from './element';\nimport { cssPrefix } from '../config';\n\nconst themeColorPlaceHolders = ['#ffffff', '#000100', '#e7e5e6', '#445569', '#5b9cd6', '#ed7d31', '#a5a5a5', '#ffc001', '#4371c6', '#71ae47'];\n\nconst themeColors = [\n  ['#f2f2f2', '#7f7f7f', '#d0cecf', '#d5dce4', '#deeaf6', '#fce5d5', '#ededed', '#fff2cd', '#d9e2f3', '#e3efd9'],\n  ['#d8d8d8', '#595959', '#afabac', '#adb8ca', '#bdd7ee', '#f7ccac', '#dbdbdb', '#ffe59a', '#b3c6e7', '#c5e0b3'],\n  ['#bfbfbf', '#3f3f3f', '#756f6f', '#8596b0', '#9cc2e6', '#f4b184', '#c9c9c9', '#fed964', '#8eaada', '#a7d08c'],\n  ['#a5a5a5', '#262626', '#3a3839', '#333f4f', '#2e75b5', '#c45a10', '#7b7b7b', '#bf8e01', '#2f5596', '#538136'],\n  ['#7f7f7f', '#0c0c0c', '#171516', '#222a35', '#1f4e7a', '#843c0a', '#525252', '#7e6000', '#203864', '#365624'],\n];\n\nconst standardColors = ['#c00000', '#fe0000', '#fdc101', '#ffff01', '#93d051', '#00b04e', '#01b0f1', '#0170c1', '#012060', '#7030a0'];\n\nexport const highlightColors = ['#445589', '#71ae47', '#7030a0', '#fe0000', '#e68f12', '#3874ad', '#a00000', '#000000'];\n\nfunction buildTd(bgcolor) {\n  return h('td', '').child(\n    h('div', `${cssPrefix}-color-palette-cell`)\n      .on('click.stop', () => this.change(bgcolor))\n      .css('background-color', bgcolor),\n  );\n}\n\nexport default class ColorPalette {\n  constructor() {\n    this.el = h('div', `${cssPrefix}-color-palette`);\n    this.change = () => {};\n    const table = h('table', '').children(\n      h('tbody', '').children(\n        h('tr', `${cssPrefix}-theme-color-placeholders`).children(\n          ...themeColorPlaceHolders.map(color => buildTd.call(this, color)),\n        ),\n        ...themeColors.map(it => h('tr', `${cssPrefix}-theme-colors`).children(\n          ...it.map(color => buildTd.call(this, color)),\n        )),\n        h('tr', `${cssPrefix}-standard-colors`).children(\n          ...standardColors.map(color => buildTd.call(this, color)),\n        ),\n      ),\n    );\n    this.el.child(table);\n  }\n}\n","import Dropdown from './dropdown';\nimport Icon from './icon';\nimport ColorPalette from './color_palette';\n\nexport default class DropdownColor extends Dropdown {\n  constructor(iconName, color) {\n    const icon = new Icon(iconName)\n      .css('height', '16px')\n      .css('border-bottom', `3px solid ${color}`);\n    const colorPalette = new ColorPalette();\n    colorPalette.change = (v) => {\n      this.setTitle(v);\n      this.change(v);\n    };\n    super(icon, 'auto', false, 'bottom-left', colorPalette.el);\n  }\n\n  setTitle(color) {\n    this.title.css('border-color', color);\n    this.hide();\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nconst lineTypes = [\n  ['thin', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['medium', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"2\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.0\" x2=\"50\" y2=\"1.0\" stroke-width=\"2\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['thick', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.5\" x2=\"50\" y2=\"1.5\" stroke-width=\"3\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['dashed', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"2\" style=\"user-select: none;\"></line></svg>'],\n  ['dotted', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"1\" style=\"user-select: none;\"></line></svg>'],\n  // ['double', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line><line x1=\"0\" y1=\"2.5\" x2=\"50\" y2=\"2.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n];\n\nexport default class DropdownLineType extends Dropdown {\n  constructor(type) {\n    const icon = new Icon('line-type');\n    let beforei = 0;\n    const lineTypeEls = lineTypes.map((it, iti) => h('div', `${cssPrefix}-item state ${type === it[0] ? 'checked' : ''}`)\n      .on('click', () => {\n        lineTypeEls[beforei].toggle('checked');\n        lineTypeEls[iti].toggle('checked');\n        beforei = iti;\n        this.hide();\n        this.change(it);\n      })\n      .child(\n        h('div', `${cssPrefix}-line-type`).html(it[1]),\n      ));\n\n    super(icon, 'auto', false, 'bottom-left', ...lineTypeEls);\n  }\n}\n","import { h } from './element';\nimport Icon from './icon';\nimport DropdownColor from './dropdown_color';\nimport DropdownLineType from './dropdown_linetype';\nimport { cssPrefix } from '../config';\n\nfunction buildTable(...trs) {\n  return h('table', '').child(\n    h('tbody', '').children(...trs),\n  );\n}\n\nfunction buildTd(iconName) {\n  return h('td', '').child(\n    h('div', `${cssPrefix}-border-palette-cell`).child(\n      new Icon(`border-${iconName}`),\n    ).on('click', () => {\n      this.mode = iconName;\n      const { mode, style, color } = this;\n      this.change({ mode, style, color });\n    }),\n  );\n}\n\nexport default class BorderPalette {\n  constructor() {\n    this.color = '#000';\n    this.style = 'thin';\n    this.mode = 'all';\n    this.change = () => {};\n    this.ddColor = new DropdownColor('line-color', this.color);\n    this.ddColor.change = (color) => {\n      this.color = color;\n    };\n    this.ddType = new DropdownLineType(this.style);\n    this.ddType.change = ([s]) => {\n      this.style = s;\n    };\n    this.el = h('div', `${cssPrefix}-border-palette`);\n    const table = buildTable(\n      h('tr', '').children(\n        h('td', `${cssPrefix}-border-palette-left`).child(\n          buildTable(\n            h('tr', '').children(\n              ...['all', 'inside', 'horizontal', 'vertical', 'outside'].map(it => buildTd.call(this, it)),\n            ),\n            h('tr', '').children(\n              ...['left', 'top', 'right', 'bottom', 'none'].map(it => buildTd.call(this, it)),\n            ),\n          ),\n        ),\n        h('td', `${cssPrefix}-border-palette-right`).children(\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddColor.el),\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddType.el),\n        ),\n      ),\n    );\n    this.el.child(table);\n  }\n}\n","import Dropdown from './dropdown';\nimport Icon from './icon';\nimport BorderPalette from './border_palette';\n\nexport default class DropdownBorder extends Dropdown {\n  constructor() {\n    const icon = new Icon('border-all');\n    const borderPalette = new BorderPalette();\n    borderPalette.change = (v) => {\n      this.change(v);\n      this.hide();\n    };\n    super(icon, 'auto', false, 'bottom-left', borderPalette.el);\n  }\n}\n","import DropdownItem from './dropdown_item';\nimport DropdownBorder from '../dropdown_border';\n\nexport default class Border extends DropdownItem {\n  constructor() {\n    super('border');\n  }\n\n  dropdown() {\n    return new DropdownBorder();\n  }\n}\n","import Item from './item';\nimport Icon from '../icon';\n\nexport default class IconItem extends Item {\n  element() {\n    return super.element()\n      .child(new Icon(this.tag))\n      .on('click', () => this.change(this.tag));\n  }\n\n  setState(disabled) {\n    this.el.disabled(disabled);\n  }\n}\n","import IconItem from './icon_item';\n\nexport default class Clearformat extends IconItem {\n  constructor() {\n    super('clearformat');\n  }\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Paintformat extends ToggleItem {\n  constructor() {\n    super('paintformat');\n  }\n\n  setState() {}\n}\n","import DropdownItem from './dropdown_item';\nimport DropdownColor from '../dropdown_color';\n\nexport default class TextColor extends DropdownItem {\n  constructor(color) {\n    super('color', undefined, color);\n  }\n\n  dropdown() {\n    const { tag, value } = this;\n    return new DropdownColor(tag, value);\n  }\n}\n","import DropdownItem from './dropdown_item';\nimport DropdownColor from '../dropdown_color';\n\nexport default class FillColor extends DropdownItem {\n  constructor(color) {\n    super('bgcolor', undefined, color);\n  }\n\n  dropdown() {\n    const { tag, value } = this;\n    return new DropdownColor(tag, value);\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport { fontSizes } from '../core/font';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFontSize extends Dropdown {\n  constructor() {\n    const nfontSizes = fontSizes.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.setTitle(`${it.pt}`);\n        this.change(it);\n      })\n      .child(`${it.pt}`));\n    super('10', '60px', true, 'bottom-left', ...nfontSizes);\n  }\n}\n","import DropdownItem from './dropdown_item';\nimport DropdownFontsize from '../dropdown_fontsize';\n\nexport default class Format extends DropdownItem {\n  constructor() {\n    super('font-size');\n  }\n\n  getValue(it) {\n    return it.pt;\n  }\n\n  dropdown() {\n    return new DropdownFontsize();\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport { baseFonts } from '../core/font';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFont extends Dropdown {\n  constructor() {\n    const nfonts = baseFonts.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.setTitle(it.title);\n        this.change(it);\n      })\n      .child(it.title));\n    super(baseFonts[0].title, '160px', true, 'bottom-left', ...nfonts);\n  }\n}\n","import DropdownItem from './dropdown_item';\nimport DropdownFont from '../dropdown_font';\n\nexport default class Font extends DropdownItem {\n  constructor() {\n    super('font-name');\n  }\n\n  getValue(it) {\n    return it.key;\n  }\n\n  dropdown() {\n    return new DropdownFont();\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport { baseFormats } from '../core/format';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFormat extends Dropdown {\n  constructor() {\n    let nformats = baseFormats.slice(0);\n    nformats.splice(2, 0, { key: 'divider' });\n    nformats.splice(8, 0, { key: 'divider' });\n    nformats = nformats.map((it) => {\n      const item = h('div', `${cssPrefix}-item`);\n      if (it.key === 'divider') {\n        item.addClass('divider');\n      } else {\n        item.child(it.title())\n          .on('click', () => {\n            this.setTitle(it.title());\n            this.change(it);\n          });\n        if (it.label) item.child(h('div', 'label').html(it.label));\n      }\n      return item;\n    });\n    super('Normal', '220px', true, 'bottom-left', ...nformats);\n  }\n\n  setTitle(key) {\n    for (let i = 0; i < baseFormats.length; i += 1) {\n      if (baseFormats[i].key === key) {\n        this.title.html(baseFormats[i].title());\n      }\n    }\n    this.hide();\n  }\n}\n","import DropdownItem from './dropdown_item';\nimport DropdownFormat from '../dropdown_format';\n\nexport default class Format extends DropdownItem {\n  constructor() {\n    super('format');\n  }\n\n  getValue(it) {\n    return it.key;\n  }\n\n  dropdown() {\n    return new DropdownFormat();\n  }\n}\n","import Dropdown from './dropdown';\nimport Icon from './icon';\nimport { h } from './element';\nimport { baseFormulas } from '../core/formula';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFormula extends Dropdown {\n  constructor() {\n    const nformulas = baseFormulas.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.hide();\n        this.change(it);\n      })\n      .child(it.key));\n    super(new Icon('formula'), '180px', true, 'bottom-left', ...nformulas);\n  }\n}\n","import DropdownItem from './dropdown_item';\nimport DropdownFormula from '../dropdown_formula';\n\nexport default class Format extends DropdownItem {\n  constructor() {\n    super('formula');\n  }\n\n  getValue(it) {\n    return it.key;\n  }\n\n  dropdown() {\n    return new DropdownFormula();\n  }\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Freeze extends ToggleItem {\n  constructor() {\n    super('freeze');\n  }\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Merge extends ToggleItem {\n  constructor() {\n    super('merge');\n  }\n\n  setState(active, disabled) {\n    this.el.active(active).disabled(disabled);\n  }\n}\n","import IconItem from './icon_item';\n\nexport default class Redo extends IconItem {\n  constructor() {\n    super('redo', 'Ctrl+Y');\n  }\n}\n","import IconItem from './icon_item';\n\nexport default class Undo extends IconItem {\n  constructor() {\n    super('undo', 'Ctrl+Z');\n  }\n}\n","import IconItem from './icon_item';\n\nexport default class Print extends IconItem {\n  constructor() {\n    super('print', 'Ctrl+P');\n  }\n}\n","import ToggleItem from './toggle_item';\n\nexport default class Textwrap extends ToggleItem {\n  constructor() {\n    super('textwrap');\n  }\n}\n","import Dropdown from '../dropdown';\nimport DropdownItem from './dropdown_item';\n\nimport { cssPrefix } from '../../config';\nimport { h } from '../element';\nimport Icon from '../icon';\n\nclass DropdownMore extends Dropdown {\n  constructor() {\n    const icon = new Icon('ellipsis');\n    const moreBtns = h('div', `${cssPrefix}-toolbar-more`);\n    super(icon, 'auto', false, 'bottom-right', moreBtns);\n    this.moreBtns = moreBtns;\n    this.contentEl.css('max-width', '420px');\n  }\n}\n\nexport default class More extends DropdownItem {\n  constructor() {\n    super('more');\n    this.el.hide();\n  }\n\n  dropdown() {\n    return new DropdownMore();\n  }\n\n  show() {\n    this.el.show();\n  }\n\n  hide() {\n    this.el.hide();\n  }\n}\n","/* global window */\n\nimport Align from './align';\nimport Valign from './valign';\nimport Autofilter from './autofilter';\nimport Bold from './bold';\nimport Italic from './italic';\nimport Strike from './strike';\nimport Underline from './underline';\nimport Border from './border';\nimport Clearformat from './clearformat';\nimport Paintformat from './paintformat';\nimport TextColor from './text_color';\nimport FillColor from './fill_color';\nimport FontSize from './font_size';\nimport Font from './font';\nimport Format from './format';\nimport Formula from './formula';\nimport Freeze from './freeze';\nimport Merge from './merge';\nimport Redo from './redo';\nimport Undo from './undo';\nimport Print from './print';\nimport Textwrap from './textwrap';\nimport More from './more';\nimport Item from './item';\n\nimport { h } from '../element';\nimport { cssPrefix } from '../../config';\nimport { bind } from '../event';\nimport { t } from '../../locale/locale';\n\nfunction buildDivider() {\n  return h('div', `${cssPrefix}-toolbar-divider`);\n}\n\nfunction initBtns2() {\n  this.btns2 = [];\n  this.items.forEach((it) => {\n    if (Array.isArray(it)) {\n      it.forEach(({ el }) => {\n        const rect = el.box();\n        const { marginLeft, marginRight } = el.computedStyle();\n        this.btns2.push([el, rect.width + parseInt(marginLeft, 10) + parseInt(marginRight, 10)]);\n      });\n    } else {\n      const rect = it.box();\n      const { marginLeft, marginRight } = it.computedStyle();\n      this.btns2.push([it, rect.width + parseInt(marginLeft, 10) + parseInt(marginRight, 10)]);\n    }\n  });\n}\n\nfunction moreResize() {\n  const {\n    el, btns, moreEl, btns2,\n  } = this;\n  const { moreBtns, contentEl } = moreEl.dd;\n  el.css('width', `${this.widthFn()}px`);\n  const elBox = el.box();\n\n  let sumWidth = 160;\n  let sumWidth2 = 12;\n  const list1 = [];\n  const list2 = [];\n  btns2.forEach(([it, w], index) => {\n    sumWidth += w;\n    if (index === btns2.length - 1 || sumWidth < elBox.width) {\n      list1.push(it);\n    } else {\n      sumWidth2 += w;\n      list2.push(it);\n    }\n  });\n  btns.html('').children(...list1);\n  moreBtns.html('').children(...list2);\n  contentEl.css('width', `${sumWidth2}px`);\n  if (list2.length > 0) {\n    moreEl.show();\n  } else {\n    moreEl.hide();\n  }\n}\n\nfunction genBtn(it) {\n  const btn = new Item();\n  btn.el.on('click', () => {\n    if (it.onClick) it.onClick(this.data.getData(), this.data);\n  });\n  btn.tip = it.tip || '';\n\n  let { el } = it;\n\n  if (it.icon) {\n    el = h('img').attr('src', it.icon);\n  }\n\n  if (el) {\n    const icon = h('div', `${cssPrefix}-icon`);\n    icon.child(el);\n    btn.el.child(icon);\n  }\n\n  return btn;\n}\n\nfunction removeNullToolbarItems(items) {\n  // Remove items that are null\n  for (const idx in items) {\n    if (Array.isArray(items[idx])) {\n      items[idx] = items[idx].filter(item => item !== null);\n    }\n  }\n  \n  // Remove blocks that have no items\n  const idxsToRemove = [];\n  for (const idx in items) {\n    if (Array.isArray(items[idx]) && items[idx].length === 0) {\n      idxsToRemove.push(idx);\n    }\n  }\n  idxsToRemove.reverse().forEach(idx => {\n    items.splice(idx, 1);\n  });\n  \n  // Remove dividers that don't have blocks of items that surround them\n  idxsToRemove.length = 0;\n  let prevIsBlock = false;\n  let nextIsBlock = false;\n  for (let idx = items.length - 1; idx >= 0; --idx) {\n    const item = items[idx];\n    if (!Array.isArray(item)) {\n      prevIsBlock = Array.isArray(items[idx - 1]);\n      nextIsBlock = Array.isArray(items[idx + 1]);\n      if (!prevIsBlock || !nextIsBlock) {\n        items.splice(idx, 1);\n      }\n    }\n  }\n}\n\nexport default class Toolbar {\n  constructor(data, widthFn, isHide = false) {\n    this.data = data;\n    this.change = () => {};\n    this.widthFn = widthFn;\n    this.isHide = isHide;\n    const style = data.defaultStyle();\n    const ts = data.settings.toolbar;\n    this.items = [\n      [\n        this.createItem(() => this.undoEl = new Undo(), ts.misc.undo),\n        this.createItem(() => this.redoEl = new Redo(), ts.misc.redo),\n        this.createItem(() => new Print(), ts.misc.print),\n        this.createItem(() => this.paintformatEl = new Paintformat(), ts.misc.paintFormat),\n        this.createItem(() => this.clearformatEl = new Clearformat(), ts.misc.clearFormat),\n      ],\n      buildDivider(),\n      [\n        this.createItem(() => this.formatEl = new Format(), ts.format.format),\n      ],\n      buildDivider(),\n      [\n        this.createItem(() => this.fontEl = new Font(), ts.font.family),\n        this.createItem(() => this.fontSizeEl = new FontSize(), ts.font.size),\n      ],\n      buildDivider(),\n      [\n        this.createItem(() => this.boldEl = new Bold(), ts.textStyle.bold),\n        this.createItem(() => this.italicEl = new Italic(), ts.textStyle.italic),\n        this.createItem(() => this.underlineEl = new Underline(), ts.textStyle.underline),\n        this.createItem(() => this.strikeEl = new Strike(), ts.textStyle.strike),\n        this.createItem(() => this.textColorEl = new TextColor(style.color), ts.textStyle.color),\n      ],\n      buildDivider(),\n      [\n        this.createItem(() => this.fillColorEl = new FillColor(style.bgcolor), ts.cell.fill),\n        this.createItem(() => this.borderEl = new Border(), ts.cell.borders),\n        this.createItem(() => this.mergeEl = new Merge(), ts.cell.merge),\n      ],\n      buildDivider(),\n      [\n        this.createItem(() => this.alignEl = new Align(style.align), ts.cellText.horizontalAlignment),\n        this.createItem(() => this.valignEl = new Valign(style.valign), ts.cellText.verticalAlignment),\n        this.createItem(() => this.textwrapEl = new Textwrap(), ts.cellText.wrap),\n      ],\n      buildDivider(),\n      [\n        this.createItem(() => this.freezeEl = new Freeze(), ts.tools.freezeCell),\n        this.createItem(() => this.autofilterEl = new Autofilter(), ts.tools.filter),\n        this.createItem(() => this.formulaEl = new Formula(), ts.tools.formulas),\n      ],\n    ];\n    removeNullToolbarItems(this.items);\n    if (ts.itemsCallback) {\n      ts.itemsCallback(this.items);\n    }\n\n    const { extendToolbar = {} } = data.settings;\n\n    if (extendToolbar.left && extendToolbar.left.length > 0) {\n      this.items.unshift(buildDivider());\n      const btns = extendToolbar.left.map(genBtn.bind(this));\n\n      this.items.unshift(btns);\n    }\n    if (extendToolbar.right && extendToolbar.right.length > 0) {\n      this.items.push(buildDivider());\n      const btns = extendToolbar.right.map(genBtn.bind(this));\n      this.items.push(btns);\n    }\n\n    this.items.push([this.moreEl = new More()]);\n\n    this.el = h('div', `${cssPrefix}-toolbar`);\n    this.btns = h('div', `${cssPrefix}-toolbar-btns`);\n\n    this.items.forEach((it) => {\n      if (Array.isArray(it)) {\n        it.forEach((i) => {\n          this.btns.child(i.el);\n        });\n      } else {\n        this.btns.child(it.el);\n      }\n    });\n\n    this.el.child(this.btns);\n    if (isHide) {\n      this.el.hide();\n    } else {\n      this.reset();\n      setTimeout(() => {\n        initBtns2.call(this);\n        moreResize.call(this);\n      }, 0);\n      bind(window, 'resize', () => {\n        moreResize.call(this);\n      });\n    }\n  }\n  \n  createItem(creatorFunc, returnCondition) {\n    const el = creatorFunc();\n    el.change = (...args) => {\n      if (args[0] === 'merge' && args[1] === true) {\n        this.checkMergeWarning().then(merge => {\n          if (merge) {\n            this.change(...args);\n          }\n          else {\n            this.mergeEl.setState(false, false);\n          }\n        })\n      }\n      else {\n        this.change(...args);\n      }\n    };\n    return returnCondition ? el : null;\n  }\n\n  paintformatActive() {\n    return this.paintformatEl.active();\n  }\n\n  paintformatToggle() {\n    this.paintformatEl.toggle();\n  }\n\n  trigger(type) {\n    this[`${type}El`].click();\n  }\n\n  resetData(data) {\n    this.data = data;\n    this.reset();\n  }\n  \n  checkMergeWarning() {\n    return Promise.resolve().then(() => {\n      const values = this.data.collectMergeValues();\n      if (values.length > 1) {\n        return window.confirm(t('warning.mergingMultipleValues'));\n      }\n      return true;\n    });\n  }\n\n  reset() {\n    if (this.isHide) return;\n    const { data } = this;\n    const style = data.getSelectedCellStyle();\n    const cell = data.getSelectedCell();\n    let hAlign = style.align;\n    if (!style.hasAlignSet && cell && cell.text && cell.text.trim().length > 0 && !isNaN(cell.text)) {\n        hAlign = 'right';\n    }\n    // console.log('canUndo:', data.canUndo());\n    this.undoEl.setState(!data.canUndo());\n    this.redoEl.setState(!data.canRedo());\n    this.mergeEl.setState(data.canUnmerge(), !data.selector.multiple());\n    this.autofilterEl.setState(!data.canAutofilter());\n    // this.mergeEl.disabled();\n    // console.log('selectedCell:', style, cell);\n    const { font, format } = style;\n    this.formatEl.setState(format);\n    this.fontEl.setState(font.name);\n    this.fontSizeEl.setState(font.size);\n    this.boldEl.setState(font.bold);\n    this.italicEl.setState(font.italic);\n    this.underlineEl.setState(style.underline);\n    this.strikeEl.setState(style.strike);\n    this.textColorEl.setState(style.color);\n    this.fillColorEl.setState(style.bgcolor);\n    this.alignEl.setState(hAlign);\n    this.valignEl.setState(style.valign);\n    this.textwrapEl.setState(style.textwrap);\n    // console.log('freeze is Active:', data.freezeIsActive());\n    this.freezeEl.setState(data.freezeIsActive());\n  }\n}\n","import { h } from './element';\nimport { cssPrefix } from '../config';\n\nexport default class FormulaBar {\n  constructor(editable, formulaBarOptions, onInputCallback) {\n    this.editable = editable;\n    this.formulaBarOptions = formulaBarOptions;\n    this.el = h('div', `${cssPrefix}-formulabar ${cssPrefix}-${formulaBarOptions.location === 'nextToToolbar' ? 'next-to-toolbar' : 'below-toolbar'}`)\n      .child(\n        this.inputEl = h('input', '')\n          .on(\"keydown\", evt => {\n            if (evt.keyCode !== 13 && evt.keyCode !== 27) {\n              evt.stopPropagation();\n            }\n            if (evt.keyCode === 27) {\n              this.reset(this.initialText);\n              if (onInputCallback) {\n                onInputCallback(this.text);\n              }\n            }\n          })\n          .on(\"input\", () => {\n            if (onInputCallback) {\n              this.text = this.inputEl.val();\n              onInputCallback(this.text);\n            }\n          })\n      )\n      .child(\n        this.selectionInfoEl = h('div', `${cssPrefix}-selection-info`)\n      )\n      .child(\n        this.htmlFormulaOverlay = h('div', `${cssPrefix}-html-formula-overlay`)\n      );\n    if (!this.editable) {\n      this.inputEl.el.readOnly = true;\n    }\n  }\n  \n  setSelectionInfoText(text) {\n    this.selectionInfoEl.el.textContent = text;\n  }\n  \n  reset(text) {\n    this.initialText = text;\n    this.text = text;\n    this.inputEl.val(text);\n  }\n  \n  setText(text) {\n    this.text = text;\n    this.inputEl.val(text);\n  }\n  \n  setFormulaHtml(formulaHtml) {\n    this.htmlFormulaOverlay.el.innerHTML = formulaHtml;\n    if (formulaHtml) {\n      this.inputEl.el.style.color = 'rgba(0, 0, 0, 0)';\n    }\n    else {\n      this.inputEl.el.style.color = '';\n    }\n  }\n  \n}\n","/* global document */\n/* global window */\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\nimport { bind, unbind } from './event';\n\nexport default class Modal {\n  constructor(title, content, width = '600px') {\n    this.title = title;\n    this.el = h('div', `${cssPrefix}-modal`).css('width', width).children(\n      h('div', `${cssPrefix}-modal-header`).children(\n        new Icon('close').on('click.stop', () => this.hide()),\n        this.title,\n      ),\n      h('div', `${cssPrefix}-modal-content`).children(...content),\n    ).hide();\n  }\n\n  show() {\n    // dimmer\n    this.dimmer = h('div', `${cssPrefix}-dimmer active`);\n    document.body.appendChild(this.dimmer.el);\n    const { width, height } = this.el.show().box();\n    const { clientHeight, clientWidth } = document.documentElement;\n    this.el.offset({\n      left: (clientWidth - width) / 2,\n      top: (clientHeight - height) / 3,\n    });\n    window.xkeydownEsc = (evt) => {\n      if (evt.keyCode === 27) {\n        this.hide();\n      }\n    };\n    bind(window, 'keydown', window.xkeydownEsc);\n  }\n\n  hide() {\n    this.el.hide();\n    document.body.removeChild(this.dimmer.el);\n    unbind(window, 'keydown', window.xkeydownEsc);\n    delete window.xkeydownEsc;\n  }\n}\n","import { h } from './element';\nimport { cssPrefix } from '../config';\n\nexport default class FormInput {\n  constructor(width, hint) {\n    this.vchange = () => {};\n    this.el = h('div', `${cssPrefix}-form-input`);\n    this.input = h('input', '').css('width', width)\n      .on('input', evt => this.vchange(evt))\n      .attr('placeholder', hint);\n    this.el.child(this.input);\n  }\n\n  focus() {\n    setTimeout(() => {\n      this.input.el.focus();\n    }, 10);\n  }\n\n  hint(v) {\n    this.input.attr('placeholder', v);\n  }\n\n  val(v) {\n    return this.input.val(v);\n  }\n}\n","import { h } from './element';\nimport Suggest from './suggest';\nimport { cssPrefix } from '../config';\n\nexport default class FormSelect {\n  constructor(key, items, width, getTitle = it => it, change = () => {}) {\n    this.key = key;\n    this.getTitle = getTitle;\n    this.vchange = () => {};\n    this.el = h('div', `${cssPrefix}-form-select`);\n    this.suggest = new Suggest(items.map(it => ({ key: it, title: this.getTitle(it) })), (it) => {\n      this.itemClick(it.key);\n      change(it.key);\n      this.vchange(it.key);\n    }, width, this.el);\n    this.el.children(\n      this.itemEl = h('div', 'input-text').html(this.getTitle(key)),\n      this.suggest.el,\n    ).on('click', () => this.show());\n  }\n\n  show() {\n    this.suggest.search('');\n  }\n\n  itemClick(it) {\n    this.key = it;\n    this.itemEl.html(this.getTitle(it));\n  }\n\n  val(v) {\n    if (v !== undefined) {\n      this.key = v;\n      this.itemEl.html(this.getTitle(v));\n      return this;\n    }\n    return this.key;\n  }\n}\n","import { h } from './element';\nimport { cssPrefix } from '../config';\nimport { t } from '../locale/locale';\n\nconst patterns = {\n  number: /(^\\d+$)|(^\\d+(\\.\\d{0,4})?$)/,\n  date: /^\\d{4}-\\d{1,2}-\\d{1,2}$/,\n};\n\n// rule: { required: false, type, pattern: // }\nexport default class FormField {\n  constructor(input, rule, label, labelWidth) {\n    this.label = '';\n    this.rule = rule;\n    if (label) {\n      this.label = h('label', 'label').css('width', `${labelWidth}px`).html(label);\n    }\n    this.tip = h('div', 'tip').child('tip').hide();\n    this.input = input;\n    this.input.vchange = () => this.validate();\n    this.el = h('div', `${cssPrefix}-form-field`)\n      .children(this.label, input.el, this.tip);\n  }\n\n  isShow() {\n    return this.el.css('display') !== 'none';\n  }\n\n  show() {\n    this.el.show();\n  }\n\n  hide() {\n    this.el.hide();\n    return this;\n  }\n\n  val(v) {\n    return this.input.val(v);\n  }\n\n  hint(hint) {\n    this.input.hint(hint);\n  }\n\n  validate() {\n    const {\n      input, rule, tip, el,\n    } = this;\n    const v = input.val();\n    if (rule.required) {\n      if (/^\\s*$/.test(v)) {\n        tip.html(t('validation.required'));\n        el.addClass('error');\n        return false;\n      }\n    }\n    if (rule.type || rule.pattern) {\n      const pattern = rule.pattern || patterns[rule.type];\n      if (!pattern.test(v)) {\n        tip.html(t('validation.notMatch'));\n        el.addClass('error');\n        return false;\n      }\n    }\n    el.removeClass('error');\n    return true;\n  }\n}\n","import Modal from './modal';\nimport FormInput from './form_input';\nimport FormSelect from './form_select';\nimport FormField from './form_field';\nimport Button from './button';\nimport { t } from '../locale/locale';\nimport { h } from './element';\nimport { cssPrefix } from '../config';\n\nconst fieldLabelWidth = 100;\n\nexport default class ModalValidation extends Modal {\n  constructor() {\n    const mf = new FormField(\n      new FormSelect('cell',\n        ['cell'], // cell|row|column\n        '100%',\n        it => t(`dataValidation.modeType.${it}`)),\n      { required: true },\n      `${t('dataValidation.range')}:`,\n      fieldLabelWidth,\n    );\n    const rf = new FormField(\n      new FormInput('120px', 'E3 or E3:F12'),\n      { required: true, pattern: /^([A-Z]{1,2}[1-9]\\d*)(:[A-Z]{1,2}[1-9]\\d*)?$/ },\n    );\n    const cf = new FormField(\n      new FormSelect('list',\n        ['list', 'number', 'date', 'phone', 'email'],\n        '100%',\n        it => t(`dataValidation.type.${it}`),\n        it => this.criteriaSelected(it)),\n      { required: true },\n      `${t('dataValidation.criteria')}:`,\n      fieldLabelWidth,\n    );\n\n    // operator\n    const of = new FormField(\n      new FormSelect('be',\n        ['be', 'nbe', 'eq', 'neq', 'lt', 'lte', 'gt', 'gte'],\n        '160px',\n        it => t(`dataValidation.operator.${it}`),\n        it => this.criteriaOperatorSelected(it)),\n      { required: true },\n    ).hide();\n    // min, max\n    const minvf = new FormField(\n      new FormInput('70px', '10'),\n      { required: true },\n    ).hide();\n    const maxvf = new FormField(\n      new FormInput('70px', '100'),\n      { required: true, type: 'number' },\n    ).hide();\n    // value\n    const svf = new FormField(\n      new FormInput('120px', 'a,b,c'),\n      { required: true },\n    );\n    const vf = new FormField(\n      new FormInput('70px', '10'),\n      { required: true, type: 'number' },\n    ).hide();\n\n    super(t('contextmenu.validation'), [\n      h('div', `${cssPrefix}-form-fields`).children(\n        mf.el,\n        rf.el,\n      ),\n      h('div', `${cssPrefix}-form-fields`).children(\n        cf.el,\n        of.el,\n        minvf.el,\n        maxvf.el,\n        vf.el,\n        svf.el,\n      ),\n      h('div', `${cssPrefix}-buttons`).children(\n        new Button('cancel').on('click', () => this.btnClick('cancel')),\n        new Button('remove').on('click', () => this.btnClick('remove')),\n        new Button('save', 'primary').on('click', () => this.btnClick('save')),\n      ),\n    ]);\n    this.mf = mf;\n    this.rf = rf;\n    this.cf = cf;\n    this.of = of;\n    this.minvf = minvf;\n    this.maxvf = maxvf;\n    this.vf = vf;\n    this.svf = svf;\n    this.change = () => {};\n  }\n\n  showVf(it) {\n    const hint = it === 'date' ? '2018-11-12' : '10';\n    const { vf } = this;\n    vf.input.hint(hint);\n    vf.show();\n  }\n\n  criteriaSelected(it) {\n    const {\n      of, minvf, maxvf, vf, svf,\n    } = this;\n    if (it === 'date' || it === 'number') {\n      of.show();\n      minvf.rule.type = it;\n      maxvf.rule.type = it;\n      if (it === 'date') {\n        minvf.hint('2018-11-12');\n        maxvf.hint('2019-11-12');\n      } else {\n        minvf.hint('10');\n        maxvf.hint('100');\n      }\n      minvf.show();\n      maxvf.show();\n      vf.hide();\n      svf.hide();\n    } else {\n      if (it === 'list') {\n        svf.show();\n      } else {\n        svf.hide();\n      }\n      vf.hide();\n      of.hide();\n      minvf.hide();\n      maxvf.hide();\n    }\n  }\n\n  criteriaOperatorSelected(it) {\n    if (!it) return;\n    const {\n      minvf, maxvf, vf,\n    } = this;\n    if (it === 'be' || it === 'nbe') {\n      minvf.show();\n      maxvf.show();\n      vf.hide();\n    } else {\n      const type = this.cf.val();\n      vf.rule.type = type;\n      if (type === 'date') {\n        vf.hint('2018-11-12');\n      } else {\n        vf.hint('10');\n      }\n      vf.show();\n      minvf.hide();\n      maxvf.hide();\n    }\n  }\n\n  btnClick(action) {\n    if (action === 'cancel') {\n      this.hide();\n    } else if (action === 'remove') {\n      this.change('remove');\n      this.hide();\n    } else if (action === 'save') {\n      // validate\n      const attrs = ['mf', 'rf', 'cf', 'of', 'svf', 'vf', 'minvf', 'maxvf'];\n      for (let i = 0; i < attrs.length; i += 1) {\n        const field = this[attrs[i]];\n        // console.log('field:', field);\n        if (field.isShow()) {\n          // console.log('it:', it);\n          if (!field.validate()) return;\n        }\n      }\n\n      const mode = this.mf.val();\n      const ref = this.rf.val();\n      const type = this.cf.val();\n      const operator = this.of.val();\n      let value = this.svf.val();\n      if (type === 'number' || type === 'date') {\n        if (operator === 'be' || operator === 'nbe') {\n          value = [this.minvf.val(), this.maxvf.val()];\n        } else {\n          value = this.vf.val();\n        }\n      }\n      // console.log(mode, ref, type, operator, value);\n      this.change('save',\n        mode,\n        ref,\n        {\n          type, operator, required: false, value,\n        });\n      this.hide();\n    }\n  }\n\n  // validation: { mode, ref, validator }\n  setValue(v) {\n    if (v) {\n      const {\n        mf, rf, cf, of, svf, vf, minvf, maxvf,\n      } = this;\n      const {\n        mode, ref, validator,\n      } = v;\n      const {\n        type, operator, value,\n      } = validator || { type: 'list' };\n      mf.val(mode || 'cell');\n      rf.val(ref);\n      cf.val(type);\n      of.val(operator);\n      if (Array.isArray(value)) {\n        minvf.val(value[0]);\n        maxvf.val(value[1]);\n      } else {\n        svf.val(value || '');\n        vf.val(value || '');\n      }\n      this.criteriaSelected(type);\n      this.criteriaOperatorSelected(operator);\n    }\n    this.show();\n  }\n}\n","import { h } from './element';\nimport Button from './button';\nimport { bindClickoutside, unbindClickoutside } from './event';\nimport { cssPrefix } from '../config';\nimport { t } from '../locale/locale';\n\nfunction buildMenu(clsName) {\n  return h('div', `${cssPrefix}-item ${clsName}`);\n}\n\nfunction buildSortItem(it) {\n  return buildMenu('state').child(t(`sort.${it}`))\n    .on('click.stop', () => this.itemClick(it));\n}\n\nfunction buildFilterBody(items) {\n  const { filterbEl, filterValues } = this;\n  filterbEl.html('');\n  const itemKeys = Object.keys(items);\n  itemKeys.forEach((it, index) => {\n    const cnt = items[it];\n    const active = filterValues.includes(it) ? 'checked' : '';\n    filterbEl.child(h('div', `${cssPrefix}-item state ${active}`)\n      .on('click.stop', () => this.filterClick(index, it))\n      .children(it === '' ? t('filter.empty') : it, h('div', 'label').html(`(${cnt})`)));\n  });\n}\n\nfunction resetFilterHeader() {\n  const { filterhEl, filterValues, values } = this;\n  filterhEl.html(`${filterValues.length} / ${values.length}`);\n  filterhEl.checked(filterValues.length === values.length);\n}\n\nexport default class SortFilter {\n  constructor() {\n    this.filterbEl = h('div', `${cssPrefix}-body`);\n    this.filterhEl = h('div', `${cssPrefix}-header state`).on('click.stop', () => this.filterClick(0, 'all'));\n    this.el = h('div', `${cssPrefix}-sort-filter`).children(\n      this.sortAscEl = buildSortItem.call(this, 'asc'),\n      this.sortDescEl = buildSortItem.call(this, 'desc'),\n      buildMenu('divider'),\n      h('div', `${cssPrefix}-filter`).children(\n        this.filterhEl,\n        this.filterbEl,\n      ),\n      h('div', `${cssPrefix}-buttons`).children(\n        new Button('cancel').on('click', () => this.btnClick('cancel')),\n        new Button('ok', 'primary').on('click', () => this.btnClick('ok')),\n      ),\n    ).hide();\n    // this.setFilters(['test1', 'test2', 'text3']);\n    this.ci = null;\n    this.sortDesc = null;\n    this.values = null;\n    this.filterValues = [];\n  }\n\n  btnClick(it) {\n    if (it === 'ok') {\n      const { ci, sort, filterValues } = this;\n      if (this.ok) {\n        this.ok(ci, sort, 'in', filterValues);\n      }\n    }\n    this.hide();\n  }\n\n  itemClick(it) {\n    // console.log('it:', it);\n    this.sort = it;\n    const { sortAscEl, sortDescEl } = this;\n    sortAscEl.checked(it === 'asc');\n    sortDescEl.checked(it === 'desc');\n  }\n\n  filterClick(index, it) {\n    // console.log('index:', index, it);\n    const { filterbEl, filterValues, values } = this;\n    const children = filterbEl.children();\n    if (it === 'all') {\n      if (children.length === filterValues.length) {\n        this.filterValues = [];\n        children.forEach(i => h(i).checked(false));\n      } else {\n        this.filterValues = Array.from(values);\n        children.forEach(i => h(i).checked(true));\n      }\n    } else {\n      const checked = h(children[index]).toggle('checked');\n      if (checked) {\n        filterValues.push(it);\n      } else {\n        filterValues.splice(filterValues.findIndex(i => i === it), 1);\n      }\n    }\n    resetFilterHeader.call(this);\n  }\n\n  // v: autoFilter\n  // items: {value: cnt}\n  // sort { ci, order }\n  set(ci, items, filter, sort) {\n    this.ci = ci;\n    const { sortAscEl, sortDescEl } = this;\n    if (sort !== null) {\n      this.sort = sort.order;\n      sortAscEl.checked(sort.asc());\n      sortDescEl.checked(sort.desc());\n    } else {\n      this.sortDesc = null;\n      sortAscEl.checked(false);\n      sortDescEl.checked(false);\n    }\n    // this.setFilters(items, filter);\n    this.values = Object.keys(items);\n    this.filterValues = filter ? Array.from(filter.value) : Object.keys(items);\n    buildFilterBody.call(this, items, filter);\n    resetFilterHeader.call(this);\n  }\n\n  setOffset(v) {\n    this.el.offset(v).show();\n    let tindex = 1;\n    bindClickoutside(this.el, () => {\n      if (tindex <= 0) {\n        this.hide();\n      }\n      tindex -= 1;\n    });\n  }\n\n  show() {\n    this.el.show();\n  }\n\n  hide() {\n    this.el.hide();\n    unbindClickoutside(this.el);\n  }\n}\n","/* global document */\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nexport function xtoast(title, content) {\n  const el = h('div', `${cssPrefix}-toast`);\n  const dimmer = h('div', `${cssPrefix}-dimmer active`);\n  const remove = () => {\n    document.body.removeChild(el.el);\n    document.body.removeChild(dimmer.el);\n  };\n\n  el.children(\n    h('div', `${cssPrefix}-toast-header`).children(\n      new Icon('close').on('click.stop', () => remove()),\n      title,\n    ),\n    h('div', `${cssPrefix}-toast-content`).html(content),\n  );\n  document.body.appendChild(el.el);\n  document.body.appendChild(dimmer.el);\n  // set offset\n  const { width, height } = el.box();\n  const { clientHeight, clientWidth } = document.documentElement;\n  el.offset({\n    left: (clientWidth - width) / 2,\n    top: (clientHeight - height) / 3,\n  });\n}\n\nexport default {};\n","/* global window */\nimport { h } from './element';\nimport {\n  bind,\n  mouseMoveUp,\n  bindTouch,\n  createEventEmitter,\n} from './event';\nimport Resizer from './resizer';\nimport Scrollbar from './scrollbar';\nimport Selector from './selector';\nimport Editor from './editor';\nimport Print from './print';\nimport ContextMenu from './contextmenu';\nimport Table from './table';\nimport Toolbar from './toolbar/index';\nimport FormulaBar from './formulabar';\nimport ModalValidation from './modal_validation';\nimport SortFilter from './sort_filter';\nimport { xtoast } from './message';\nimport { cssPrefix } from '../config';\nimport { formulam, formulas } from '../core/formula';\nimport _cell from '../core/cell';\nimport { xy2expr, expr2xy } from '../core/alphabet';\nimport { highlightColors } from \"./color_palette\";\n\n/**\n * @desc throttle fn\n * @param func function\n * @param wait Delay in milliseconds\n */\nfunction throttle(func, wait) {\n  let timeout;\n  return (...arg) => {\n    const that = this;\n    const args = arg;\n    if (!timeout) {\n      timeout = setTimeout(() => {\n        timeout = null;\n        func.apply(that, args);\n      }, wait);\n    }\n  };\n}\n\nfunction scrollbarMove() {\n  const {\n    data, verticalScrollbar, horizontalScrollbar,\n  } = this;\n  const {\n    l, t, left, top, width, height,\n  } = data.getSelectedRect();\n  const tableOffset = this.getTableOffset();\n  // console.log(',l:', l, ', left:', left, ', tOffset.left:', tableOffset.width);\n  if (Math.abs(left) + width > tableOffset.width) {\n    horizontalScrollbar.move({ left: l + width - tableOffset.width });\n  } else {\n    const fsw = data.freezeTotalWidth();\n    if (left < fsw) {\n      horizontalScrollbar.move({ left: l - 1 - fsw });\n    }\n  }\n  // console.log('top:', top, ', height:', height, ', tof.height:', tableOffset.height);\n  if (Math.abs(top) + height > tableOffset.height) {\n    verticalScrollbar.move({ top: t + height - tableOffset.height - 1 });\n  } else {\n    const fsh = data.freezeTotalHeight();\n    if (top < fsh) {\n      verticalScrollbar.move({ top: t - 1 - fsh });\n    }\n  }\n}\n\nfunction selectorSet(multiple, ri, ci, indexesUpdated = true, moving = false, isHeaderClick = false) {\n  if (ri === -1 && ci === -1) return;\n  const { table, selector, toolbar, data } = this;\n  const cell = data.getCell(ri, ci);\n  if (multiple) {\n    selector.setEnd(ri, ci, moving, isHeaderClick);\n    this.trigger('cells-selected', cell, selector.range);\n    this.updateSelectionInfo();\n  } else {\n    // trigger click event\n    selector.set(ri, ci, indexesUpdated);\n    this.trigger('cell-selected', cell, ri, ci);\n    const text = cell ? cell.text : '';\n    this.formulaBar.reset(text);\n    this.updateSelectionInfo();\n  }\n  this.updateContextMenuTargetRange(ri, ci);\n  toolbar.reset();\n  table.render();\n}\n\nfunction ensureSelectorInSheet() {\n  const { data, selector } = this;\n  const { sci, eci, sri, eri } = selector.range;\n  const nCols = data.cols.len;\n  const nRows = data.rows.len;\n  \n  const sci2 = Math.min(sci, nCols - 1);\n  const eci2 = Math.min(eci, nCols - 1);\n  const sri2 = Math.min(sri, nRows - 1);\n  const eri2 = Math.min(eri, nRows - 1);\n  \n  if (sci2 !== sci || eci2 !== eci || sri2 !== sri || eri2 !== eri) {\n    this.selectorSet(false, sri2, sci2);\n    this.selectorSet(true, eri2, eci2);\n  }\n}\n\n// multiple: boolean\n// direction: left | right | up | down | row-first | row-last | col-first | col-last\nfunction selectorMove(multiple, direction) {\n  const {\n    selector, data,\n  } = this;\n  const { rows, cols } = data;\n  let [ri, ci] = selector.indexes;\n  const { eri, eci } = selector.range;\n  if (multiple) {\n    [ri, ci] = selector.moveIndexes;\n  }\n  // console.log('selector.move:', ri, ci);\n  if (direction === 'left') {\n    if (ci > 0) ci -= 1;\n  } else if (direction === 'right') {\n    if (eci !== ci) ci = eci;\n    if (ci < cols.len - 1) ci += 1;\n  } else if (direction === 'up') {\n    if (ri > 0) ri -= 1;\n  } else if (direction === 'down') {\n    if (eri !== ri) ri = eri;\n    if (ri < rows.len - 1) ri += 1;\n  } else if (direction === 'row-first') {\n    ci = 0;\n  } else if (direction === 'row-last') {\n    ci = cols.len - 1;\n  } else if (direction === 'col-first') {\n    ri = 0;\n  } else if (direction === 'col-last') {\n    ri = rows.len - 1;\n  }\n  if (multiple) {\n    selector.moveIndexes = [ri, ci];\n  }\n  selectorSet.call(this, multiple, ri, ci);\n  scrollbarMove.call(this);\n}\n\n// private methods\nfunction overlayerMousemove(evt) {\n  // console.log('x:', evt.offsetX, ', y:', evt.offsetY);\n  if (evt.buttons !== 0) return;\n  if (evt.target.className === `${cssPrefix}-resizer-hover`) return;\n  const { offsetX, offsetY } = evt;\n  const {\n    rowResizer, colResizer, tableEl, data,\n  } = this;\n  const { rows, cols } = data;\n  if (offsetX > cols.indexWidth && offsetY > rows.height) {\n    rowResizer.hide();\n    colResizer.hide();\n    return;\n  }\n  const tRect = tableEl.box();\n  const cRect = data.getCellRectByXY(evt.offsetX, evt.offsetY);\n  if (cRect.ri >= 0 && cRect.ci === -1) {\n    cRect.width = cols.indexWidth;\n    rowResizer.show(cRect, {\n      width: tRect.width,\n    });\n    if (rows.isHide(cRect.ri - 1)) {\n      rowResizer.showUnhide(cRect.ri);\n    } else {\n      rowResizer.hideUnhide();\n    }\n  } else {\n    rowResizer.hide();\n  }\n  if (cRect.ri === -1 && cRect.ci >= 0) {\n    cRect.height = rows.height;\n    colResizer.show(cRect, {\n      height: tRect.height,\n    });\n    if (cols.isHide(cRect.ci - 1)) {\n      colResizer.showUnhide(cRect.ci);\n    } else {\n      colResizer.hideUnhide();\n    }\n  } else {\n    colResizer.hide();\n  }\n}\n\n// let scrollThreshold = 15;\nfunction overlayerMousescroll(evt) {\n  // scrollThreshold -= 1;\n  // if (scrollThreshold > 0) return;\n  // scrollThreshold = 15;\n\n  const { verticalScrollbar, horizontalScrollbar, data } = this;\n  const { top } = verticalScrollbar.scroll();\n  const { left } = horizontalScrollbar.scroll();\n  // console.log('evt:::', evt.wheelDelta, evt.detail * 40);\n\n  const { rows, cols } = data;\n\n  // deltaY for vertical delta\n  const { deltaY, deltaX } = evt;\n  const loopValue = (ii, vFunc) => {\n    let i = ii;\n    let v = 0;\n    do {\n      v = vFunc(i);\n      i += 1;\n    } while (v <= 0);\n    return v;\n  };\n  // console.log('deltaX', deltaX, 'evt.detail', evt.detail);\n  // if (evt.detail) deltaY = evt.detail * 40;\n  const moveY = (vertical) => {\n    if (vertical > 0) {\n      // up\n      const ri = data.scroll.ri + 1;\n      if (ri < rows.len) {\n        const rh = loopValue(ri, i => rows.getHeight(i));\n        verticalScrollbar.move({ top: top + rh - 1 });\n      }\n    } else {\n      // down\n      const ri = data.scroll.ri - 1;\n      if (ri >= 0) {\n        const rh = loopValue(ri, i => rows.getHeight(i));\n        verticalScrollbar.move({ top: ri === 0 ? 0 : top - rh });\n      }\n    }\n  };\n\n  // deltaX for Mac horizontal scroll\n  const moveX = (horizontal) => {\n    if (horizontal > 0) {\n      // left\n      const ci = data.scroll.ci + 1;\n      if (ci < cols.len) {\n        const cw = loopValue(ci, i => cols.getWidth(i));\n        horizontalScrollbar.move({ left: left + cw - 1 });\n      }\n    } else {\n      // right\n      const ci = data.scroll.ci - 1;\n      if (ci >= 0) {\n        const cw = loopValue(ci, i => cols.getWidth(i));\n        horizontalScrollbar.move({ left: ci === 0 ? 0 : left - cw });\n      }\n    }\n  };\n  const tempY = Math.abs(deltaY);\n  const tempX = Math.abs(deltaX);\n  const temp = Math.max(tempY, tempX);\n  // console.log('event:', evt);\n  // detail for windows/mac firefox vertical scroll\n  if (/Firefox/i.test(window.navigator.userAgent)) throttle(moveY(evt.detail), 50);\n  if (temp === tempX) throttle(moveX(deltaX), 50);\n  if (temp === tempY) throttle(moveY(deltaY), 50);\n}\n\nfunction overlayerTouch(direction, distance) {\n  const { verticalScrollbar, horizontalScrollbar } = this;\n  const { top } = verticalScrollbar.scroll();\n  const { left } = horizontalScrollbar.scroll();\n\n  if (direction === 'left' || direction === 'right') {\n    horizontalScrollbar.move({ left: left - distance });\n  } else if (direction === 'up' || direction === 'down') {\n    verticalScrollbar.move({ top: top - distance });\n  }\n}\n\nfunction verticalScrollbarSet() {\n  const { data, verticalScrollbar } = this;\n  const { height } = this.getTableOffset();\n  const erth = data.exceptRowTotalHeight(0, -1);\n  // console.log('erth:', erth);\n  verticalScrollbar.set(height, data.rows.totalHeight() - erth);\n}\n\nfunction horizontalScrollbarSet() {\n  const { data, horizontalScrollbar } = this;\n  const { width } = this.getTableOffset();\n  if (data) {\n    horizontalScrollbar.set(width, data.cols.totalWidth());\n  }\n}\n\nfunction sheetFreeze() {\n  const {\n    selector, data, editor,\n  } = this;\n  const [ri, ci] = data.freeze;\n  if (ri > 0 || ci > 0) {\n    const fwidth = data.freezeTotalWidth();\n    const fheight = data.freezeTotalHeight();\n    editor.setFreezeLengths(fwidth, fheight);\n  }\n  selector.resetAreaOffset();\n}\n\nfunction sheetReset() {\n  const {\n    data,\n    tableEl,\n    overlayerEl,\n    overlayerCEl,\n    table,\n    toolbar,\n    selector,\n    el,\n  } = this;\n  const tOffset = this.getTableOffset();\n  const vRect = this.getRect();\n  tableEl.attr(vRect);\n  overlayerEl.offset(vRect);\n  overlayerCEl.offset(tOffset);\n  el.css('width', `${vRect.width}px`);\n  verticalScrollbarSet.call(this);\n  horizontalScrollbarSet.call(this);\n  sheetFreeze.call(this);\n  table.render();\n  toolbar.reset();\n  selector.reset();\n  const cell = data.getSelectedCell();\n  this.formulaBar.reset(cell && cell.text ? cell.text : '');\n  this.updateSelectionInfo();\n}\n\nfunction clearClipboard() {\n  const { data, selector } = this;\n  data.clearClipboard();\n  selector.hideClipboard();\n}\n\nfunction copy(evt) {\n  const { data, selector } = this;\n  if (data.settings.mode === 'read') {\n    data.copyToSystemClipboard(evt);\n    return;\n  }\n  data.copy();\n  data.copyToSystemClipboard(evt);\n  selector.showClipboard();\n}\n\nfunction cut(evt) {\n  const { data, selector } = this;\n  if (data.settings.mode === 'read') {\n    data.copyToSystemClipboard(evt);\n    return;\n  }\n  data.cut();\n  data.copyToSystemClipboard(evt);\n  selector.showClipboard();\n}\n\nfunction paste(what, evt) {\n  const { data } = this;\n  if (data.settings.mode === 'read') return;\n  let cdata;\n  if (data.settings.clipboard && data.settings.clipboard.getData) {\n    cdata = data.settings.clipboard.getData();\n  }\n  else {\n    cdata = evt.clipboardData.getData('text/plain');\n  }\n  const execPaste = () => {\n    let canPasteInternal = false;\n    if (cdata && cdata.json) {\n      try {\n        let parsedData = JSON.parse(cdata.json);\n        canPasteInternal = parsedData.srcType === 'x-spreadsheet' && parsedData.srcDataId === data.randomId;\n      } catch {}\n    }\n    if (!canPasteInternal) {\n      data.clipboard.clear();\n    }\n    if (canPasteInternal && data.paste(what, msg => xtoast('Tip', msg))) {\n      sheetReset.call(this);\n    } else if (evt) {\n      if (typeof(cdata) === 'object') {\n        if (cdata.json) {\n          try {\n            const obj = JSON.parse(cdata.json);\n            if (obj.srcType === 'x-spreadsheet') {\n              cdata = obj;\n            }\n            else {\n              cdata = cdata.text;\n            }\n          }\n          catch {\n            cdata = cdata.text;\n          }\n        }\n        else {\n          cdata = cdata.text;\n        }\n      }\n      if (typeof(cdata) === 'string') {\n        this.data.pasteFromText(cdata);\n      }\n      else {\n        this.data.pasteFromObj(cdata);\n      }\n      sheetReset.call(this);\n      const selectedCell = this.data.getSelectedCell();\n      const selectedCellText = selectedCell ? selectedCell.text : '';\n      this.formulaBar.reset(selectedCellText);\n      this.updateSelectionInfo();\n    }\n  };\n  if (cdata instanceof Promise) {\n    cdata.then(cdataNew => {\n      cdata = cdataNew;\n      execPaste();\n    });\n  }\n  else {\n    execPaste();\n  }\n}\n\nfunction hideRowsOrCols() {\n  this.data.hideRowsOrCols();\n  sheetReset.call(this);\n}\n\nfunction unhideRowsOrCols(type, index) {\n  this.data.unhideRowsOrCols(type, index);\n  sheetReset.call(this);\n}\n\nfunction autofilter() {\n  const { data } = this;\n  data.autofilter();\n  sheetReset.call(this);\n}\n\nfunction toolbarChangePaintformatPaste() {\n  const { toolbar } = this;\n  if (toolbar.paintformatActive()) {\n    paste.call(this, 'format');\n    clearClipboard.call(this);\n    toolbar.paintformatToggle();\n  }\n}\n\nfunction overlayerMousedown(evt) {\n  // console.log(':::::overlayer.mousedown:', evt.detail, evt.button, evt.buttons, evt.shiftKey);\n  // console.log('evt.target.className:', evt.target.className);\n  const {\n    selector, data, table, sortFilter,\n  } = this;\n  let { offsetX, offsetY, shiftKey } = evt;\n  if (this.isSelectingCellsForFormula) {\n    shiftKey = false;\n  }\n  const trigger = evt.target.closest('.spreadsheet-trigger');\n  if (trigger) {\n    if (evt.ctrlKey || evt.metaKey) {\n      return;\n    }\n    const rect = this.overlayerEl.el.getBoundingClientRect();\n    offsetX = evt.clientX - rect.x;\n    offsetY = evt.clientY - rect.y;\n  }\n  const isAutofillEl = evt.target.className === `${cssPrefix}-selector-corner`;\n  const cellRect = data.getCellRectByXY(offsetX, offsetY);\n  const {\n    left, top, width, height,\n  } = cellRect;\n  let { ri, ci } = cellRect;\n  // sort or filter\n  const { autoFilter } = data;\n  if (autoFilter.includes(ri, ci)) {\n    if (left + width - 20 < offsetX && top + height - 20 < offsetY) {\n      const items = autoFilter.items(ci, (r, c) => data.rows.getCell(r, c));\n      sortFilter.hide();\n      sortFilter.set(ci, items, autoFilter.getFilter(ci), autoFilter.getSort(ci));\n      sortFilter.setOffset({ left, top: top + height + 2 });\n      return;\n    }\n  }\n\n  // console.log('ri:', ri, ', ci:', ci);\n  const isColumnHeaderClick = ri < 0;\n  const isRowHeaderClick = ci < 0;\n  const isHeaderClick = isColumnHeaderClick || isRowHeaderClick;\n  const { sci, eci, sri, eri } = this.selector.range;\n  const isSelectedColumnHeaderClick = isColumnHeaderClick && ci >= sci && ci <= eci && sri === 0 && eri === data.rows.len - 1;\n  const isSelectedRowHeaderClick = isRowHeaderClick && ri >= sri && ri <= eri && sci === 0 && eci === data.cols.len - 1;\n  const isSelectedHeaderRightClick = (isSelectedColumnHeaderClick || isSelectedRowHeaderClick) && evt.buttons === 2;\n  if (!shiftKey && !isSelectedHeaderRightClick) {\n    // console.log('selectorSetStart:::');\n    if (isAutofillEl) {\n      selector.showAutofill(ri, ci);\n    } else {\n      selectorSet.call(this, false, ri, ci);\n    }\n\n    // mouse move up\n    mouseMoveUp(window, (e) => {\n      // console.log('mouseMoveUp::::');\n      const trigger = e.target.closest('.spreadsheet-trigger');\n      let { offsetX, offsetY } = e;\n      if (trigger) {\n        if (e.ctrlKey || e.metaKey) {\n          return;\n        }\n        const rect = this.overlayerEl.el.getBoundingClientRect();\n        offsetX = e.clientX - rect.x;\n        offsetY = e.clientY - rect.y;\n      }\n      ({ ri, ci } = data.getCellRectByXY(offsetX, offsetY));\n      if (isAutofillEl) {\n        selector.showAutofill(ri, ci);\n      } else if (e.buttons === 1) {\n        selectorSet.call(this, true, ri, ci, true, true);\n      }\n    }, () => {\n      if (isAutofillEl && selector.arange && data.settings.mode !== 'read') {\n        if (data.autofill(selector.arange, 'all', msg => xtoast('Tip', msg))) {\n          table.render();\n        }\n      }\n      selector.hideAutofill();\n      toolbarChangePaintformatPaste.call(this);\n    });\n  }\n\n  if (!isAutofillEl && evt.buttons === 1) {\n    if (shiftKey) {\n      // console.log('shiftKey::::');\n      selectorSet.call(this, true, ri, ci, true, false, isHeaderClick);\n    }\n  }\n}\n\nfunction editorSetOffset() {\n  const { editor, data } = this;\n  const sOffset = data.getSelectedRect();\n  const tOffset = this.getTableOffset();\n  let sPosition = 'top';\n  // console.log('sOffset:', sOffset, ':', tOffset);\n  if (sOffset.top > tOffset.height / 2) {\n    sPosition = 'bottom';\n  }\n  editor.setOffset(sOffset, sPosition);\n  this.clickableElementsInner.offset({\n    left: -this.data.scroll.x,\n    top: -this.data.scroll.y,\n  });\n}\n\nfunction editorSet(initialText, viaF2) {\n  const { editor, data } = this;\n  if (data.settings.mode === 'read') return;\n  editorSetOffset.call(this);\n  editor.setCell(data.getSelectedCell(), data.getSelectedValidator(), initialText, viaF2);\n  clearClipboard.call(this);\n  this.updateHighlightedFormulaReferences();\n}\n\nfunction verticalScrollbarMove(distance) {\n  const { data, table, selector } = this;\n  data.scrolly(distance, () => {\n    selector.resetBRLAreaOffset();\n    editorSetOffset.call(this);\n    table.render();\n  });\n}\n\nfunction horizontalScrollbarMove(distance) {\n  const { data, table, selector } = this;\n  data.scrollx(distance, () => {\n    selector.resetBRTAreaOffset();\n    editorSetOffset.call(this);\n    table.render();\n  });\n}\n\nfunction rowResizerFinished(cRect, distance) {\n  const { ri } = cRect;\n  const { table, selector, data } = this;\n  const { range } = selector;\n  if (range.eri === ri) {\n    for (let _ri = range.sri; _ri <= range.eri; ++_ri) {\n      data.setRowHeight(_ri, distance);\n    }\n  }\n  else {\n    data.setRowHeight(ri, distance);\n  }\n  table.render();\n  selector.resetAreaOffset();\n  verticalScrollbarSet.call(this);\n  editorSetOffset.call(this);\n}\n\nfunction colResizerFinished(cRect, distance) {\n  const { ci } = cRect;\n  const { table, selector, data } = this;\n  const { range } = selector;\n  if (range.eci === ci) {\n    for (let _ci = range.sci; _ci <= range.eci; ++_ci) {\n      data.setColWidth(_ci, distance);\n    }\n  }\n  else {\n      data.setColWidth(ci, distance);\n  }\n  // console.log('data:', data);\n  table.render();\n  selector.resetAreaOffset();\n  horizontalScrollbarSet.call(this);\n  editorSetOffset.call(this);\n}\n\nfunction dataSetCellText(text, state = 'finished') {\n  const { data, table } = this;\n  // const [ri, ci] = selector.indexes;\n  if (data.settings.mode === 'read') return;\n  data.setSelectedCellText(text, state);\n  const { ri, ci } = data.selector;\n  if (state === 'finished') {\n    table.render();\n  } else {\n    this.trigger('cell-edited', text, ri, ci);\n  }\n}\n\nfunction insertDeleteRowColumn(type) {\n  const { data, selector } = this;\n  const nSelectedRows = selector.range.eri - selector.range.sri + 1;\n  const nSelectedCols = selector.range.eci - selector.range.sci + 1;\n  let needsEnsuringSelectorInSheet = false;\n  if (data.settings.mode === 'read') return;\n  if (type === 'insert-row-before' || type === 'insert-rows-before') {\n    data.insert('row', 'before', nSelectedRows);\n  } else if (type === 'insert-row-after' || type === 'insert-rows-after') {\n    data.insert('row', 'after', nSelectedRows);\n  } else if (type === 'delete-row' || type === 'delete-rows') {\n    data.delete('row');\n    needsEnsuringSelectorInSheet = true;\n  } else if (type === 'insert-column-before' || type === 'insert-columns-before') {\n    data.insert('column', 'before', nSelectedCols);\n  } else if (type === 'insert-column-after' || type === 'insert-columns-after') {\n    data.insert('column', 'after', nSelectedCols);\n  } else if (type === 'delete-column' || type === 'delete-columns') {\n    data.delete('column');\n    needsEnsuringSelectorInSheet = true;\n  } else if (type === 'reset-row-height') {\n    for (let ri = selector.range.sri; ri <= selector.range.eri; ++ri) {\n      data.rows.setHeight(ri, 25);\n    }\n  } else if (type === 'reset-column-width') {\n    for (let ci = selector.range.sci; ci <= selector.range.eci; ++ci) {\n      data.cols.setWidth(ci, 100);\n    }\n  } else if (type === 'delete-cell') {\n    data.deleteCell();\n  } else if (type === 'delete-cell-format') {\n    data.deleteCell('format');\n  } else if (type === 'delete-cell-text') {\n    data.deleteCell('text');\n  } else if (type === 'cell-printable') {\n    data.setSelectedCellAttr('printable', true);\n  } else if (type === 'cell-non-printable') {\n    data.setSelectedCellAttr('printable', false);\n  } else if (type === 'cell-editable') {\n    data.setSelectedCellAttr('editable', true);\n  } else if (type === 'cell-non-editable') {\n    data.setSelectedCellAttr('editable', false);\n  }\n  if (needsEnsuringSelectorInSheet) {\n    ensureSelectorInSheet.call(this);\n  }\n  clearClipboard.call(this);\n  sheetReset.call(this);\n}\n\nfunction toolbarChange(type, value) {\n  const { data } = this;\n  if (type === 'undo') {\n    this.undo();\n  } else if (type === 'redo') {\n    this.redo();\n  } else if (type === 'print') {\n    this.print.preview();\n  } else if (type === 'paintformat') {\n    if (value === true) copy.call(this);\n    else clearClipboard.call(this);\n  } else if (type === 'clearformat') {\n    insertDeleteRowColumn.call(this, 'delete-cell-format');\n  } else if (type === 'link') {\n    // link\n  } else if (type === 'chart') {\n    // chart\n  } else if (type === 'autofilter') {\n    // filter\n    autofilter.call(this);\n  } else if (type === 'freeze') {\n    if (value) {\n      const { ri, ci } = data.selector;\n      this.freeze(ri, ci);\n    } else {\n      this.freeze(0, 0);\n    }\n  } else {\n    data.setSelectedCellAttr(type, value);\n    if (type === 'formula' && !data.selector.multiple()) {\n      editorSet.call(this);\n    }\n    sheetReset.call(this);\n  }\n}\n\nfunction sortFilterChange(ci, order, operator, value) {\n  // console.log('sort:', sortDesc, operator, value);\n  this.data.setAutoFilter(ci, order, operator, value);\n  sheetReset.call(this);\n}\n\nfunction sheetInitEvents() {\n  const {\n    selector,\n    overlayerEl,\n    rowResizer,\n    colResizer,\n    verticalScrollbar,\n    horizontalScrollbar,\n    editor,\n    contextMenu,\n    toolbar,\n    modalValidation,\n    sortFilter,\n  } = this;\n  // overlayer\n  overlayerEl\n    .on('mousemove', (evt) => {\n      overlayerMousemove.call(this, evt);\n    })\n    .on('mousedown', (evt) => {\n      let formulaCellRow;\n      let formulaCellCol;\n      let editorCursorPos;\n      if (editor.isEnteringFormula()) {\n        this.isSelectingCellsForFormula = true;\n        formulaCellRow = this.selector.range.sri;\n        formulaCellCol = this.selector.range.sci;\n        editorCursorPos = this.editor.getCursorPosition();\n      }\n      else {\n        editor.clear();\n      }\n      contextMenu.hide();\n      // the left mouse button: mousedown → mouseup → click\n      // the right mouse button: mousedown → contenxtmenu → mouseup\n      if (evt.buttons === 2) {\n        let { offsetX, offsetY } = evt;\n        const trigger = evt.target.closest('.spreadsheet-trigger');\n        if (trigger) {\n          if (evt.ctrlKey || evt.metaKey) {\n            return;\n          }\n          const rect = this.overlayerEl.el.getBoundingClientRect();\n          offsetX = evt.clientX - rect.x;\n          offsetY = evt.clientY - rect.y;\n        }\n        const cellRect = this.data.getCellRectByXY(offsetX, offsetY);\n        const { ri, ci } = cellRect;\n        this.updateContextMenuTargetRange(ri, ci);\n        if (this.data.xyInSelectedRect(evt.offsetX, evt.offsetY)) {\n          contextMenu.setPosition(evt.offsetX, evt.offsetY);\n        } else {\n          overlayerMousedown.call(this, evt);\n          contextMenu.setPosition(evt.offsetX, evt.offsetY);\n        }\n        evt.stopPropagation();\n      } else if (evt.detail === 2) {\n        editorSet.call(this);\n      } else {\n        overlayerMousedown.call(this, evt);\n      }\n      \n      if (this.isSelectingCellsForFormula) {\n        const overlayerMouseup = () => {\n          document.removeEventListener('mouseup', overlayerMouseup);\n          this.isSelectingCellsForFormula = false;\n          const col0 = this.selector.range.sci;\n          const col1 = this.selector.range.eci;\n          const row0 = this.selector.range.sri;\n          const row1 = this.selector.range.eri;\n          const isConstXY = evt.ctrlKey || evt.metaKey;\n          const rangeStart = xy2expr(col0, row0, isConstXY, isConstXY);\n          const rangeEnd = xy2expr(col1, row1, isConstXY, isConstXY);\n          const isSingleCell = rangeStart === rangeEnd;\n          const rangeText = isSingleCell ? rangeStart : `${rangeStart}:${rangeEnd}`;\n          this.editor.injectText(rangeText, editorCursorPos[0], editorCursorPos[1]);\n          this.spreadsheet.setSelectedRange({ row0: formulaCellRow, row1: formulaCellRow, col0: formulaCellCol, col1: formulaCellCol });\n          this.editor.textEl.focus();\n          this.editor.setCursorPosition(editorCursorPos[0] + rangeText.length);\n          setTimeout(() => {\n            this.editor.setCursorPosition(editorCursorPos[0] + rangeText.length);\n          }, 0);\n          this.formulaBar.setText(editor.inputText);\n          this.updateHighlightedFormulaReferences();\n        };\n        document.addEventListener('mouseup', overlayerMouseup);\n      }\n    })\n    .on('mousewheel.stop', (evt) => {\n      overlayerMousescroll.call(this, evt);\n    })\n    .on('mouseout', (evt) => {\n      const { offsetX, offsetY } = evt;\n      if (offsetY <= 0) colResizer.hide();\n      if (offsetX <= 0) rowResizer.hide();\n    });\n\n  selector.inputChange = (v) => {\n    dataSetCellText.call(this, v, 'input');\n    editorSet.call(this);\n  };\n\n  // slide on mobile\n  bindTouch(overlayerEl.el, {\n    move: (direction, d) => {\n      overlayerTouch.call(this, direction, d);\n    },\n  });\n\n  // toolbar change\n  toolbar.change = (type, value) => toolbarChange.call(this, type, value);\n\n  // sort filter ok\n  sortFilter.ok = (ci, order, o, v) => sortFilterChange.call(this, ci, order, o, v);\n\n  // resizer finished callback\n  rowResizer.finishedFn = (cRect, distance) => {\n    rowResizerFinished.call(this, cRect, distance);\n  };\n  colResizer.finishedFn = (cRect, distance) => {\n    colResizerFinished.call(this, cRect, distance);\n  };\n  // resizer unhide callback\n  rowResizer.unhideFn = (index) => {\n    unhideRowsOrCols.call(this, 'row', index);\n  };\n  colResizer.unhideFn = (index) => {\n    unhideRowsOrCols.call(this, 'col', index);\n  };\n  // scrollbar move callback\n  verticalScrollbar.moveFn = (distance, evt) => {\n    verticalScrollbarMove.call(this, distance, evt);\n  };\n  horizontalScrollbar.moveFn = (distance, evt) => {\n    horizontalScrollbarMove.call(this, distance, evt);\n  };\n  // editor\n  editor.change = (state, itext) => {\n    if (state === 'finished') {\n      this.formulaBar.reset(itext);\n      this.updateSelectionInfo();\n    }\n    else {\n      this.formulaBar.setText(itext);\n      this.updateSelectionInfo();\n    }\n    dataSetCellText.call(this, itext, state);\n    this.updateHighlightedFormulaReferences();\n  };\n  // modal validation\n  modalValidation.change = (action, ...args) => {\n    if (action === 'save') {\n      this.data.addValidation(...args);\n    } else {\n      this.data.removeValidation();\n    }\n  };\n  // contextmenu\n  contextMenu.itemClick = (type) => {\n    // console.log('type:', type);\n    if (type === 'validation') {\n      modalValidation.setValue(this.data.getSelectedValidation());\n    } else if (type === 'copy') {\n      copy.call(this);\n    } else if (type === 'cut') {\n      cut.call(this);\n    } else if (type === 'paste') {\n      paste.call(this, 'all');\n    } else if (type === 'paste-value') {\n      paste.call(this, 'text');\n    } else if (type === 'paste-format') {\n      paste.call(this, 'format');\n    } else if (type === 'hide') {\n      hideRowsOrCols.call(this);\n    } else {\n      insertDeleteRowColumn.call(this, type);\n    }\n  };\n\n  bind(window, 'resize', () => {\n    this.reload();\n  });\n\n  bind(window, 'click', (evt) => {\n    this.focusing = this.spreadsheetEl.contains(evt.target);\n  });\n\n  bind(window, 'paste', (evt) => {\n    if (!this.focusing) return;\n    paste.call(this, 'all', evt);\n    evt.preventDefault();\n  });\n\n  bind(window, 'copy', (evt) => {\n    if (!this.focusing) return;\n    if (document.activeElement === this.formulaBar.inputEl.el) {\n      return;\n    }\n    copy.call(this, evt);\n    evt.preventDefault();\n  });\n  \n  bind(window, 'cut', (evt) => {\n    if (!this.focusing) return;\n    if (document.activeElement === this.formulaBar.inputEl.el) {\n      return;\n    }\n    cut.call(this, evt);\n    evt.preventDefault();\n  });\n\n  // for selector\n  bind(window, 'keydown', (evt) => {\n    if (!this.focusing) return;\n    const keyCode = evt.keyCode || evt.which;\n    const {\n      key, altKey, ctrlKey, shiftKey, metaKey,\n    } = evt;\n    // console.log('keydown.evt: ', keyCode);\n    if (ctrlKey || metaKey) {\n      // const { sIndexes, eIndexes } = selector;\n      // let what = 'all';\n      // if (shiftKey) what = 'text';\n      // if (altKey) what = 'format';\n      switch (keyCode) {\n        case 90:\n          // undo: ctrl + z\n          this.undo();\n          evt.preventDefault();\n          break;\n        case 89:\n          // redo: ctrl + y\n          this.redo();\n          evt.preventDefault();\n          break;\n        case 67:\n          // ctrl + c\n          // => copy\n          // copy.call(this);\n          // evt.preventDefault();\n          break;\n        case 88:\n          // ctrl + x\n          // cut.call(this);\n          // evt.preventDefault();\n          break;\n        case 85:\n          // ctrl + u\n          toolbar.trigger('underline');\n          evt.preventDefault();\n          break;\n        case 86:\n          // ctrl + v\n          // => paste\n          // evt.preventDefault();\n          break;\n        case 37:\n          // ctrl + left\n          selectorMove.call(this, shiftKey, 'row-first');\n          evt.preventDefault();\n          break;\n        case 38:\n          // ctrl + up\n          selectorMove.call(this, shiftKey, 'col-first');\n          evt.preventDefault();\n          break;\n        case 39:\n          // ctrl + right\n          selectorMove.call(this, shiftKey, 'row-last');\n          evt.preventDefault();\n          break;\n        case 40:\n          // ctrl + down\n          selectorMove.call(this, shiftKey, 'col-last');\n          evt.preventDefault();\n          break;\n        case 32:\n          // ctrl + space, all cells in col\n          selectorSet.call(this, false, -1, this.data.selector.ci, false);\n          evt.preventDefault();\n          break;\n        case 66:\n          // ctrl + B\n          toolbar.trigger('bold');\n          break;\n        case 73:\n          // ctrl + I\n          toolbar.trigger('italic');\n          break;\n        default:\n          break;\n      }\n    } else {\n      // console.log('evt.keyCode:', evt.keyCode);\n      switch (keyCode) {\n        case 32:\n          if (shiftKey) {\n            // shift + space, all cells in row\n            selectorSet.call(this, false, this.data.selector.ri, -1, false);\n          }\n          break;\n        case 27: // esc\n          contextMenu.hide();\n          clearClipboard.call(this);\n          break;\n        case 37: // left\n          selectorMove.call(this, shiftKey, 'left');\n          evt.preventDefault();\n          break;\n        case 38: // up\n          selectorMove.call(this, shiftKey, 'up');\n          evt.preventDefault();\n          break;\n        case 39: // right\n          selectorMove.call(this, shiftKey, 'right');\n          evt.preventDefault();\n          break;\n        case 40: // down\n          selectorMove.call(this, shiftKey, 'down');\n          evt.preventDefault();\n          break;\n        case 9: // tab\n          editor.clear();\n          // shift + tab => move left\n          // tab => move right\n          selectorMove.call(this, false, shiftKey ? 'left' : 'right');\n          evt.preventDefault();\n          break;\n        case 13: // enter\n          editor.clear();\n          // shift + enter => move up\n          // enter => move down\n          selectorMove.call(this, false, altKey ? 'up' : 'down');\n          evt.preventDefault();\n          break;\n        case 8: // backspace\n          insertDeleteRowColumn.call(this, 'delete-cell-text');\n          evt.preventDefault();\n          break;\n        default:\n          break;\n      }\n\n      if (key === 'Delete') {\n        insertDeleteRowColumn.call(this, 'delete-cell-text');\n        evt.preventDefault();\n      } else if ((keyCode >= 65 && keyCode <= 90)\n        || (keyCode >= 48 && keyCode <= 57)\n        || (keyCode >= 96 && keyCode <= 105)\n        || (keyCode >= 186 && keyCode <= 192)\n        || (keyCode >= 219 && keyCode <= 222)\n        || evt.key === '='\n      ) {\n        const selectedCell = this.data.getSelectedCell();\n        const initialText = selectedCell ? selectedCell.text : '';\n        dataSetCellText.call(this, evt.key, 'input');\n        editorSet.call(this, initialText);\n        this.formulaBar.setText(editor.inputText);\n      } else if (keyCode === 113) {\n        // F2\n        editorSet.call(this, null, true);\n      }\n    }\n  });\n}\n\nexport default class Sheet {\n  constructor(targetEl, data, spreadsheet) {\n    this.spreadsheetEl = targetEl;\n    this.spreadsheet = spreadsheet;\n    this.eventMap = createEventEmitter();\n    const { view, showToolbar, showContextmenu, showContextMenuForCells, formulaBar, contextMenu } = data.settings;\n    this.el = h('div', `${cssPrefix}-sheet`);\n    this.toolbar = new Toolbar(data, view.width, !showToolbar);\n    this.formulaBar = new FormulaBar(data.settings.mode !== 'read', formulaBar, value => {\n      dataSetCellText.call(this, value, 'finished');\n      if (this.editor.cell) {\n        this.editor.setText(value, true);\n        this.updateHighlightedFormulaReferences();\n      }\n      this.trigger('change');\n    });\n    this.print = new Print(data, spreadsheet);\n    targetEl.children(this.toolbar.el, this.formulaBar.el, this.el, this.print.el);\n    this.data = data;\n    // table\n    this.tableEl = h('canvas', `${cssPrefix}-table`);\n    // resizer\n    this.rowResizer = new Resizer(false, data.rows.height);\n    this.colResizer = new Resizer(true, data.cols.minWidth);\n    // scrollbar\n    this.verticalScrollbar = new Scrollbar(true);\n    this.horizontalScrollbar = new Scrollbar(false);\n    // editor\n    this.editor = new Editor(\n      formulas,\n      () => this.getTableOffset(),\n      data.rows.height,\n      (direction, shiftKey, horizontal) => {\n        if (direction < 0) {\n          selectorMove.call(this, shiftKey, horizontal ? 'left' : 'up');\n        }\n        else if (direction > 0) {\n          selectorMove.call(this, shiftKey, horizontal ? 'right' : 'down');\n        }\n      },\n      data.settings.suggestFormulas,\n      this.spreadsheet.getChoosers(),\n      this.spreadsheet,\n    );\n    // data validation\n    this.modalValidation = new ModalValidation();\n    // contextMenu\n    this.contextMenu = new ContextMenu(() => this.getRect(), !showContextmenu, !showContextMenuForCells, contextMenu);\n    // selector\n    this.selector = new Selector(data);\n    this.clickableElementsInner = h('div', `${cssPrefix}-overlayer-clickable-elements-inner`);\n    this.clickableElementsContainer = h('div', `${cssPrefix}-overlayer-clickable-elements-container`)\n      .child(this.clickableElementsInner);\n    this.overlayerCEl = h('div', `${cssPrefix}-overlayer-content`)\n      .children(\n        this.editor.el,\n        this.selector.el,\n        this.clickableElementsContainer,\n      );\n    this.overlayerEl = h('div', `${cssPrefix}-overlayer`)\n      .child(this.overlayerCEl);\n    // sortFilter\n    this.sortFilter = new SortFilter();\n    // root element\n    this.el.children(\n      this.tableEl,\n      this.overlayerEl.el,\n      this.rowResizer.el,\n      this.colResizer.el,\n      this.verticalScrollbar.el,\n      this.horizontalScrollbar.el,\n      this.contextMenu.el,\n      this.modalValidation.el,\n      this.sortFilter.el,\n    );\n    // table\n    this.table = new Table(this.tableEl.el, data, this.spreadsheet, this.clickableElementsInner);\n    sheetInitEvents.call(this);\n    sheetReset.call(this);\n    // init selector [0, 0]\n    selectorSet.call(this, false, 0, 0);\n    this.selectorSet = selectorSet;\n    this.clearClipboard = clearClipboard;\n    this.isSelectingCellsForFormula = false;\n  }\n  \n  focus() {\n    this.selector.focus();\n  }\n\n  on(eventName, func) {\n    this.eventMap.on(eventName, func);\n    return this;\n  }\n\n  trigger(eventName, ...args) {\n    const { eventMap } = this;\n    eventMap.fire(eventName, args);\n  }\n\n  resetData(data) {\n    // before\n    this.editor.clear();\n    // after\n    this.data = data;\n    verticalScrollbarSet.call(this);\n    horizontalScrollbarSet.call(this);\n    this.toolbar.resetData(data);\n    this.print.resetData(data);\n    this.selector.resetData(data);\n    this.table.resetData(data);\n  }\n\n  loadData(data) {\n    this.data.setData(data);\n    sheetReset.call(this);\n    return this;\n  }\n\n  // freeze rows or cols\n  freeze(ri, ci) {\n    const { data } = this;\n    data.setFreeze(ri, ci);\n    sheetReset.call(this);\n    return this;\n  }\n\n  undo() {\n    this.data.undo(() => {\n      this.trigger('undo-performed');\n    });\n    sheetReset.call(this);\n  }\n\n  redo() {\n    this.data.redo(() => {\n      this.trigger('redo-performed');\n    });\n    sheetReset.call(this);\n  }\n\n  reload() {\n    sheetReset.call(this);\n    return this;\n  }\n\n  getRect() {\n    const { data } = this;\n    return { width: data.viewWidth(), height: data.viewHeight() };\n  }\n\n  getTableOffset() {\n    const { rows, cols } = this.data;\n    const { width, height } = this.getRect();\n    return {\n      width: width - cols.indexWidth,\n      height: height - rows.height,\n      left: cols.indexWidth,\n      top: rows.height,\n    };\n  }\n  \n  setSelectedCellCustomFormatter(formatter) {\n    this.data.setSelectedCellCustomFormatter(formatter);\n    sheetReset.call(this);\n  }\n  \n  clearSelectedCellCustomFormatter() {\n    this.data.clearSelectedCellCustomFormatter();\n    sheetReset.call(this);\n  }\n  \n  updateSelectionInfo() {\n    const { data } = this;\n    const { rows, selector } = data;\n    const numericValues = [];\n    if (selector.range.sri !== selector.range.eri || selector.range.sci !== selector.range.eci) {\n      for (let ri = selector.range.sri; ri <= selector.range.eri; ++ri) {\n        for (let ci = selector.range.sci; ci <= selector.range.eci; ++ci) {\n          const cell = rows.getCell(ri, ci);\n          if (cell && cell.text && cell.text.length > 0) {\n            let text = cell.text;\n            if (text.startsWith('=')) {\n              text = _cell.render(this.spreadsheet, cell.text || '', formulam, (y, x) => (data.getCellTextOrDefault(x, y)));\n              cell._lastRenderedFormula = text;\n            }\n            if (!isNaN(text)) {\n              numericValues.push(parseFloat(text));\n            }\n          }\n        }\n      }\n    }\n    if (numericValues.length === 0) {\n      this.formulaBar.setSelectionInfoText('');\n    }\n    else {\n      const sum = numericValues.reduce((prev, curr) => prev + curr);\n      const avg = sum / numericValues.length;\n      \n      const formatNumber = num => {\n        const nDigits = 3;\n        const p = Math.pow(10, nDigits);\n        let str = (Math.round(p * num) / p).toFixed(nDigits);\n        while (str[str.length - 1] === '.' || str[str.length - 1] == '0') {\n          const c = str[str.length - 1];\n          str = str.substr(0, str.length - 1);\n          if (c === '.') {\n            break;\n          }\n        }\n        return str;\n      };\n      \n      const sumStr = formatNumber(sum);\n      const avgStr = formatNumber(avg);\n      \n      this.formulaBar.setSelectionInfoText(`Sum: ${sumStr}; Avg: ${avgStr}`);\n    }\n  }\n  \n  updateHighlightedFormulaReferences() {\n    const { editor, formulaBar } = this;\n    let highlight = !!editor.isOn && editor.inputText && editor.inputText[0] === '=';\n    if (highlight) {\n      const matches = [...editor.inputText.matchAll(/\\$?([a-zA-Z]{1,3}\\$?\\d+:\\$?[a-zA-Z]{1,3}\\$?\\d+|\\$?[a-zA-Z]{1,3}\\$?\\d+)/g)];\n      let nextColorIndex = 0;\n      const cells = [];\n      let formulaHtml = editor.inputText;\n      let deltaPos = 0;\n      matches.forEach(match => {\n        const str = match[0];\n        const color = highlightColors[nextColorIndex];\n        nextColorIndex = (nextColorIndex + 1) % highlightColors.length;\n        if (str.includes(':')) {\n          const [start, end] = str.split(':').map(expr => expr2xy(expr));\n          for (let x = start[0]; x <= end[0]; ++x) {\n            for (let y = start[1]; y <= end[1]; ++y) {\n              cells.push([x, y, color]);\n            }\n          }\n        }\n        else {\n          cells.push([...expr2xy(str), color]);\n        }\n        \n        const prefix = formulaHtml.substring(0, match.index + deltaPos);\n        const suffix = formulaHtml.substring(match.index + str.length + deltaPos);\n        const prevLength = formulaHtml.length;\n        formulaHtml = `${prefix}<span style=\"color:${color};\">${str}</span>${suffix}`;\n        const newLength = formulaHtml.length;\n        deltaPos += newLength - prevLength;\n      });\n      this.spreadsheet.highlightFormulaCells = cells;\n      editor.setFormulaHtml(formulaHtml);\n      formulaBar.setFormulaHtml(formulaHtml);\n    }\n    else {\n      this.spreadsheet.highlightFormulaCells = undefined;\n      editor.setFormulaHtml(\"\");\n      formulaBar.setFormulaHtml(\"\");\n    }\n    this.table.render();\n  }\n\n  updateContextMenuTargetRange(ri, ci) {\n    const { contextMenu, selector } = this;\n    const rng = selector.range;\n    contextMenu.setTargetRange({\n      sci: ci === -1 ? -1 : rng.sci,\n      eci: ci === -1 ? -1 : rng.eci,\n      sri: ri === -1 ? -1 : rng.sri,\n      eri: ri === -1 ? -1 : rng.eri,\n    });\n  }\n  \n  resizeRowAfterClearingEditor(ri, height) {\n    const fn = () => { rowResizerFinished.call(this, { ri }, height); };\n    if (this.editor.isOn) {\n      this.editor.onClearActions.push(fn);\n    }\n    else {\n      fn();\n    }\n  }\n  \n}\n","import { h } from './element';\nimport { bindClickoutside, unbindClickoutside } from './event';\nimport { cssPrefix } from '../config';\nimport Icon from './icon';\nimport FormInput from './form_input';\nimport Dropdown from './dropdown';\n// Record: temp not used\n// import { xtoast } from './message';\nimport { tf } from '../locale/locale';\n\nclass DropdownMore extends Dropdown {\n  constructor(click) {\n    const icon = new Icon('ellipsis');\n    super(icon, 'auto', false, 'top-left');\n    this.contentClick = click;\n  }\n\n  reset(items) {\n    const eles = items.map((it, i) => h('div', `${cssPrefix}-item`)\n      .css('width', '150px')\n      .css('font-weight', 'normal')\n      .on('click', () => {\n        this.contentClick(i);\n        this.hide();\n      })\n      .child(it));\n    this.setContentChildren(...eles);\n  }\n\n  setTitle() {}\n}\n\nconst menuItems = [\n  { key: 'delete', title: tf('contextmenu.deleteSheet') },\n];\n\nfunction buildMenuItem(item) {\n  return h('div', `${cssPrefix}-item`)\n    .child(item.title())\n    .on('click', () => {\n      this.itemClick(item.key);\n      this.hide();\n    });\n}\n\nfunction buildMenu() {\n  return menuItems.map(it => buildMenuItem.call(this, it));\n}\n\nclass ContextMenu {\n  constructor() {\n    this.el = h('div', `${cssPrefix}-contextmenu`)\n      .css('width', '160px')\n      .children(...buildMenu.call(this))\n      .hide();\n    this.itemClick = () => {};\n  }\n\n  hide() {\n    const { el } = this;\n    el.hide();\n    unbindClickoutside(el);\n  }\n\n  setOffset(offset) {\n    const { el } = this;\n    el.offset(offset);\n    el.show();\n    bindClickoutside(el);\n  }\n}\n\nexport default class Bottombar {\n  constructor(addFunc = () => {},\n    swapFunc = () => {},\n    deleteFunc = () => {},\n    updateFunc = () => {}) {\n    this.swapFunc = swapFunc;\n    this.updateFunc = updateFunc;\n    this.dataNames = [];\n    this.activeEl = null;\n    this.deleteEl = null;\n    this.items = [];\n    this.moreEl = new DropdownMore((i) => {\n      this.clickSwap2(this.items[i]);\n    });\n    this.contextMenu = new ContextMenu();\n    this.contextMenu.itemClick = deleteFunc;\n    this.el = h('div', `${cssPrefix}-bottombar`).children(\n      this.contextMenu.el,\n      this.menuEl = h('ul', `${cssPrefix}-menu`).child(\n        h('li', '').children(\n          new Icon('add').on('click', () => {\n            addFunc();\n          }),\n          h('span', '').child(this.moreEl),\n        ),\n      ),\n    );\n  }\n\n  addItem(name, active, options) {\n    this.dataNames.push(name);\n    const item = h('li', active ? 'active' : '').child(name);\n    item.on('click', () => {\n      this.clickSwap2(item);\n    }).on('contextmenu', (evt) => {\n      if (options.mode === 'read') return;\n      const { offsetLeft, offsetHeight } = evt.target;\n      this.contextMenu.setOffset({ left: offsetLeft, bottom: offsetHeight + 1 });\n      this.deleteEl = item;\n    }).on('dblclick', () => {\n      if (options.mode === 'read') return;\n      const v = item.html();\n      const input = new FormInput('auto', '');\n      input.val(v);\n      input.input.on('blur', ({ target }) => {\n        const { value } = target;\n        const nindex = this.dataNames.findIndex(it => it === v);\n        this.renameItem(nindex, value);\n        /*\n        this.dataNames.splice(nindex, 1, value);\n        this.moreEl.reset(this.dataNames);\n        item.html('').child(value);\n        this.updateFunc(nindex, value);\n        */\n      });\n      item.html('').child(input.el);\n      input.focus();\n    });\n    if (active) {\n      this.clickSwap(item);\n    }\n    this.items.push(item);\n    this.menuEl.child(item);\n    this.moreEl.reset(this.dataNames);\n  }\n\n  renameItem(index, value) {\n    this.dataNames.splice(index, 1, value);\n    this.moreEl.reset(this.dataNames);\n    this.items[index].html('').child(value);\n    this.updateFunc(index, value);\n  }\n\n  clear() {\n    this.items.forEach((it) => {\n      this.menuEl.removeChild(it.el);\n    });\n    this.items = [];\n    this.dataNames = [];\n    this.moreEl.reset(this.dataNames);\n  }\n\n  deleteItem() {\n    const { activeEl, deleteEl } = this;\n    if (this.items.length > 1) {\n      const index = this.items.findIndex(it => it === deleteEl);\n      this.items.splice(index, 1);\n      this.dataNames.splice(index, 1);\n      this.menuEl.removeChild(deleteEl.el);\n      this.moreEl.reset(this.dataNames);\n      if (activeEl === deleteEl) {\n        const [f] = this.items;\n        this.activeEl = f;\n        this.activeEl.toggle();\n        return [index, 0];\n      }\n      return [index, -1];\n    }\n    return [-1];\n  }\n\n  clickSwap2(item) {\n    const index = this.items.findIndex(it => it === item);\n    this.clickSwap(item);\n    this.activeEl.toggle();\n    this.swapFunc(index);\n  }\n\n  clickSwap(item) {\n    if (this.activeEl !== null) {\n      this.activeEl.toggle();\n    }\n    this.activeEl = item;\n  }\n}\n","/* global window, document */\nimport { h } from './component/element';\nimport DataProxy from './core/data_proxy';\nimport Sheet from './component/sheet';\nimport Bottombar from './component/bottombar';\nimport { cssPrefix } from './config';\nimport { locale } from './locale/locale';\nimport { addCustomFormula } from './core/formula';\nimport './index.less';\n\nconst clickableElementFinders = [];\nfunction addClickableElementFinder(finder, render, onCtrlClick) {\n  clickableElementFinders.push({ finder, render, onCtrlClick });\n}\n\nconst choosers = [];\nfunction addChooser(getHint, onTriggered) {\n  choosers.push({ getHint, onTriggered });\n}\n\n\nclass Spreadsheet {\n  constructor(selectors, options = {}) {\n    let targetEl = selectors;\n    this.options = { showBottomBar: true, ...options };\n    this.sheetIndex = 1;\n    this.datas = [];\n    if (typeof selectors === 'string') {\n      targetEl = document.querySelector(selectors);\n    }\n    this.bottombar = this.options.showBottomBar ? new Bottombar(() => {\n      if (this.options.mode === 'read') return;\n      const d = this.addSheet();\n      this.sheet.resetData(d);\n    }, (index) => {\n      const d = this.datas[index];\n      this.sheet.resetData(d);\n    }, () => {\n      this.deleteSheet();\n    }, (index, value) => {\n      this.datas[index].name = value;\n      this.sheet.trigger('change');\n    }) : null;\n    this.data = this.addSheet();\n    const rootEl = h('div', `${cssPrefix}`)\n      .on('contextmenu', evt => evt.preventDefault());\n    // create canvas element\n    targetEl.appendChild(rootEl.el);\n    this.sheet = new Sheet(rootEl, this.data, this);\n    if (this.bottombar !== null) {\n      rootEl.child(this.bottombar.el);\n    }\n    if (!window.xSpreadsheetCtrlKeyListener) {\n      let isBodyClassSet = false;\n      window.xSpreadsheetCtrlKeyListener = evt => {\n        let hasCtrlKey = evt.ctrlKey || evt.metaKey;\n        if (hasCtrlKey !== isBodyClassSet) {\n          isBodyClassSet = hasCtrlKey;\n          document.body.classList.toggle(`${cssPrefix}-has-ctrl-key`, hasCtrlKey);\n          document.body.classList.toggle(`${cssPrefix}-no-ctrl-key`, !hasCtrlKey);\n        }\n      };\n      window.addEventListener('mousemove', window.xSpreadsheetCtrlKeyListener);\n      window.addEventListener('keydown', window.xSpreadsheetCtrlKeyListener);\n      window.addEventListener('keyup', window.xSpreadsheetCtrlKeyListener);\n    }\n  }\n  \n  focus() {\n    if (this.sheet) {\n      this.sheet.focus();\n    }\n  }\n\n  addSheet(name, active = true) {\n    const n = name || `sheet${this.sheetIndex}`;\n    const d = new DataProxy(n, this.options);\n    d.change = (...args) => {\n      this.sheet.trigger('change', ...args);\n    };\n    this.datas.push(d);\n    // console.log('d:', n, d, this.datas);\n    if (this.bottombar !== null) {\n      this.bottombar.addItem(n, active, this.options);\n    }\n    this.sheetIndex += 1;\n    return d;\n  }\n\n  deleteSheet() {\n    if (this.bottombar === null) return;\n\n    const [oldIndex, nindex] = this.bottombar.deleteItem();\n    if (oldIndex >= 0) {\n      this.datas.splice(oldIndex, 1);\n      if (nindex >= 0) this.sheet.resetData(this.datas[nindex]);\n      this.sheet.trigger('change');\n    }\n  }\n\n  loadData(data) {\n    const ds = Array.isArray(data) ? data : [data];\n    if (this.bottombar !== null) {\n      this.bottombar.clear();\n    }\n    this.datas = [];\n    if (ds.length > 0) {\n      for (let i = 0; i < ds.length; i += 1) {\n        const it = ds[i];\n        const nd = this.addSheet(it.name, i === 0);\n        nd.setData(it);\n        if (i === 0) {\n          this.sheet.resetData(nd);\n        }\n      }\n    }\n    return this;\n  }\n\n  getData() {\n    return this.datas.map(it => it.getData());\n  }\n\n  cellText(ri, ci, text, sheetIndex = 0) {\n    this.datas[sheetIndex].setCellText(ri, ci, text, 'finished');\n    return this;\n  }\n\n  cell(ri, ci, sheetIndex = 0) {\n    return this.datas[sheetIndex].getCell(ri, ci);\n  }\n\n  cellStyle(ri, ci, sheetIndex = 0) {\n    return this.datas[sheetIndex].getCellStyle(ri, ci);\n  }\n  \n  setSelectedCellCustomFormatter(formatter) {\n    this.sheet.setSelectedCellCustomFormatter(formatter);\n  }\n  \n  clearSelectedCellCustomFormatter() {\n    this.sheet.clearSelectedCellCustomFormatter();\n  }\n  \n  getSelectedRange(sheetIndex = 0) {\n    const range = this.datas[sheetIndex].selector.range;\n    return {\n      col0: range.sci,\n      col1: range.eci,\n      row0: range.sri,\n      row1: range.eri,\n    };\n  }\n  \n  setSelectedRange(range) {\n    this.sheet.selectorSet(false, range.row0, range.col0, true, false);\n    this.sheet.selectorSet(true, range.row1, range.col1, true, false);\n  }\n  \n  clearCustomClipboard() {\n    this.sheet.clearClipboard();\n  }\n\n  reRender() {\n    this.sheet.table.render();\n    return this;\n  }\n\n  on(eventName, func) {\n    this.sheet.on(eventName, func);\n    return this;\n  }\n\n  validate() {\n    const { validations } = this.data;\n    return validations.errors.size <= 0;\n  }\n\n  change(cb) {\n    this.sheet.on('change', cb);\n    return this;\n  }\n  \n  getClickableElementFinders() {\n    return clickableElementFinders;\n  }\n  \n  getChoosers() {\n    return choosers;\n  }\n\n  static locale(lang, message) {\n    locale(lang, message);\n  }\n  \n  static addCustomFormula(key, title, render) {\n    addCustomFormula(key, title, render);\n  }\n  \n  static addClickableElementFinder(finder, render, onCtrlClick) {\n    addClickableElementFinder(finder, render, onCtrlClick);\n  }\n  \n  static addChooser(getHint, onTriggered) {\n    addChooser(getHint, onTriggered);\n  }\n}\n\nconst spreadsheet = (el, options = {}) => new Spreadsheet(el, options);\n\nif (window) {\n  window.x_spreadsheet = spreadsheet;\n  window.x_spreadsheet.locale = (lang, message) => locale(lang, message);\n  window.x_spreadsheet.addCustomFormula = (key, title, render) => addCustomFormula(key, title, render);\n  window.x_spreadsheet.addClickableElementFinder = (finder, render, onCtrlClick) => addClickableElementFinder(finder, render, onCtrlClick);\n  window.x_spreadsheet.addChooser = (getHint, onTriggered) => addChooser(getHint, onTriggered);\n}\n\nexport default Spreadsheet;\nexport {\n  spreadsheet,\n};\n"],"sourceRoot":""}