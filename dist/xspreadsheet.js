!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){},function(t,e,n){},function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.r(e);var o=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=n):this.el=e,this.data={}}var e,n,o;return e=t,(n=[{key:"data",value:function(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}},{key:"on",value:function(t,e){var n=r(t.split(".")),i=n[0],o=n.slice(1),a=i;return"mousewheel"===a&&/Firefox/i.test(window.navigator.userAgent)&&(a="DOMMouseScroll"),this.el.addEventListener(a,function(t){e(t);for(var n=0;n<o.length;n+=1){var r=o[n];if("left"===r&&0!==t.button)return;if("right"===r&&2!==t.button)return;"stop"===r&&t.stopPropagation()}}),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach(function(n){e.css(n,"".concat(t[n],"px"))}),this;var n=this.el;return{top:n.offsetTop,left:n.offsetLeft,height:n.offsetHeight,width:n.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return 0===arguments.length?this.el.childNodes:(n.forEach(function(e){return t.child(e)}),this)}},{key:"removeChild",value:function(t){this.el.removeChild(t)}},{key:"child",value:function(e){var n=e;return"string"==typeof e?n=document.createTextNode(e):e instanceof t&&(n=e.el),this.el.appendChild(n),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var n=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach(function(e){n.el.setAttribute(e,t[e])})}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"focus",value:function(){this.el.focus()}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach(function(e){return t.el.style.removeProperty(e)}),this}},{key:"css",value:function(t,e){var n=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach(function(e){n.el.style[e]=t[e]}),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}},{key:"isHidden",value:function(){return"none"===this.css("display")}}])&&i(e.prototype,n),o&&i(e,o),t}(),a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new o(t,e)};n(0);function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function c(t){for(var e="",n=t;n>=s.length;)n/=s.length,n-=1,e+=s[parseInt(n,10)%s.length];var r=t%s.length;return e+=s[r]}function u(t){var e=0;t=t.toUpperCase();for(var n=0;n<t.length-1;n+=1){var r=t.charCodeAt(n)-65,i=t.length-1-n;e+=Math.pow(s.length,i)+s.length*r}return e+=t.charCodeAt(t.length-1)-65}function f(t){var e="",n="";t=t.replace(/\$/g,"");for(var r=0;r<t.length;r+=1)t.charAt(r)>="0"&&t.charAt(r)<="9"?n+=t.charAt(r):e+=t.charAt(r);return[u(e),parseInt(n,10)-1]}function h(t,e,n,r){return"".concat(n?"$":"").concat(c(t)).concat(r?"$":"").concat(e+1)}function d(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0;if(0===e&&0===n)return t;var a=l(f(t),2),s=a[0],c=a[1];return r(s,c)?h(s+e,c+n,i,o):t}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var v=function(){function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sri=e,this.sci=n,this.eri=r,this.eci=i,this.w=o,this.h=a}var e,n,r;return e=t,r=[{key:"valueOf",value:function(e){var n=e.split(":"),r=p(f(n[0]),2),i=r[0],o=r[1],a=o,l=i;if(n.length>1){var s=p(f(n[1]),2);l=s[0],a=s[1]}return new t(o,i,a,l)}}],(n=[{key:"set",value:function(t,e,n,r){this.sri=t,this.sci=e,this.eri=n,this.eci=r}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(1===r.length){var o=f(r[0]),a=p(o,2);e=a[0],t=a[1]}else 2===r.length&&(t=r[0],e=r[1]);var l=this.sri,s=this.sci,c=this.eri,u=this.eci;return l<=t&&t<=c&&s<=e&&e<=u}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=this.sri,r=this.sci,i=this.eri,o=this.eci,a=n;a<=i;a+=1)if(e(a))for(var l=r;l<=o;l+=1)t(a,l)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var n=this.sri,r=this.sci,i=this.eri,o=this.eci;return new t(e.sri<n?e.sri:n,e.sci<r?e.sci:r,e.eri>i?e.eri:i,e.eci>o?e.eci:o)}},{key:"difference",value:function(e){var n=[],r=function(e,r,i,o){n.push(new t(e,r,i,o))},i=this.sri,o=this.sci,a=this.eri,l=this.eci,s=e.sri-i,c=e.sci-o,u=a-e.eri,f=l-e.eci;return s>0?(r(i,o,e.sri-1,l),u>0?(r(e.eri+1,o,a,l),c>0&&r(e.sri,o,e.eri,e.sci-1),f>0&&r(e.sri,e.eci+1,e.eri,l)):(c>0&&r(e.sri,o,a,e.sci-1),f>0&&r(e.sri,e.eci+1,a,l))):u>0&&(r(e.eri+1,o,a,l),c>0&&r(i,o,e.eri,e.sci-1),f>0&&r(i,e.eci+1,e.eri,l)),c>0?(r(i,o,a,e.sci-1),f>0?(r(i,e.eri+1,a,l),s>0&&r(i,e.sci,e.sri-1,e.eci),u>0&&r(e.sri+1,e.sci,a,e.eci)):(s>0&&r(i,e.sci,e.sri-1,l),u>0&&r(e.sri+1,e.sci,a,l))):f>0&&(r(a,e.eci+1,a,l),s>0&&r(i,o,e.sri-1,e.eci),u>0&&r(e.eri+1,o,a,e.eci)),n}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var t=this.sri,e=this.sci,n=this.eri,r=this.eci,i=h(e,t);return this.multiple()&&(i="".concat(i,":").concat(h(r,n))),i}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}}])&&y(e.prototype,n),r&&y(e,r),t}();function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var b=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=new v(0,0,0,0),this.ri=0,this.ci=0}var e,n,r;return e=t,(n=[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(t,e){this.ri=t,this.ci=e}},{key:"size",value:function(){return this.range.size()}}])&&g(e.prototype,n),r&&g(e,r),t}();var m=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=0,this.y=0,this.ri=0,this.ci=0};function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var k=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.undoItems=[],this.redoItems=[]}var e,n,r;return e=t,(n=[{key:"add",value:function(t){this.undoItems.push(JSON.stringify(t)),this.redoItems=[]}},{key:"canUndo",value:function(){return this.undoItems.length>0}},{key:"canRedo",value:function(){return this.redoItems.length>0}},{key:"undo",value:function(t,e){var n=this.undoItems,r=this.redoItems;this.canUndo()&&(r.push(JSON.stringify(t)),e(JSON.parse(n.pop())))}},{key:"redo",value:function(t,e){var n=this.undoItems,r=this.redoItems;this.canRedo()&&(n.push(JSON.stringify(t)),e(JSON.parse(r.pop())))}}])&&w(e.prototype,n),r&&w(e,r),t}();function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var O=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=null,this.state="clear"}var e,n,r;return e=t,(n=[{key:"copy",value:function(t){return this.range=t,this.state="copy",this}},{key:"cut",value:function(t){return this.range=t,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}])&&x(e.prototype,n),r&&x(e,r),t}();function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function C(t,e,n){return e&&E(t.prototype,e),n&&E(t,n),t}var j=function(){function t(e,n,r){S(this,t),this.ci=e,this.operator=n,this.value=r}return C(t,[{key:"set",value:function(t,e){this.operator=t,this.value=e}},{key:"includes",value:function(t){var e=this.operator,n=this.value;return"all"===e||"in"===e&&n.includes(t)}},{key:"vlength",value:function(){var t=this.operator,e=this.value;return"in"===t?e.length:0}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}]),t}(),_=function(){function t(e,n){S(this,t),this.ci=e,this.order=n}return C(t,[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}]),t}(),T=function(){function t(){S(this,t),this.ref=null,this.filters=[],this.sort=null}return C(t,[{key:"setData",value:function(t){var e=t.ref,n=t.filters,r=t.sort;null!=e&&(this.ref=e,this.filters=n.map(function(t){return new j(t.ci,t.operator,t.value)}),r&&(this.sort=new _(r.ci,r.order)))}},{key:"getData",value:function(){if(this.active()){var t=this.ref,e=this.filters,n=this.sort;return{ref:t,filters:e.map(function(t){return t.getData()}),sort:n}}return{}}},{key:"addFilter",value:function(t,e,n){var r=this.getFilter(t);null==r?this.filters.push(new j(t,e,n)):r.set(e,n)}},{key:"setSort",value:function(t,e){this.sort=e?new _(t,e):null}},{key:"includes",value:function(t,e){return!!this.active()&&this.hrange().includes(t,e)}},{key:"getSort",value:function(t){var e=this.sort;return e&&e.ci===t?e:null}},{key:"getFilter",value:function(t){for(var e=this.filters,n=0;n<e.length;n+=1)if(e[n].ci===t)return e[n];return null}},{key:"filteredRows",value:function(t){var e=new Set,n=new Set;if(this.active())for(var r=this.range(),i=r.sri,o=r.eri,a=this.filters,l=i+1;l<=o;l+=1)for(var s=0;s<a.length;s+=1){var c=a[s],u=t(l,c.ci),f=u?u.text:"";if(!c.includes(f)){e.add(l);break}n.add(l)}return{rset:e,fset:n}}},{key:"items",value:function(t,e){var n={};if(this.active())for(var r=this.range(),i=r.sri,o=r.eri,a=i+1;a<=o;a+=1){var l=e(a,t);if(null===l||/^\s*$/.test(l.text))n[""]=(n[""]||0)+1;else{var s=l.text,c=(n[s]||0)+1;n[s]=c}}return n}},{key:"range",value:function(){return v.valueOf(this.ref)}},{key:"hrange",value:function(){var t=this.range();return t.eri=t.sri,t}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}]),t}();function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var P=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._=e}var e,n,r;return e=t,(n=[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter(function(e){return!e.within(t)})}},{key:"getFirstIncludes",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter(function(t){return t.intersects(e)}))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1){if(this._[e].intersects(t))return!0}return!1}},{key:"union",value:function(t){var e=t;return this._.forEach(function(t){t.intersects(e)&&(e=t.union(e))}),e}},{key:"add",value:function(t){this.deleteWithin(t),this._.push(t)}},{key:"shift",value:function(t,e,n,r){var i=[];n<0&&this._.forEach(function(r){var o=r.sri,a=r.sci,l=r.eri,s=r.eci;i.includes(r)||("row"===t?o>=e&&l<=e-n-1&&i.push(r):"column"===t&&a>=e&&s<=e-n-1&&i.push(r))}),this._=this._.filter(function(t){return!i.includes(t)}),this._.forEach(function(i){var o=i.sri,a=i.sci,l=i.eri,s=i.eci,c=i;"row"===t?o===e?c.toRm=!0:o>e?(c.sri+=n,c.eri+=n):o<e&&e<=l&&(c.eri+=n,r(o,a,n,0)):"column"===t&&(a===e?c.toRm=!0:a>=e?(c.sci+=n,c.eci+=n):a<e&&e<=s&&(c.eci+=n,r(o,a,0,n)))}),this._=this._.filter(function(t){return!t.toRm&&(t.sci!==t.eci||t.sri!==t.eri)})}},{key:"move",value:function(t,e,n){this._.forEach(function(r){var i=r;i.within(t)&&(i.eri+=e,i.sri+=e,i.sci+=n,i.eci+=n)})}},{key:"setData",value:function(t){return this._=t.map(function(t){return v.valueOf(t)}),this.removeBrokenMerges(),this}},{key:"getData",value:function(){return this.removeBrokenMerges(),this._.map(function(t){return t.toString()})}},{key:"removeBrokenMerges",value:function(){this._=this._.filter(function(t){return t.sci!==t.eci||t.sri!==t.eri})}}])&&A(e.prototype,n),r&&A(e,r),t}();var R=function t(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.forEach(function(n){Object.keys(n).forEach(function(r){var i=n[r];"string"==typeof i||"number"==typeof i||"boolean"==typeof i?e[r]=i:"function"!=typeof i&&!Array.isArray(i)&&i instanceof Object?(e[r]=e[r]||{},t(e[r],i)):e[r]=i})}),e};function I(t){for(var e="".concat(t),n=0,r=!1,i=0;i<e.length;i+=1)!0===r&&(n+=1),"."===e.charAt(i)&&(r=!0);return n}function F(t,e,n){if(Number.isNaN(e)||Number.isNaN(n))return e+t+n;var r=I(e),i=I(n),o=Number(e),a=Number(n);if(isNaN(o)||isNaN(a))return Number.NaN;var l=0;if("-"===t)l=o-a;else if("+"===t)l=o+a;else if("*"===t)l=o*a;else if("/"===t)return I(l=o/a)>5?l.toFixed(2):l;return l.toFixed(Math.max(r,i))}var D={cloneDeep:function(t){return JSON.parse(JSON.stringify(t))},merge:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return R.apply(void 0,[{}].concat(e))},equals:function t(e,n){var r=Object.keys(e);if(r.length!==Object.keys(n).length)return!1;for(var i=0;i<r.length;i+=1){var o=r[i],a=e[o],l=n[o];if(void 0===l)return!1;if("string"==typeof a||"number"==typeof a||"boolean"==typeof a){if(a!==l)return!1}else if(Array.isArray(a)){if(a.length!==l.length)return!1;for(var s=0;s<a.length;s+=1)if(!t(a[s],l[s]))return!1}else if("function"!=typeof a&&!Array.isArray(a)&&a instanceof Object&&!t(a,l))return!1}return!0},arrayEquals:function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(t[n]!==e[n])return!1;return!0},sum:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},n=0,r=0;return Object.keys(t).forEach(function(i){n+=e(t[i],i),r+=1}),[n,r]},rangeEach:function(t,e,n){for(var r=t;r<e;r+=1)n(r)},rangeSum:function(t,e,n){for(var r=0,i=t;i<e;i+=1)r+=n(i);return r},rangeReduceIf:function(t,e,n,r,i,o){for(var a=n,l=r,s=t;s<e&&!(a>i);s+=1)a+=l=o(s);return[s,a-l,l]},deleteProperty:function(t,e){var n=t["".concat(e)];return delete t["".concat(e)],n},numberCalc:F};function z(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function H(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var M=function(){function t(e){var n=e.len,r=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.height=r}var e,n,r;return e=t,(n=[{key:"getHeight",value:function(t){if(this.isHide(t))return 0;var e=this.get(t);return e&&e.height?e.height:this.height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this.get(t);return e&&e.hide}},{key:"setHide",value:function(t,e){var n=this.getOrNew(t);!0===e?n.hide=!0:delete n.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumHeight",value:function(t,e,n){var r=this;return D.rangeSum(t,e,function(t){return n&&n.has(t)?0:r.getHeight(t)})}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{cells:{}},this._[t]}},{key:"getCell",value:function(t,e){var n=this.get(t);return void 0!==n&&void 0!==n.cells&&void 0!==n.cells[e]?n.cells[e]:null}},{key:"getCellMerge",value:function(t,e){var n=this.getCell(t,e);return n&&n.merge?n.merge:[0,0]}},{key:"getCellOrNew",value:function(t,e){var n=this.getOrNew(t);return n.cells[e]=n.cells[e]||{},n.cells[e]}},{key:"setCell",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",i=this.getOrNew(t);"all"===r?i.cells[e]=n:"text"===r?(i.cells[e]=i.cells[e]||{},i.cells[e].text=n.text):"format"===r&&(i.cells[e]=i.cells[e]||{},i.cells[e].style=n.style,n.merge&&(i.cells[e].merge=n.merge))}},{key:"setCellText",value:function(t,e,n){var r=this.getCellOrNew(t,e);!1!==r.editable&&(r.text=n)}},{key:"copyPaste",value:function(t,e,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},a=t.sri,l=t.sci,s=t.eri,c=t.eci,u=e.sri,f=e.sci,h=e.eri,p=e.eci,y=t.size(),v=z(y,2),g=v[0],b=v[1],m=e.size(),w=z(m,2),k=w[0],x=w[1],O=!0,S=0;(h<a||p<l)&&(O=!1,S=h<a?k:x);for(var E=function(t){if(r._[t])for(var e=function(e){if(r._[t].cells&&r._[t].cells[e])for(var y=u;y<=h;y+=g)for(var v=function(v){var m=y+(t-a),w=v+(e-l),k=D.cloneDeep(r._[t].cells[e]);if(k&&k.text&&k.text.length>0){var x=k.text,E=v-f+(y-u)+2;if(O||(E-=S+1),"="===x[0])k.text=x.replace(/\$?[a-zA-Z]{1,3}\$?\d+/g,function(n){var r=0,o=0;i?a===u?r=E-1:o=E-1:(r=w-e,o=m-t);var l=/\$[a-zA-Z]{1,3}\$?\d+/.test(n),s=/\$?[a-zA-Z]{1,3}\$\d+/.test(n);return l&&(r=0),s&&(o=0),/^\d+$/.test(n)?n:d(n,r,o,function(){return!0},l,s)});else if(i&&(g<=1&&b>1&&(u>s||h<a)||b<=1&&g>1&&(f>c||p<l)||g<=1&&b<=1)){var C=/[\\.\d]+$/.exec(x);if(null!==C){var j=Number(C[0])+E-1;k.text=x.substring(0,C.index)+j}}}r.setCell(m,w,k,n),o(m,w,k)},m=f;m<=p;m+=b)v(m)},y=l;y<=c;y+=1)e(y)},C=a;C<=s;C+=1)E(C)}},{key:"cutPaste",value:function(t,e){var n=this,r={};this.each(function(i){n.eachCells(i,function(o){var a=parseInt(i,10),l=parseInt(o,10);t.includes(i,o)&&(a=e.sri+(a-t.sri),l=e.sci+(l-t.sci)),r[a]=r[a]||{cells:{}},r[a].cells[l]=n._[i].cells[o]})}),this._=r}},{key:"paste",value:function(t,e){var n=this;if(!(t.length<=0)){var r=e.sri,i=e.sci;t.forEach(function(t,e){var o=r+e;t.forEach(function(t,e){var r=i+e;n.setCellText(o,r,t)})})}}},{key:"insert",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r={};this.each(function(i,o){var a=parseInt(i,10);a>=t?(a+=n,e.eachCells(i,function(e,r){r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,function(e){return d(e,0,n,function(e,n){return n>=t})}))})):e.eachCells(i,function(e,r){r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,function(e){var r=z(f(e),2);r[0];return r[1]<t?e:d(e,0,n,function(e,n){return n>=t})}))}),r[a]=o}),this._=r,this.len+=n}},{key:"delete",value:function(t,e){var n=this,r=e-t+1,i={};this.each(function(r,i){n.eachCells(r,function(n,r){r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,function(n){var r=z(f(n),2),i=(r[0],r[1]);return i>=t&&i<=e?"#REF":n}))})}),this.each(function(o,a){var l=parseInt(o,10);l<t?(i[l]=a,n.eachCells(o,function(n,i){i.text&&"="===i.text[0]&&(i.text=i.text.replace(/[a-zA-Z]{1,3}\d+/g,function(n){var i=z(f(n),2);i[0];return i[1]<t?n:d(n,0,-r,function(t,n){return n>e})}))})):o>e&&(i[l-r]=a,n.eachCells(o,function(t,n){n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,function(t){return d(t,0,-r,function(t,n){return n>e})}))}))}),this._=i,this.len-=r}},{key:"insertColumn",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.each(function(r,i){var o={};e.eachCells(r,function(e,r){var i=parseInt(e,10);i>=t?(i+=n,r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,function(e){return d(e,n,0,function(e){return e>=t})}))):r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,function(e){var r=z(f(e),2),i=r[0];r[1];return i<t?e:d(e,n,0,function(e){return e>=t})})),o[i]=r}),i.cells=o})}},{key:"deleteColumn",value:function(t,e){var n=this,r=e-t+1;this.each(function(r,i){n.eachCells(r,function(n,r){r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,function(n){var r=z(f(n),2),i=r[0];r[1];return i>=t&&i<=e?"#REF":n}))})}),this.each(function(i,o){var a={};n.eachCells(i,function(n,i){var o=parseInt(n,10);o<t?(a[o]=i,i.text&&"="===i.text[0]&&(i.text=i.text.replace(/[a-zA-Z]{1,3}\d+/g,function(n){var i=z(f(n),2),o=i[0];i[1];return o<t?n:d(n,-r,0,function(t){return t>e})}))):o>e&&(a[o-r]=i,i.text&&"="===i.text[0]&&(i.text=i.text.replace(/[a-zA-Z]{1,3}\d+/g,function(t){return d(t,-r,0,function(t){return t>e})})))}),o.cells=a})}},{key:"deleteCells",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";t.each(function(t,r){e.deleteCell(t,r,n)})}},{key:"deleteCell",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",r=this.get(t);if(null!==r){var i=this.getCell(t,e);null!==i&&!1!==i.editable&&("all"===n?delete r.cells[e]:"text"===n?(i.text&&delete i.text,i.value&&delete i.value):"format"===n?(void 0!==i.style&&delete i.style,i.merge&&delete i.merge):"merge"===n&&i.merge&&delete i.merge)}}},{key:"maxCell",value:function(){var t=Object.keys(this._),e=t[t.length-1],n=this._[e];if(n){var r=n.cells,i=Object.keys(r),o=i[i.length-1];return[parseInt(e,10),parseInt(o,10)]}return[0,0]}},{key:"each",value:function(t){Object.entries(this._).forEach(function(e){var n=z(e,2),r=n[0],i=n[1];t(r,i)})}},{key:"eachCells",value:function(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach(function(t){var n=z(t,2),r=n[0],i=n[1];e(r,i)})}},{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}}])&&H(e.prototype,n),r&&H(e,r),t}();function N(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var B=function(){function t(e){var n=e.len,r=e.width,i=e.indexWidth,o=e.minWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.width=r,this.indexWidth=i,this.minWidth=o}var e,n,r;return e=t,(n=[{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}},{key:"getWidth",value:function(t){if(this.isHide(t))return 0;var e=this._[t];return e&&e.width?e.width:this.width}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"setWidth",value:function(t,e){this.getOrNew(t).width=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this._[t];return e&&e.hide}},{key:"setHide",value:function(t,e){var n=this.getOrNew(t);!0===e?n.hide=!0:delete n.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumWidth",value:function(t,e){var n=this;return D.rangeSum(t,e,function(t){return n.getWidth(t)})}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}])&&N(e.prototype,n),r&&N(e,r),t}(),W=["en"],V={en:{toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",more:"More"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",hide:"Hide",insertRowBefore:"Insert row before",insertRowAfter:"Insert row after",insertRowsBefore:"Insert rows before",insertRowsAfter:"Insert rows after",insertColumnBefore:"Insert column before",insertColumnAfter:"Insert column after",insertColumnsBefore:"Insert columns before",insertColumnsAfter:"Insert columns after",deleteSheet:"Delete",deleteRow:"Delete row",deleteRows:"Delete rows",deleteColumn:"Delete column",deleteColumns:"Delete columns",deleteCell:"Delete cell",deleteCellText:"Delete cell text",resetRowHeight:"Reset height",resetColumnWidth:"Reset width",validation:"Data validations",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},print:{size:"Paper size",orientation:"Page orientation",orientations:["Landscape","Portrait"]},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},warning:{mergingMultipleValues:"There are multiple values in the range. Only the first one will be kept."},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{next:"Next",cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Column",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not between",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}};function L(t,e){if(e)for(var n=0,r=W;n<r.length;n++){var i=r[n];if(!e[i])break;for(var o=e[i],a=t.match(/(?:\\.|[^.])+/g),l=0;l<a.length;l+=1){var s=o[a[l]];if(!s)break;if(l===a.length-1)return s;o=s}}}function q(t){var e=L(t,V);return!e&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(e=L(t,window.x_spreadsheet.$messages)),e||""}function K(t){return function(){return q(t)}}function $(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2]?W=[t]:W.unshift(t),e&&(V[t]=e)}function U(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Z={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function X(t,e){var n="";if(!t){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];n=q.apply(void 0,["validation.".concat(e)].concat(i))}return[t,n]}var J=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.required=n,this.value=r,this.type=e,this.operator=i,this.message=""}var e,n,r;return e=t,(n=[{key:"parseValue",value:function(t){var e=this.type;return"date"===e?new Date(t):"number"===e?Number(t):t}},{key:"equals",value:function(t){var e=this.type===t.type&&this.required===t.required&&this.operator===t.operator;return e&&(e=Array.isArray(this.value)?D.arrayEquals(this.value,t.value):this.value===t.value),e}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(t){var e=this.required,n=this.operator,r=this.value,i=this.type;if(e&&/^\s*$/.test(t))return X(!1,"required");if(/^\s*$/.test(t))return[!0];if(Z[i]&&!Z[i].test(t))return X(!1,"notMatch");if("list"===i)return X(this.values().includes(t),"notIn");if(n){var o=this.parseValue(t);if("be"===n){var a=U(r,2),l=a[0],s=a[1];return X(o>=this.parseValue(l)&&o<=this.parseValue(s),"between",l,s)}if("nbe"===n){var c=U(r,2),u=c[0],f=c[1];return X(o<this.parseValue(u)||o>this.parseValue(f),"notBetween",u,f)}if("eq"===n)return X(o===this.parseValue(r),"equal",r);if("neq"===n)return X(o!==this.parseValue(r),"notEqual",r);if("lt"===n)return X(o<this.parseValue(r),"lessThan",r);if("lte"===n)return X(o<=this.parseValue(r),"lessThanEqual",r);if("gt"===n)return X(o>this.parseValue(r),"greaterThan",r);if("gte"===n)return X(o>=this.parseValue(r),"greaterThanEqual",r)}return[!0]}}])&&Y(e.prototype,n),r&&Y(e,r),t}();function G(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function et(t,e,n){return e&&tt(t.prototype,e),n&&tt(t,n),t}var nt=function(){function t(e,n,r){Q(this,t),this.refs=n,this.mode=e,this.validator=r}return et(t,[{key:"includes",value:function(t,e){for(var n=this.refs,r=0;r<n.length;r+=1){if(v.valueOf(n[r]).includes(t,e))return!0}return!1}},{key:"addRef",value:function(t){this.remove(v.valueOf(t)),this.refs.push(t)}},{key:"remove",value:function(t){var e=[];this.refs.forEach(function(n){var r=v.valueOf(n);r.intersects(t)?r.difference(t).forEach(function(t){return e.push(t.toString())}):e.push(n)}),this.refs=e}},{key:"getData",value:function(){var t=this.refs,e=this.mode,n=this.validator;return{refs:t,mode:e,type:n.type,required:n.required,operator:n.operator,value:n.value}}}],[{key:"valueOf",value:function(e){var n=e.refs,r=e.mode,i=e.type,o=e.required,a=e.operator,l=e.value;return new t(r,n,new J(i,o,l,a))}}]),t}(),rt=function(){function t(){Q(this,t),this._=[],this.errors=new Map}return et(t,[{key:"getError",value:function(t,e){return this.errors.get("".concat(t,"_").concat(e))}},{key:"validate",value:function(t,e,n){var r=this.get(t,e),i="".concat(t,"_").concat(e),o=this.errors;if(null!==r){var a=G(r.validator.validate(n),2),l=a[0],s=a[1];l?o.delete(i):o.set(i,s)}else o.delete(i);return!0}},{key:"add",value:function(t,e,n){var r=n.type,i=n.required,o=n.value,a=n.operator,l=new J(r,i,o,a),s=this.getByValidator(l);null!==s?s.addRef(e):this._.push(new nt(t,[e],l))}},{key:"getByValidator",value:function(t){for(var e=0;e<this._.length;e+=1){var n=this._[e];if(n.validator.equals(t))return n}return null}},{key:"get",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"remove",value:function(t){this.each(function(e){e.remove(t)})}},{key:"each",value:function(t){this._.forEach(function(e){return t(e)})}},{key:"getData",value:function(){return this._.filter(function(t){return t.refs.length>0}).map(function(t){return t.getData()})}},{key:"setData",value:function(t){this._=t.map(function(t){return nt.valueOf(t)})}}]),t}();function it(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function at(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var lt={mode:"edit",autoFocus:!0,view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},showGrid:!0,showToolbar:!0,showContextmenu:!0,showContextMenuForCells:!0,showBottomBar:!0,suggestFormulas:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"},cellHeaderStyle:{bgcolor:"#f4f5f8",selectedBgcolor:"rgba(75, 137, 255, 0.08)",cornerBgcolor:"#f4f5f8",fontFamily:"Source Sans Pro"},toolbar:{misc:{undo:!0,redo:!0,print:!0,paintFormat:!0,clearFormat:!0},format:{format:!0},font:{family:!0,size:!0},textStyle:{bold:!0,italic:!0,underline:!0,strike:!0,color:!0},cell:{fill:!0,borders:!0,merge:!0},cellText:{horizontalAlignment:!0,verticalAlignment:!0,wrap:!0},tools:{freezeCell:!0,filter:!0,formulas:!0},itemsCallback:function(){},clipboard:void 0},formulaBar:{location:"belowToolbar"},contextMenu:{itemsCallback:function(){},extraItems:[],preShowCallback:function(){}},cellCustomFormatterCreator:function(){}};function st(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=this.merges,i=e.clone(),o=at(t.size(),2),a=o[0],l=o[1],s=at(e.size(),2),c=s[0],u=s[1];return a>c&&(i.eri=e.sri+a-1),l>u&&(i.eci=e.sci+l-1),!r.intersects(i)||(n(q("error.pasteForMergedCell")),!1)}function ct(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.rows,o=this.merges;"all"!==n&&"format"!==n||(i.deleteCells(e,n),o.deleteWithin(e)),i.copyPaste(t,e,n,r,function(t,e,n){if(n&&n.merge){var r=at(n.merge,2),i=r[0],a=r[1];if(i<=0&&a<=0)return;o.add(new v(t,e,t+i,e+a))}})}function ut(t,e){var n=this.clipboard,r=this.rows,i=this.merges;r.cutPaste(t,e),i.move(t,e.sri-t.sri,e.sci-t.sci),n.clear()}function ft(t,e,n){var r=this.styles,i=this.rows.getCellOrNew(t,e),o={};void 0!==i.style&&(o=D.cloneDeep(r[i.style])),o=D.merge(o,{border:n}),i.style=this.addStyle(o)}var ht=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=D.merge(lt,n||{}),this.name=e||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new P,this.rows=new M(this.settings.row),this.cols=new B(this.settings.col),this.validations=new rt,this.hyperlinks={},this.comments={},this.selector=new b,this.scroll=new m,this.history=new k,this.clipboard=new O,this.autoFilter=new T,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,this.randomId=Math.random().toString(36).substr(2)}var e,n,r;return e=t,(n=[{key:"addValidation",value:function(t,e,n){var r=this;this.changeData(function(){r.validations.add(t,e,n)})}},{key:"removeValidation",value:function(){var t=this,e=this.selector.range;this.changeData(function(){t.validations.remove(e)})}},{key:"getSelectedValidator",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=this.validations.get(e,n);return r?r.validator:null}},{key:"getSelectedValidation",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=t.range,i=this.validations.get(e,n),o={ref:r.toString()};return null!==i&&(o.mode=i.mode,o.validator=i.validator),o}},{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(t){var e=this;this.history.undo(this.getData(),function(n){e.setData(n),e.change(e.getData()),t&&t()})}},{key:"redo",value:function(t){var e=this;this.history.redo(this.getData(),function(n){e.setData(n),e.change(e.getData()),t&&t()})}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range)}},{key:"copyToSystemClipboard",value:function(t){for(var e=[],n={srcType:"x-spreadsheet",srcDataId:this.randomId,cells:[],srcRange:{sci:this.selector.range.sci,eci:this.selector.range.eci,sri:this.selector.range.sri,eri:this.selector.range.eri}},r=this.selector.range,i=r.sri,o=r.eri,a=r.sci,l=r.eci,s=i;s<=o;s+=1){for(var c=[],u=a;u<=l;u+=1){var f=this.getCell(s,u),h=f&&f.text||"",d=h.startsWith("=")?f._lastRenderedFormula:h,p=this.getCellStyle(s,u);c.push(d),n.cells.push({ri:s,ci:u,text:h,style:p})}e.push(c)}e=e.map(function(t){return t.join("\t")}).join("\n"),this.settings.clipboard&&this.settings.clipboard.setData?this.settings.clipboard.setData({text:e,json:JSON.stringify(n)}):(t&&(t.clipboardData.clearData(),t.clipboardData.setData("text/plain",e),t.preventDefault()),navigator.clipboard&&navigator.clipboard.writeText(e).then(function(){},function(t){console.log("text copy to the system clipboard error  ",e,t)}))}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=this.clipboard,i=this.selector;return!r.isClear()&&(!!st.call(this,r.range,i.range,n)&&(this.changeData(function(){r.isCopy()?ct.call(t,r.range,i.range,e):r.isCut()&&ut.call(t,r.range,i.range)}),!0))}},{key:"pasteFromText",value:function(t){var e=[];if((e=/\r\n/.test(t)?t.split("\r\n").map(function(t){return t.replace(/"/g,"").split("\t")}):t.split("\n").map(function(t){return t.replace(/"/g,"").split("\t")})).length){var n=this.rows,r=this.selector;this.changeData(function(){n.paste(e,r.range)})}}},{key:"pasteFromObj",value:function(t){var e=this,n=this.selector.range.sci-t.srcRange.sci,r=this.selector.range.sri-t.srcRange.sri;this.changeData(function(){var i=!0,o=!1,a=void 0;try{for(var l,s=t.cells[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var c=l.value,u=c.ci+n,f=c.ri+r,h=e.rows.getCellOrNew(f,u);e.rows.setCellText(f,u,e.translateFormula(c.text,n,r)),h.style=c.style?e.addStyle(c.style):void 0}}catch(t){o=!0,a=t}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}})}},{key:"translateFormula",value:function(t,e,n){return t.startsWith("=")?t=t.replace(/\$?[a-zA-Z]{1,3}\$?\d+/g,function(t){if(/^\d+$/.test(t))return t;var r=/\$[a-zA-Z]{1,3}\$?\d+/.test(t),i=/\$?[a-zA-Z]{1,3}\$\d+/.test(t);return d(t,r?0:e,i?0:n,function(){return!0},r,i)}):t}},{key:"autofill",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=this.selector.range;return!!st.call(this,i,t,r)&&(this.changeData(function(){ct.call(n,i,t,e,!0)}),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.selector,i=this.rows,o=this.cols,a=this.merges,l=r.range,s=l.sri,c=l.sci,u=l.eri,f=l.eci,h=r.ri,d=r.ci,p=t,y=e;return t<0&&(p=i.len-1),e<0&&(y=o.len-1),p>h?(s=h,u=p):(s=p,u=h),y>d?(c=d,f=y):(c=y,f=d),n?r.range=new v(s,c,u,f):(r.range=a.union(new v(s,c,u,f)),r.range=a.union(r.range)),r.range}},{key:"calSelectedRangeByStart",value:function(t,e){var n=this.selector,r=this.rows,i=this.cols,o=this.merges.getFirstIncludes(t,e);return null===o&&(o=new v(t,e,t,e),-1===t&&(o.sri=0,o.eri=r.len-1),-1===e&&(o.sci=0,o.eci=i.len-1)),n.range=o,o}},{key:"setSelectedCellAttr",value:function(t,e){var n=this;this.changeData(function(){var r=n.selector,i=n.styles,o=n.rows;if("merge"===t)e?n.merge():n.unmerge();else if("border"===t)(function(t){var e=this,n=t.mode,r=t.style,i=t.color,o=this.styles,a=this.selector,l=this.rows,s=a.range,c=s.sri,u=s.sci,f=s.eri,h=s.eci,d=!this.isSingleSelected();if(d||"inside"!==n&&"horizontal"!==n&&"vertical"!==n)if("outside"!==n||d){if("none"===n)a.range.each(function(t,n){var r=l.getCell(t,n);if(r&&void 0!==r.style){var i=D.cloneDeep(o[r.style]);delete i.border,r.style=e.addStyle(i)}});else if("all"===n||"inside"===n||"outside"===n||"horizontal"===n||"vertical"===n)!function(){for(var t=[],o=c;o<=f;o+=1)for(var a=u;a<=h;a+=1){for(var s=[],p=0;p<t.length;p+=1){var y=at(t[p],4),v=y[0],g=y[1],b=y[2],m=y[3];if(o===v+b+1&&s.push(p),v<=o&&o<=v+b&&a===g){a+=m+1;break}}if(s.forEach(function(e){return t.splice(e,1)}),a>h)break;var w=l.getCell(o,a),k=0,x=0;if(w&&w.merge){var O=at(w.merge,2);k=O[0],x=O[1],t.push([o,a,k,x])}var S=k>0&&o+k===f,E=x>0&&a+x===h,C={};"all"===n?C={bottom:[r,i],top:[r,i],left:[r,i],right:[r,i]}:"inside"===n?(!E&&a<h&&(C.right=[r,i]),!S&&o<f&&(C.bottom=[r,i])):"horizontal"===n?!S&&o<f&&(C.bottom=[r,i]):"vertical"===n?!E&&a<h&&(C.right=[r,i]):"outside"===n&&d&&(c===o&&(C.top=[r,i]),(S||f===o)&&(C.bottom=[r,i]),u===a&&(C.left=[r,i]),(E||h===a)&&(C.right=[r,i])),Object.keys(C).length>0&&ft.call(e,o,a,C),a+=x}}();else if("top"===n||"bottom"===n)for(var p=u;p<=h;p+=1)"top"===n&&(ft.call(this,c,p,{top:[r,i]}),p+=l.getCellMerge(c,p)[1]),"bottom"===n&&(ft.call(this,f,p,{bottom:[r,i]}),p+=l.getCellMerge(f,p)[1]);else if("left"===n||"right"===n)for(var y=c;y<=f;y+=1)"left"===n&&(ft.call(this,y,u,{left:[r,i]}),y+=l.getCellMerge(y,u)[0]),"right"===n&&(ft.call(this,y,h,{right:[r,i]}),y+=l.getCellMerge(y,h)[0])}else ft.call(this,c,u,{top:[r,i],bottom:[r,i],left:[r,i],right:[r,i]})}).call(n,e);else if("formula"===t){var a=r.ri,l=r.ci,s=r.range;if(r.multiple()){var c=at(r.size(),2),u=c[0],f=c[1],d=s.sri,p=s.sci,y=s.eri,v=s.eci;if(u>1)for(var g=p;g<=v;g+=1){o.getCellOrNew(y+1,g).text="=".concat(e,"(").concat(h(g,d),":").concat(h(g,y),")")}else if(f>1){o.getCellOrNew(a,v+1).text="=".concat(e,"(").concat(h(p,a),":").concat(h(v,a),")")}}else{o.getCellOrNew(a,l).text="=".concat(e,"()")}}else r.range.each(function(r,a){var l=o.getCellOrNew(r,a),s={};if(void 0!==l.style&&(s=D.cloneDeep(i[l.style])),"format"===t)s.format=e,l.style=n.addStyle(s);else if("font-bold"===t||"font-italic"===t||"font-name"===t||"font-size"===t){var c={};c[t.split("-")[1]]=e,s.font=Object.assign(s.font||{},c),l.style=n.addStyle(s)}else"strike"===t||"textwrap"===t||"underline"===t||"align"===t||"valign"===t||"color"===t||"bgcolor"===t||"customFormatter"==t?(s[t]=e,l.style=n.addStyle(s,!0)):l[t]=e})})}},{key:"setSelectedCellText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",n=this.autoFilter,r=this.selector,i=this.rows,o=r.ri,a=r.ci,l=o;this.unsortedRowMap.has(o)&&(l=this.unsortedRowMap.get(o));var s=i.getCell(l,a),c=s?s.text:"";if(this.setCellText(l,a,t,e),n.active()){var u=n.getFilter(a);if(u){var f=u.value.findIndex(function(t){return t===c});f>=0&&u.value.splice(f,1,t)}}}},{key:"getSelectedCell",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=e;return this.unsortedRowMap.has(e)&&(r=this.unsortedRowMap.get(e)),this.rows.getCell(r,n)}},{key:"xyInSelectedRect",value:function(t,e){var n=this.getSelectedRect(),r=n.left,i=n.top,o=n.width,a=n.height,l=t-this.cols.indexWidth,s=e-this.rows.height;return l>r&&l<r+o&&s>i&&s<i+a}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getFirstSelectedCellRect",value:function(){var t=this.selector.ci,e=this.selector.ri,n=this.getCell(e,t),r=n&&n.merge?n.merge:[0,0],i={sci:t,eci:t+r[1],sri:e,eri:e+r[0]};return this.getRect(i)}},{key:"getClipboardRect",value:function(){var t=this.clipboard;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}},{key:"getRect",value:function(t){var e=this.scroll,n=this.rows,r=this.cols,i=this.exceptRowSet,o=t.sri,a=t.sci,l=t.eri,s=t.eci;if(o<0&&a<0)return{left:0,l:0,top:0,t:0,scroll:e};var c=r.sumWidth(0,a),u=n.sumHeight(0,o,i),f=n.sumHeight(o,l+1,i),h=r.sumWidth(a,s+1),d=c-e.x,p=u-e.y,y=this.freezeTotalHeight(),v=this.freezeTotalWidth();return v>0&&v>c&&(d=c),y>0&&y>u&&(p=u),{l:c,t:u,left:d,top:p,height:f,width:h,scroll:e}}},{key:"getCellRectByXY",value:function(t,e){var n=this.scroll,r=this.merges,i=this.rows,o=this.cols,a=function(t,e){var n=this.rows,r=this.freezeTotalHeight(),i=n.height;r+n.height<t&&(i-=e);for(var o=this.exceptRowSet,a=0,l=i,s=n.height;a<n.len&&!(l>t);a+=1)o.has(a)||(l+=s=n.getHeight(a));return(l-=s)<=0?{ri:-1,top:0,height:s}:{ri:a-1,top:l,height:s}}.call(this,e,n.y),l=a.ri,s=a.top,c=a.height,u=function(t,e){var n=this.cols,r=this.freezeTotalWidth(),i=n.indexWidth;r+n.indexWidth<t&&(i-=e);var o=at(D.rangeReduceIf(0,n.len,i,n.indexWidth,t,function(t){return n.getWidth(t)}),3),a=o[0],l=o[1],s=o[2];return l<=0?{ci:-1,left:0,width:n.indexWidth}:{ci:a-1,left:l,width:s}}.call(this,t,n.x),f=u.ci,h=u.left,d=u.width;if(-1===f&&(d=o.totalWidth()),-1===l&&(c=i.totalHeight()),l>=0||f>=0){var p=r.getFirstIncludes(l,f);if(p){l=p.sri,f=p.sci;var y=this.cellRect(l,f);h=y.left,s=y.top,d=y.width,c=y.height}}return{ri:l,ci:f,left:h,top:s,width:d,height:c}}},{key:"isSingleSelected",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,i=t.eci,o=this.getCell(e,n);if(o&&o.merge){var a=at(o.merge,2),l=a[0],s=a[1];if(e+l===r&&n+s===i)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,i=t.eci,o=this.getCell(e,n);if(o&&o.merge){var a=at(o.merge,2),l=a[0],s=a[1];if(e+l===r&&n+s===i)return!0}return!1}},{key:"merge",value:function(){var t=this,e=this.selector,n=this.rows;if(!this.isSingleSelected()){var r=at(e.size(),2),i=r[0],o=r[1];if(i>1||o>1){var a=e.range,l=a.sri,s=a.sci;this.changeData(function(){var r=t.collectMergeValues(),a=r.length>0?r[0]:"",c=n.getCellOrNew(l,s),u=t.getCellStyle(l,s),f=t.getMergeFirstNonEmptyCellStyle(),h=u||f;h&&(c.style=t.addStyle(h)),c.merge=[i-1,o-1],c.text=a,t.merges.add(e.range),t.rows.deleteCells(e.range),t.rows.setCell(l,s,c)})}}}},{key:"collectMergeValues",value:function(){for(var t=this.selector,e=this.rows,n=[],r=t.range.sri;r<=t.range.eri;++r)for(var i=t.range.sci;i<=t.range.eci;++i){var o=e.getCell(r,i);o&&o.text&&o.text.length>0&&n.push(o.text)}return n}},{key:"getMergeFirstNonEmptyCellStyle",value:function(){for(var t=this.selector,e=this.rows,n=t.range.sri;n<=t.range.eri;++n)for(var r=t.range.sci;r<=t.range.eci;++r){var i=e.getCell(n,r);if(i&&i.text&&i.text.length>0)return this.getCellStyle(n,r)}}},{key:"unmerge",value:function(){var t=this,e=this.selector;if(this.isSingleSelected()){var n=e.range,r=n.sri,i=n.sci;this.changeData(function(){t.rows.deleteCell(r,i,"merge"),t.merges.deleteWithin(e.range)})}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var t=this,e=this.autoFilter,n=this.selector;this.changeData(function(){e.active()?(e.clear(),t.exceptRowSet=new Set,t.sortedRowMap=new Map,t.unsortedRowMap=new Map):e.ref=n.range.toString()})}},{key:"setAutoFilter",value:function(t,e,n,r){var i=this.autoFilter;i.addFilter(t,n,r),i.setSort(t,e),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var t=this,e=this.autoFilter,n=this.rows;if(e.active()){var r=e.sort,i=e.filteredRows(function(t,e){return n.getCell(t,e)}),o=i.rset,a=i.fset,l=Array.from(a),s=Array.from(a);r&&l.sort(function(t,e){return"asc"===r.order?t-e:"desc"===r.order?e-t:0}),this.exceptRowSet=o,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,l.forEach(function(e,n){t.sortedRowMap.set(s[n],e),t.unsortedRowMap.set(e,s[n])})}}},{key:"deleteCell",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=this.selector;this.changeData(function(){t.rows.deleteCells(n.range,e),"all"!==e&&"format"!==e||t.merges.deleteWithin(n.range)})}},{key:"insert",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.changeData(function(){var i=n.selector.range,o=i.sri,a=i.eri,l=i.sci,s=i.eci,c=n.rows,u=n.merges,f=n.cols,h=o;"row"===t?c.insert("before"===e?o:a+1,r):"column"===t&&(c.insertColumn("before"===e?l:s+1,r),h=l,f.len+=r),u.shift(t,h,r,function(t,e,n,r){var i=c.getCell(t,e);i&&i.merge&&(i.merge[0]+=n,i.merge[1]+=r)})})}},{key:"delete",value:function(t){var e=this;this.changeData(function(){var n=e.rows,r=e.merges,i=e.selector,o=e.cols,a=i.range,l=i.range,s=l.sri,c=l.sci,u=l.eri,f=l.eci,h=at(i.range.size(),2),d=h[0],p=h[1],y=s,v=d;"row"===t?n.delete(s,u):"column"===t&&(n.deleteColumn(c,f),y=a.sci,v=p,o.len-=f-c+1),r.shift(t,y,-v,function(t,e,r,i){var o=n.getCell(t,e);o&&o.merge&&(o.merge[0]+=r,o.merge[1]+=i,o.merge[0]<=0&&o.merge[1]<=0&&delete o.merge)})})}},{key:"scrollx",value:function(t,e){var n=this.scroll,r=this.freeze,i=this.cols,o=at(r,2)[1],a=at(D.rangeReduceIf(o,i.len,0,0,t,function(t){return i.getWidth(t)}),3),l=a[0],s=a[1],c=a[2],u=s;t>0&&(u+=c),n.x!==u&&(n.ci=t>0?l:0,n.x=u,e())}},{key:"scrolly",value:function(t,e){var n=this.scroll,r=this.freeze,i=this.rows,o=at(r,1)[0],a=at(D.rangeReduceIf(o,i.len,0,0,t,function(t){return i.getHeight(t)}),3),l=a[0],s=a[1],c=a[2],u=s;t>0&&(u+=c),n.y!==u&&(n.ri=t>0?l:0,n.y=u,e())}},{key:"cellRect",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=this.rows,o=this.cols,a=o.sumWidth(0,e),l=i.sumHeight(0,t),s=i.getCell(t,e),c=o.getWidth(e),u=i.getHeight(t),f=!1,h=!0;if(null!==s){var d=this.getCellStyle(t,e);h=!d||!d.align||"left"===d.align;var p=!!d&&!!d.textwrap;if(p&&(n=!1),s.merge){f=!0;var y=at(s.merge,2),v=y[0],g=y[1];if(v>0)for(var b=1;b<=v;b+=1)u+=i.getHeight(t+b);if(g>0)for(var m=1;m<=g;m+=1)c+=o.getWidth(e+m)}}var w=n&&!f&&h&&r>=0,k=0;if(w){for(var x=10,O=0,S=1;S<=x;++S){var E=e+S,C=i.getCell(t,E);if(C&&C.text&&!this.isCellEmpty(C.text,this.getCellStyle(t,E)))break;var j=o.getWidth(E);O+=j}var _=Math.max(0,r-c);c+=k=Math.min(O,_)}return{left:a,top:l,width:c,height:u,cell:s,addedExtraWidth:k}}},{key:"isCellEmpty",value:function(t,e){var n=this.defaultStyle();if(t&&t.length>0)return!1;if(!e)return!0;for(var r in e)if("hasAlignSet"!==r){var i=e[r],o=n[r];if("font"===r&&(i=JSON.stringify(i),o=JSON.stringify(o)),i!==o)return!1}return!0}},{key:"getCell",value:function(t,e){return this.rows.getCell(t,e)}},{key:"getCellTextOrDefault",value:function(t,e){var n=this.getCell(t,e);return n&&n.text?n.text:""}},{key:"getCellStyle",value:function(t,e){var n=this.getCell(t,e);return n&&void 0!==n.style?this.styles[n.style]:null}},{key:"getCellStyleOrDefault",value:function(t,e){var n=this.styles,r=this.rows.getCell(t,e),i=r&&void 0!==r.style?n[r.style]:{},o=D.merge(this.defaultStyle(),i);return o.hasAlignSet=!!i.align,o}},{key:"getSelectedCellStyle",value:function(){var t=this.selector,e=t.ri,n=t.ci;return this.getCellStyleOrDefault(e,n)}},{key:"setSelectedCellCustomFormatter",value:function(t){this.setSelectedCellAttr("customFormatter",t)}},{key:"clearSelectedCellCustomFormatter",value:function(){this.setSelectedCellAttr("customFormatter",void 0)}},{key:"setCellText",value:function(t,e,n,r){var i=this.rows,o=this.history,a=this.validations,l=i.getCellOrNew(t,e);if("finished"===r){var s="string"==typeof l._origText?l._origText:"";delete l._origText,i.setCellText(t,e,s),s!==n&&o.add(this.getData()),i.setCellText(t,e,n)}else"string"!=typeof l._origText&&(l._origText=l.text||""),i.setCellText(t,e,n),this.change(this.getData());a.validate(t,e,n)}},{key:"freezeIsActive",value:function(){var t=at(this.freeze,2),e=t[0],n=t[1];return e>0||n>0}},{key:"setFreeze",value:function(t,e){var n=this;this.changeData(function(){n.freeze=[t,e]})}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(t,e){var n=this;this.changeData(function(){n.rows.setHeight(t,e)})}},{key:"setColWidth",value:function(t,e){var n=this;this.changeData(function(){n.cols.setWidth(t,e)})}},{key:"viewHeight",value:function(){var t=this.settings,e=t.view,n=t.showToolbar,r=t.showBottomBar,i=t.formulaBar,o=e.height();return r&&(o-=41),n&&(o-=41),"belowToolbar"===i.location&&(o-=30),o}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var t=at(this.freeze,2),e=t[0],n=t[1];return new v(0,0,e-1,n-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"contentRange",value:function(){var t=this.rows,e=this.cols,n=at(t.maxCell(),2),r=n[0],i=n[1],o=t.sumHeight(0,r+1),a=e.sumWidth(0,i+1);return new v(0,0,r,i,a,o)}},{key:"exceptRowTotalHeight",value:function(t,e){var n=this.exceptRowSet,r=this.rows,i=Array.from(n),o=0;return i.forEach(function(n){if(n<t||n>e){var i=r.getHeight(n);o+=i}}),o}},{key:"viewRange",value:function(){var t=this.scroll,e=this.rows,n=this.cols,r=this.freeze,i=this.exceptRowSet,o=t.ri,a=t.ci;o<=0&&(o=at(r,1)[0]);a<=0&&(a=at(r,2)[1]);for(var l=0,s=0,c=[e.len,n.len],u=c[0],f=c[1],h=o;h<e.len&&(i.has(h)||(s+=e.getHeight(h),u=h),!(s>this.viewHeight()));h+=1);for(var d=a;d<n.len&&(f=d,!((l+=n.getWidth(d))>this.viewWidth()));d+=1);return new v(o,a,u,f,l,s)}},{key:"eachMergesInView",value:function(t,e){this.merges.filterIntersects(t).forEach(function(t){return e(t)})}},{key:"hideRowsOrCols",value:function(){var t=this.rows,e=this.cols,n=this.selector,r=at(n.size(),2),i=r[0],o=r[1],a=n.range,l=a.sri,s=a.sci,c=a.eri,u=a.eci;if(i===t.len)for(var f=s;f<=u;f+=1)e.setHide(f,!0);else if(o===e.len)for(var h=l;h<=c;h+=1)t.setHide(h,!0)}},{key:"unhideRowsOrCols",value:function(t,e){this["".concat(t,"s")].unhide(e)}},{key:"rowEach",value:function(t,e,n){for(var r=0,i=this.rows,o=this.exceptRowSet,a=it(o),l=0,s=0;s<a.length;s+=1)a[s]<t&&(l+=1);for(var c=t+l;c<=e+l;c+=1)if(o.has(c))l+=1;else{var u=i.getHeight(c);if(u>0&&(n(c,r,u),(r+=u)>this.viewHeight()))break}}},{key:"colEach",value:function(t,e,n){for(var r=0,i=this.cols,o=t;o<=e;o+=1){var a=i.getWidth(o);if(a>0&&(n(o,r,a),(r+=a)>this.viewWidth()))break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(t,e){var n=this.styles;if(!e)for(var r=0;r<n.length;r+=1){var i=n[r];if(D.equals(i,t))return r}return n.push(t),n.length-1}},{key:"changeData",value:function(t){this.history.add(this.getData()),t(),this.change(this.getData())}},{key:"setData",value:function(t){var e=this;return Object.keys(t).forEach(function(n){if("merges"===n||"rows"===n||"cols"===n||"validations"===n)e[n].setData(t[n]);else if("freeze"===n){var r=at(f(t[n]),2),i=r[0],o=r[1];e.freeze=[o,i]}else"autofilter"===n?e.autoFilter.setData(t[n]):void 0!==t[n]&&(e[n]=t[n])}),this}},{key:"getData",value:function(){var t=this.name,e=this.freeze,n=this.styles,r=this.merges,i=this.rows,o=this.cols,a=this.validations,l=this.autoFilter;return{name:t,freeze:h(e[1],e[0]),styles:n,merges:r.getData(),rows:i.getData(),cols:o.getData(),validations:a.getData(),autofilter:l.getData()}}}])&&ot(e.prototype,n),r&&ot(e,r),t}();function dt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function pt(t,e,n){t.addEventListener(e,n)}function yt(t,e,n){t.removeEventListener(e,n)}function vt(t){t.xclickoutside&&(yt(window.document.body,"click",t.xclickoutside),delete t.xclickoutside)}function gt(t,e){t.xclickoutside=function(n){2===n.detail||t.contains(n.target)||(e?e(t):(t.hide(),vt(t)))},pt(window.document.body,"click",t.xclickoutside)}function bt(t,e,n){pt(t,"mousemove",e),t.xEvtUp=function(r){yt(t,"mousemove",e),yt(t,"mouseup",t.xEvtUp),n(r)},pt(t,"mouseup",t.xEvtUp)}function mt(t,e,n,r){Math.abs(t)>Math.abs(e)?r(t>0?"right":"left",t,n):r(e>0?"down":"up",e,n)}var wt="x-spreadsheet";window.devicePixelRatio;function kt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xt=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1?arguments[1]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.moving=!1,this.vertical=n,this.el=a("div","".concat(wt,"-resizer ").concat(n?"vertical":"horizontal")).children(this.unhideHoverEl=a("div","".concat(wt,"-resizer-hover")).on("dblclick.stop",function(t){return e.mousedblclickHandler(t)}).css("position","absolute").hide(),this.hoverEl=a("div","".concat(wt,"-resizer-hover")).on("mousedown.stop",function(t){return e.mousedownHandler(t)}),this.lineEl=a("div","".concat(wt,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=r,this.unhideFn=function(){}}var e,n,r;return e=t,(n=[{key:"showUnhide",value:function(t){this.unhideIndex=t,this.unhideHoverEl.show()}},{key:"hideUnhide",value:function(){this.unhideHoverEl.hide()}},{key:"show",value:function(t,e){var n=this.moving,r=this.vertical,i=this.hoverEl,o=this.lineEl,a=this.el,l=this.unhideHoverEl;if(!n){this.cRect=t;var s=t.left,c=t.top,u=t.width,f=t.height;a.offset({left:r?s+u-5:s,top:r?c:c+f-5}).show(),i.offset({width:r?5:u,height:r?f:5}),o.offset({width:r?0:e.width,height:r?e.height:0}),l.offset({left:r?5-u:s,top:r?c:5-f,width:r?5:u,height:r?f:5})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}},{key:"mousedblclickHandler",value:function(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}},{key:"mousedownHandler",value:function(t){var e=this,n=t,r=this.el,i=this.lineEl,o=this.cRect,a=this.vertical,l=this.minDistance,s=a?o.width:o.height;i.show(),bt(window,function(t){e.moving=!0,null!==n&&1===t.buttons&&(a?(s+=t.movementX)>l&&r.css("left","".concat(o.left+s,"px")):(s+=t.movementY)>l&&r.css("top","".concat(o.top+s,"px")),n=t)},function(){n=null,i.hide(),e.moving=!1,e.hide(),e.finishedFn&&(s<l&&(s=l),e.finishedFn(o,s))})}}])&&kt(e.prototype,n),r&&kt(e,r),t}();function Ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var St=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertical=e,this.moveFn=null,this.el=a("div","".concat(wt,"-scrollbar ").concat(e?"vertical":"horizontal")).child(this.contentEl=a("div","")).on("mousemove.stop",function(){}).on("scroll.stop",function(t){var e=t.target,r=e.scrollTop,i=e.scrollLeft;n.moveFn&&n.moveFn(n.vertical?r:i,t)})}var e,n,r;return e=t,(n=[{key:"move",value:function(t){return this.el.scroll(t),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(t,e){var n=t-1;if(e>n){var r=this.vertical?"height":"width";this.el.css(r,"".concat(n-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(r,"".concat(e,"px"))}else this.el.isHidden()||(this.move({left:0,top:0}),this.el.hide());return this}}])&&Ot(e.prototype,n),r&&Ot(e,r),t}();function Et(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ct(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jt(t,e,n){return e&&Ct(t.prototype,e),n&&Ct(t,n),t}var _t=10,Tt=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Et(this,t),this.useHideInput=n,this.autoFocus=r,this.inputChange=function(){},this.cornerEl=a("div","".concat(wt,"-selector-corner")),this.areaElFirst=a("div","".concat(wt,"-selector-area-first")),this.areaEl=a("div","".concat(wt,"-selector-area")).child(this.cornerEl).child(this.areaElFirst).hide(),this.clipboardEl=a("div","".concat(wt,"-selector-clipboard")).hide(),this.autofillEl=a("div","".concat(wt,"-selector-autofill")).hide(),this.el=a("div","".concat(wt,"-selector")).css("z-index","".concat(_t)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),n&&(this.hideInput=a("input","").on("compositionend",function(t){e.inputChange(t.target.value)}),this.el.child(this.hideInputDiv=a("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=a("div","hide-input").child(this.hideInput))),_t+=1}return jt(t,[{key:"setOffset",value:function(t){return this.el.offset(t).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(t,e){var n=t.left,r=t.top,i={width:t.width-3+.8,height:t.height-3+.8,left:n-.8,top:r-.8},o={width:e.width-3+.8,height:e.height-3+.8,left:e.left-n,top:e.top-r};this.areaElFirst.offset(o),this.areaEl.offset(i).show(),this.useHideInput&&(this.hideInputDiv.offset(i),this.autoFocus?this.hideInput.val("").focus():this.hideInput.val(""))}},{key:"focus",value:function(){this.hideInput&&this.hideInput.focus()}},{key:"setClipboardOffset",value:function(t){var e=t.left,n=t.top,r=t.width,i=t.height;this.clipboardEl.offset({left:e,top:n,width:r-5,height:i-5})}},{key:"showAutofill",value:function(t){var e=t.left,n=t.top,r=t.width,i=t.height;this.autofillEl.offset({width:r-3,height:i-3,left:e,top:n}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),t}();function At(t){var e=this.data,n=t.left,r=t.top,i=t.width,o=t.height,a=t.scroll,l=t.l,s=t.t,c=e.freezeTotalWidth(),u=e.freezeTotalHeight(),f=n-c;c>l&&(f-=a.x);var h=r-u;return u>s&&(h-=a.y),{left:f,top:h,width:i,height:o}}function Pt(t){var e=this.data,n=t.left,r=t.width,i=t.height,o=t.l,a=t.t,l=t.scroll,s=e.freezeTotalWidth(),c=n-s;return s>o&&(c-=l.x),{left:c,top:a,width:r,height:i}}function Rt(t){var e=this.data,n=t.top,r=t.width,i=t.height,o=t.l,a=t.t,l=t.scroll,s=e.freezeTotalHeight(),c=n-s;return s>a&&(c-=l.y),{left:o,top:c,width:r,height:i}}function It(t,e){this.br.setAreaOffset(At.call(this,t),At.call(this,e))}function Ft(t,e){this.t.setAreaOffset(Pt.call(this,t),Pt.call(this,e))}function Dt(t,e){this.l.setAreaOffset(Rt.call(this,t),Rt.call(this,e))}function zt(t){this.l.setClipboardOffset(Rt.call(this,t))}function Ht(t){this.br.setClipboardOffset(At.call(this,t))}function Mt(t){this.t.setClipboardOffset(Pt.call(this,t))}function Nt(t,e){It.call(this,t,e),function(t,e){this.tl.setAreaOffset(t,e)}.call(this,t,e),Ft.call(this,t,e),Dt.call(this,t,e)}function Bt(t){Ht.call(this,t),function(t){this.tl.setClipboardOffset(t)}.call(this,t),Mt.call(this,t),zt.call(this,t)}var Wt=function(){function t(e){var n=this;Et(this,t);var r=e.settings.autoFocus;this.inputChange=function(){},this.data=e,this.br=new Tt(!0,r),this.t=new Tt,this.l=new Tt,this.tl=new Tt,this.br.inputChange=function(t){n.inputChange(t)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=a("div","".concat(wt,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,_t+=1}return jt(t,[{key:"focus",value:function(){this.br.focus()}},{key:"resetData",value:function(t){this.data=t,this.range=t.selector.range,this.resetAreaOffset()}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var t=this.data,e=this.tl,n=this.t,r=this.l,i=this.br,o=t.freezeTotalHeight(),a=t.freezeTotalWidth();o>0||a>0?(e.setOffset({width:a,height:o}),n.setOffset({left:a,height:o}),r.setOffset({top:o,width:a}),i.setOffset({left:a,top:o})):(e.hide(),n.hide(),r.hide(),i.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getFirstSelectedCellRect(),n=this.data.getClipboardRect();Nt.call(this,t,e),Bt.call(this,n),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getFirstSelectedCellRect(),n=this.data.getClipboardRect();It.call(this,t,e),Ft.call(this,t,e),Ht.call(this,n),Mt.call(this,n),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getFirstSelectedCellRect(),n=this.data.getClipboardRect();It.call(this,t,e),Dt.call(this,t,e),Ht.call(this,n),zt.call(this,n),this.resetOffset()}},{key:"set",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.data,i=r.calSelectedRangeByStart(t,e),o=i.sri,a=i.sci;if(n){var l=t,s=e;t<0&&(l=0),e<0&&(s=0),r.selector.setIndexes(l,s),this.indexes=[l,s]}this.moveIndexes=[o,a],this.range=i,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.data,o=this.lastri,a=this.lastci;if(n){if(t===o&&e===a)return;this.lastri=t,this.lastci=e}this.range=i.calSelectedRangeByEnd(t,e,r),Nt.call(this,this.data.getSelectedRect(),this.data.getFirstSelectedCellRect())}},{key:"reset",value:function(){var t=this.data.selector.range,e=t.eri,n=t.eci;this.setEnd(e,n)}},{key:"showAutofill",value:function(t,e){if(-1!==t||-1!==e){var n=this.range,r=n.sri,i=n.sci,o=n.eri,a=n.eci,l=t,s=e,c=r-t,u=o-t,f=a-e;if(i-e>0)this.arange=new v(r,s,o,i-1);else if(c>0)this.arange=new v(l,i,r-1,a);else if(f<0)this.arange=new v(r,a+1,o,s);else{if(!(u<0))return void(this.arange=null);this.arange=new v(o+1,i,l,a)}if(null!==this.arange){var h=this.data.getRect(this.arange);h.width+=2,h.height+=2;var d=this.br,p=this.l,y=this.t,g=this.tl;d.showAutofill(At.call(this,h)),p.showAutofill(Rt.call(this,h)),y.showAutofill(Pt.call(this,h)),g.showAutofill(h)}}}},{key:"hideAutofill",value:function(){var t=this;["br","l","t","tl"].forEach(function(e){t[e].hideAutofill()})}},{key:"showClipboard",value:function(){var t=this,e=this.data.getClipboardRect();Bt.call(this,e),["br","l","t","tl"].forEach(function(e){t[e].showClipboard()})}},{key:"hideClipboard",value:function(){var t=this;["br","l","t","tl"].forEach(function(e){t[e].hideClipboard()})}}]),t}();function Vt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qt(t){t.preventDefault();var e=this.filterItems;e.length<=0||(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}var Kt=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"200px",i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterItems=[],this.items=e,this.el=a("div","".concat(wt,"-suggest")).css("width",r).hide(),this.itemClick=n,this.itemIndex=-1,this.disabled=i}var e,n,r;return e=t,(n=[{key:"setOffset",value:function(t){this.el.cssRemoveKeys("top","bottom").offset(t)}},{key:"hide",value:function(){if(!this.disabled){var t=this.el;this.filterItems=[],this.itemIndex=-1,t.hide(),vt(this.el.parent())}}},{key:"setItems",value:function(t){this.items=t}},{key:"search",value:function(t){var e,n=this;if(!this.disabled){var r=this.items;if(/^\s*$/.test(t)||(r=r.filter(function(e){return(e.key||e).startsWith(t.toUpperCase())})),r=r.map(function(t){var e=t.title;e?"function"==typeof e&&(e=e()):e=t;var r=a("div","".concat(wt,"-item")).child(e).on("click.stop",function(){n.itemClick(t),n.hide()});return t.label&&r.child(a("div","label").html(t.label)),r}),this.filterItems=r,!(r.length<=0)){var i=this.el;(e=i.html("")).children.apply(e,Vt(r)).show(),gt(i.parent(),function(){n.hide()})}}}},{key:"bindInputEvents",value:function(t){var e=this;t.on("keydown",function(t){return function(t){var e=t.keyCode;switch(t.ctrlKey&&t.stopPropagation(),e){case 37:t.stopPropagation();break;case 38:(function(t){t.preventDefault(),t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=e.length-1),e[this.itemIndex].toggle())}).call(this,t);break;case 39:t.stopPropagation();break;case 40:(function(t){t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>e.length-1&&(this.itemIndex=0),e[this.itemIndex].toggle())}).call(this,t);break;case 13:case 9:qt.call(this,t);break;default:t.stopPropagation()}}.call(e,t)})}}])&&Lt(e.prototype,n),r&&Lt(e,r),t}();function $t(t){return($t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yt(t,e){return!e||"object"!==$t(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zt(t){return(Zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xt(t,e){return(Xt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Yt(this,Zt(e).call(this,"div","".concat(wt,"-icon")))).iconNameEl=a("div","".concat(wt,"-icon-img ").concat(t)),n.child(n.iconNameEl),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xt(t,e)}(e,o),n=e,(r=[{key:"setName",value:function(t){this.iconNameEl.className("".concat(wt,"-icon-img ").concat(t))}}])&&Ut(n.prototype,r),i&&Ut(n,i),e}();function Gt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Qt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function te(t,e){t.setMonth(t.getMonth()+e)}function ee(t,e){var n=new Date(t);return n.setDate(e-t.getDay()+1),n}var ne=function(){function t(e){var n,r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=e,this.cvalue=new Date(e),this.headerLeftEl=a("div","calendar-header-left"),this.bodyEl=a("tbody",""),this.buildAll(),this.el=a("div","x-spreadsheet-calendar").children(a("div","calendar-header").children(this.headerLeftEl,a("div","calendar-header-right").children(a("a","calendar-prev").on("click.stop",function(){return r.prev()}).child(new Jt("chevron-left")),a("a","calendar-next").on("click.stop",function(){return r.next()}).child(new Jt("chevron-right")))),a("table","calendar-body").children(a("thead","").child((n=a("tr","")).children.apply(n,Gt(q("calendar.weeks").map(function(t){return a("th","cell").child(t)})))),this.bodyEl)),this.selectChange=function(){}}var e,n,r;return e=t,(n=[{key:"setValue",value:function(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}},{key:"prev",value:function(){te(this.value,-1),this.buildAll()}},{key:"next",value:function(){te(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var t=this.value;this.headerLeftEl.html("".concat(q("calendar.months")[t.getMonth()]," ").concat(t.getFullYear()))}},{key:"buildBody",value:function(){var t,e=this,n=this.value,r=this.cvalue,i=this.bodyEl,o=function(t,e,n){for(var r=new Date(t,e,1,23,59,59),i=[[],[],[],[],[],[]],o=0;o<6;o+=1)for(var a=0;a<7;a+=1){var l=ee(r,7*o+a),s=l.getMonth()!==e,c=l.getMonth()===n.getMonth()&&l.getDate()===n.getDate();i[o][a]={d:l,disabled:s,active:c}}return i}(n.getFullYear(),n.getMonth(),r).map(function(t){var n,r=t.map(function(t){var n="cell";return t.disabled&&(n+=" disabled"),t.active&&(n+=" active"),a("td","").child(a("div",n).on("click.stop",function(){e.selectChange(t.d)}).child(t.d.getDate().toString()))});return(n=a("tr","")).children.apply(n,Gt(r))});(t=i.html("")).children.apply(t,Gt(o))}}])&&Qt(e.prototype,n),r&&Qt(e,r),t}();function re(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ie=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.calendar=new ne(new Date),this.el=a("div","".concat(wt,"-datepicker")).child(this.calendar.el).hide()}var e,n,r;return e=t,(n=[{key:"setValue",value:function(t){var e=this.calendar;return"string"==typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}},{key:"change",value:function(t){var e=this;this.calendar.selectChange=function(n){t(n),e.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&re(e.prototype,n),r&&re(e,r),t}();function oe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ae(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function le(){var t=this.inputText;if(!/^\s*$/.test(t)){var e=this.textlineEl,n=this.textEl,r=this.areaOffset,i=t.split("\n"),o=Math.max.apply(Math,ae(i.map(function(t){return t.length}))),a=e.offset().width/t.length,l=(o+1)*a+5,s=this.viewFn().width-r.left-a,c=i.length;if(l>r.width){var u=l;l>s&&(u=s,c+=parseInt(l/s,10),c+=l%s>0?1:0),n.css("width","".concat(u,"px"))}(c*=this.rowHeight)>r.height&&n.css("height","".concat(c,"px"))}}function se(t){var e=this,n=t.keyCode,r=t.altKey,i=t.shiftKey;this.checkChooserTrigger(t);var o=!this.preventArrowExit;if(38!==n&&40!==n){if(37===n||39===n){if(o)return this.clear(),void(this.moveCursorFn&&this.moveCursorFn(37===n?-1:1,i,!0));setTimeout(function(){e.toggleChooserHint()},0)}13!==n&&9!==n&&t.stopPropagation(),13===n&&i&&(function(t,e){var n=t.target,r=n.value,i=n.selectionEnd,o="".concat(r.slice(0,i)).concat(e).concat(r.slice(i));n.value=o,n.setSelectionRange(i+1,i+1),this.inputText=o,this.textlineEl.html(o),le.call(this)}.call(this,t,"\n"),t.stopPropagation()),13!==n||r||t.preventDefault(),27===n&&(this.inputText=this.initialText,this.change("input",this.inputText),this.clear())}else o?(this.clear(),this.moveCursorFn&&this.moveCursorFn(38===n?-1:1,i,!1)):t.stopImmediatePropagation()}function ce(t,e,n){var r=this.textEl,i=this.textlineEl;n||r.el.blur(),r.val(t),i.html(t),n||function(t){var e=this,n=this.textEl.el;setTimeout(function(){n.focus(),n.setSelectionRange(t,t),e.toggleChooserHint()},0)}.call(this,e)}var ue=function(){function t(e,n,r,i,o,l,s){var c=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewFn=n,this.rowHeight=r,this.formulas=e,this.moveCursorFn=i,this.choosers=l,this.spreadsheet=s,this.suggest=new Kt(e,function(t){(function(t){var e=this.inputText,n=this.validator,r=0;if(n&&"list"===n.type)this.inputText=t,r=this.inputText.length;else{var i=e.lastIndexOf("="),o=e.substring(0,i+1),a=e.substring(i+1);a=-1!==a.indexOf(")")?a.substring(a.indexOf(")")):"",this.inputText="".concat(o+t.key,"("),r=this.inputText.length,this.inputText+=")".concat(a)}ce.call(this,this.inputText,r)}).call(c,t)},"200px",!o),this.datepicker=new ie,this.datepicker.change(function(t){c.setText(function(t){var e=t.getMonth()+1,n=t.getDate();return e<10&&(e="0".concat(e)),n<10&&(n="0".concat(n)),"".concat(t.getFullYear(),"-").concat(e,"-").concat(n)}(t)),c.clear()}),this.areaEl=a("div","".concat(wt,"-editor-area")).children(this.textEl=a("textarea","").on("input",function(t){return function(t){var e=t.target.value,n=this.suggest,r=this.textlineEl,i=this.validator,o=this.cell;if(null!==o)if("editable"in o&&!0===o.editable||void 0===o.editable){if(this.inputText=e,i)"list"===i.type?n.search(e):n.hide();else{var a=e.lastIndexOf("=");-1!==a?n.search(e.substring(a+1)):n.hide()}this.toggleChooserHint(),r.html(e),le.call(this),this.change("input",e)}else t.target.value=o.text;else{if(this.inputText=e,i)"list"===i.type?n.search(e):n.hide();else{var l=e.lastIndexOf("=");-1!==l?n.search(e.substring(l+1)):n.hide()}this.toggleChooserHint(),r.html(e),le.call(this),this.change("input",e)}}.call(c,t)}).on("paste.stop",function(){}).on("keydown",function(t){return se.call(c,t)}).on("click",function(t){return function(t){this.preventArrowExit=!0,this.toggleChooserHint()}.call(c,t)}),this.textlineEl=a("div","textline"),this.suggest.el,this.datepicker.el,this.htmlFormulaOverlay=a("div","".concat(wt,"-html-formula-overlay"))).on("mousemove.stop",function(){}).on("mousedown.stop",function(){}),this.el=a("div","".concat(wt,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){},this.isOn=!1,this.onClearActions=[]}var e,n,r;return e=t,(n=[{key:"setFreezeLengths",value:function(t,e){this.freeze.w=t,this.freeze.h=e}},{key:"clear",value:function(){this.isOn=!1;var t=!0,e=!1,n=void 0;try{for(var r,i=this.onClearActions[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){(0,r.value)()}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}this.onClearActions=[],""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.initialText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),function(){this.suggest.setItems(this.formulas)}.call(this),this.datepicker.hide(),this.hideChooserHint()}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",n=this.textEl,r=this.areaEl,i=this.suggest,o=this.freeze,a=this.el;if(t){this.areaOffset=t;var l=t.left,s=t.top,c=t.width,u=t.height,f=t.l,h=t.t,d={left:0,top:0};o.w>f&&o.h>h||(o.w<f&&o.h<h?(d.left=o.w,d.top=o.h):o.w>f?d.top=o.h:o.h>h&&(d.left=o.w)),a.offset(d),r.offset({left:l-d.left-.8,top:s-d.top-.8}),n.offset({width:c-10+.8,height:u-5+.8});var p={left:0};p[e]=u,i.setOffset(p),i.hide()}}},{key:"setCell",value:function(t,e,n,r){this.isOn=!0,this.onClearActions=[];var i=this.el,o=this.datepicker,a=this.suggest;i.show(),this.cell=t;var l=t&&t.text||"";if(this.setText(l),this.initialText="string"==typeof n?n:l,this.preventArrowExit=!!r,this.validator=e,e){var s=e.type;"date"===s&&(o.show(),/^\s*$/.test(l)||o.setValue(l)),"list"===s&&(a.setItems(e.values()),a.search(""))}}},{key:"setText",value:function(t,e){this.inputText=t,ce.call(this,t,t.length,e),le.call(this)}},{key:"appendText",value:function(t){this.setText(this.inputText+t)}},{key:"injectText",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=this.inputText.substr(0,e),i=this.inputText.substr(n>=0?n:e);this.setText(r+t+i)}},{key:"getCursorPosition",value:function(){return[this.textEl.el.selectionStart,this.textEl.el.selectionEnd]}},{key:"setCursorPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.textEl.el.selectionStart=t,this.textEl.el.selectionEnd=e>=0?e:t}},{key:"isEnteringFormula",value:function(){return this.inputText&&this.inputText.startsWith("=")}},{key:"toggleChooserHint",value:function(){if(document.activeElement==this.textEl.el){var t=this.inputText,e={start:this.textEl.el.selectionStart,end:this.textEl.el.selectionEnd},n=null,r=null,i=!0,o=!1,a=void 0;try{for(var l,s=this.choosers[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var c=l.value,u=c.getHint.call(this.spreadsheet,t,e);if(!1!==u){n=u,r=c;break}}}catch(t){o=!0,a=t}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}n?this.showChooserHint(n.html,n,r):this.hideChooserHint()}}},{key:"showChooserHint",value:function(t,e,n){this.chooserHintEl||(this.chooserHintEl=a("div","".concat(wt,"-chooser-hint")),this.areaEl.child(this.chooserHintEl)),this.chooserHintEl.el.innerHTML=t,this.currentChooserHint=e,this.currentChooser=n}},{key:"hideChooserHint",value:function(){if(this.chooserHintEl){try{this.areaEl.removeChild(this.chooserHintEl)}catch(t){}try{this.chooserHintEl.el.remove()}catch(t){}this.currentChooser=null,this.currentChooserHint=null,this.chooserHintEl=null}}},{key:"checkChooserTrigger",value:function(t){var e=this;if(this.currentChooser&&this.currentChooserHint.triggers.filter(function(e){return t.keyCode===e.keyCode&&(("boolean"!=typeof e.ctrlOrMeta||t.ctrlKey===e.ctrlOrMeta||t.metaKey===e.ctrlOrMeta)&&(("boolean"!=typeof e.shift||t.shiftKey===e.shift)&&("boolean"!=typeof e.alt||t.altKey===e.alt)))})[0]){var n=this.inputText,r={start:this.textEl.el.selectionStart,end:this.textEl.el.selectionEnd},i=this.currentChooser.onTriggered.call(this.spreadsheet,n,r);i&&i.then(function(t){var n=t.text,r=t.cursorPosition;e.setText(n),e.setCursorPosition(r.start,r.end),setTimeout(function(){e.setCursorPosition(r.start,r.end)},0)})}}},{key:"setFormulaHtml",value:function(t){this.htmlFormulaOverlay.el.innerHTML=t,this.textEl.el.style.color=t?"rgba(0, 0, 0, 0)":""}}])&&oe(e.prototype,n),r&&oe(e,r),t}();function fe(t){return(fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function he(t,e){return!e||"object"!==fe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function de(t){return(de=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pe(t,e){return(pe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ye=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=he(this,de(e).call(this,"div","".concat(wt,"-button ").concat(r)))).child(q("button.".concat(t))),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pe(t,e)}(e,o),e}();function ve(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ge(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function be(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function me(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function we(t,e,n){return e&&me(t.prototype,e),n&&me(t,n),t}function ke(){return window.devicePixelRatio||1}function xe(){return ke()-.5}function Oe(t){return parseInt(t*ke(),10)}function Se(t){return t/ke()}function Ee(t){var e=Oe(t);return e>0?e-.5:.5}var Ce=function(){function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;be(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.padding=o,this.addedExtraWidth=a,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}return we(t,[{key:"setBorders",value:function(t){var e=t.top,n=t.bottom,r=t.left,i=t.right;e&&(this.borderTop=e),i&&(this.borderRight=i),n&&(this.borderBottom=n),r&&(this.borderLeft=r)}},{key:"innerWidth",value:function(){return this.width-2*this.padding-2}},{key:"innerHeight",value:function(){return this.height-2*this.padding-2}},{key:"textx",value:function(t){var e=this.width,n=this.padding,r=this.x;return"left"===t?r+=n:"center"===t?r+=e/2:"right"===t&&(r+=e-n),r}},{key:"texty",value:function(t,e){var n=this.height,r=this.padding,i=this.y;return"top"===t?i+=r:"middle"===t?i+=n/2-e/2:"bottom"===t&&(i+=n-r-e),i}},{key:"topxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t+this.width,e]]}},{key:"rightxys",value:function(){var t=this.x,e=this.y,n=this.width;return[[t+n,e],[t+n,e+this.height]]}},{key:"bottomxys",value:function(){var t=this.x,e=this.y,n=this.width,r=this.height;return[[t,e+r],[t+n,e+r]]}},{key:"leftxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t,e+this.height]]}}]),t}();function je(t,e,n,r,i,o,a){var l={x:0,y:0};"underline"===t?l.y="bottom"===i?0:"top"===i?-(o+2):-o/2:"strike"===t&&("bottom"===i?l.y=o/2:"top"===i&&(l.y=-(o/2+2))),"center"===r?l.x=a/2:"right"===r&&(l.x=a),this.line([e-l.x,n-l.y],[e-l.x+a,n-l.y])}var _e=function(){function t(e,n,r,i,o,a){be(this,t),this.el=e,this.ctx=e.getContext("2d"),this.resize(n,r),this.ctx.scale(ke(),ke()),this.clickableElementFinders=i,this.clickableElementsContainer=o,this.spreadsheet=a}return we(t,[{key:"resize",value:function(t,e){this.el.style.width="".concat(t,"px"),this.el.style.height="".concat(e,"px"),this.el.width=Oe(t),this.el.height=Oe(e)}},{key:"clear",value:function(){var t=this.el,e=t.width,n=t.height;return this.ctx.clearRect(0,0,e,n),this}},{key:"attr",value:function(t){return Object.assign(this.ctx,t),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"clipRect",value:function(t,e,n,r){this.ctx.rect(t,e,n,r),this.ctx.clip()}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(t,e){return this.ctx.translate(Oe(t),Oe(e)),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"clearRect",value:function(t,e,n,r){return this.ctx.clearRect(t,e,n,r),this}},{key:"fillRect",value:function(t,e,n,r){return this.ctx.fillRect(Oe(t)-.5,Oe(e)-.5,Oe(n),Oe(r)),this}},{key:"fillText",value:function(t,e,n){return this.ctx.fillText(t,Oe(e),Oe(n)),this}},{key:"getTextWidth",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e&&(this.ctx.save(),this.attr({font:"".concat(e.italic?"italic":""," ").concat(e.bold?"bold":""," ").concat(Oe(e.size),"px ").concat(e.name)}));var n=this.ctx.measureText(t).width;return e&&this.ctx.restore(),n}},{key:"text",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0,c=arguments.length>8?arguments[8]:void 0,u=arguments.length>9?arguments[9]:void 0,f=arguments.length>10?arguments[10]:void 0,h=arguments.length>11?arguments[11]:void 0,d=this.ctx,p=r.hasAlignSet,y=r.align,v=r.valign,g=r.font,b=r.color,m=r.strike,w=r.underline,k=p||isNaN(t)?y:"right",x=e.textx(k);d.save(),d.beginPath(),this.attr({textBaseline:v,font:"".concat(g.italic?"italic":""," ").concat(g.bold?"bold":""," ").concat(Oe(g.size),"px ").concat(g.name),fillStyle:b,strokeStyle:b});var O="".concat(t).split("\n"),S=e.innerWidth(),E=[];O.forEach(function(t){var e=ge(n.parseClickableElements(t),3),r=(e[0],e[1]),o=e[2],a=n.getTextWidth(r);if(i&&a>Oe(S)){for(var l={w:0,len:0,start:0},s=-1,c=0,u=0;u<r.length;u+=1){if(l.w>=Oe(S)){s>-1&&(l.len=s-l.start,l.w-=c);var f=n.getTextSegments(o,l.start,l.len);E.push(f),s>-1&&(u=s+1,s=-1,c=0),l={w:0,len:0,start:u}}l.len+=1;var h=n.getTextWidth(r[u])+1;l.w+=h,c+=h," "!==r[u]&&"\t"!==r[u]||(s=u,c=0)}if(l.len>0){var d=n.getTextSegments(o,l.start,l.len);E.push(d)}}else E.push(o)});var C=(E.length-1)*(g.size+2);if(i){var j=C+g.size,_=e.innerHeight(),T=e.height;if(j>_){var A=Math.ceil(j-_),P=T+A;h&&h(P)}}var R=e.texty(v,C);return E.forEach(function(t){var r=0,i=[],h=0,d=!0,p=!1,y=void 0;try{for(var b,O=t[Symbol.iterator]();!(d=(b=O.next()).done);d=!0){var S=b.value,E=Se(n.getTextWidth(S.text));i.push(E),h+=E}}catch(t){p=!0,y=t}finally{try{d||null==O.return||O.return()}finally{if(p)throw y}}var C=x;"right"==k?C-=h:"center"==k&&(C-=h/2);var j=function(h){var d=t[h],p=i[h];if(d.el||n.fillText(d.text,C+r,R),m&&je.call(n,"strike",C+r,R,k,v,g.size,p),w&&je.call(n,"underline",C+r,R,k,v,g.size,p),d.el&&n.clickableElementsContainer){var y=document.createElement("div");y.innerHTML='<div class="spreadsheet-trigger-container"><div class="spreadsheet-trigger">'+d.el.finder.render.call(n.spreadsheet,d.text,d.el.data)+"</div></div>",n.clickableElementsContainer.el.appendChild(y.children[0]);var b=n.clickableElementsContainer.el.children[n.clickableElementsContainer.el.children.length-1],x=b.children[0];b.style.width=e.width+"px",b.style.height=e.height+"px";var O=e.x-("frozen-left"===l||"frozen-corner"===l?s:0),S=e.y-("frozen-top"===l||"frozen-corner"===l?c:0);b.style.left=O+"px",b.style.top=S+"px";var E=Math.max(0,o-e.x-("frozen-left"===l?u:0)),j=Math.max(0,a-e.y-("frozen-top"===l?f:0));b.style.clip="rect(".concat(j,"px, 10000px, 10000px, ").concat(E,"px)"),x.style.left=Math.floor(C+r-e.x)+"px";var _=0;"top"==v?_=(g.size+2)/2-1:"bottom"==v&&(_=-(g.size+2)/2+1),x.style.top=Math.floor(R-8-e.y+_)+"px",x.addEventListener("click",function(t){(t.ctrlKey||t.metaKey)&&d.el.finder.onCtrlClick.call(n.spreadsheet,d.el.data)})}r+=p};for(var _ in t)j(_);R+=g.size+2}),d.restore(),this}},{key:"getTextSegments",value:function(t,e,n){var r=[],i=0,o=!0,a=!1,l=void 0;try{for(var s,c=t[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var u=s.value,f=i;i=f+u.text.length;var h=f+u.text.length;if(!(h<e||f>e+n))if(f>=e&&h<=e+n)r.push(u);else if(f>=e&&h>e+n){var d=u.text.length-(h-(e+n)),p=u.text.substr(0,d);p.length>0&&r.push({text:p,el:u.el})}else if(f<e&&h<=e+n){var y=e-f,v=u.text.substr(y);v.length>0&&r.push({text:v,el:u.el})}else if(f<e&&h>e+n){var g=e-f,b=u.text.length-(h-(e+n)),m=u.text.substr(g,b-g);m.length>0&&r.push({text:m,el:u.el})}else;}}catch(t){a=!0,l=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw l}}return r}},{key:"parseClickableElements",value:function(t){if(!this.clickableElementFinders)return[];var e=[],n=[],r=!0,i=!1,o=void 0;try{for(var a,l=function(){var n=a.value,r=n.finder(t);e.push.apply(e,ve(r.map(function(t){return t.finder=n,t})))},s=this.clickableElementFinders[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)l()}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}for(var c=[],u=0;u<e.length;++u)for(var f=e[u],h=0;h<e.length;++h)if(u!==h){var d=e[h];if(f.start>=d.start&&f.start<d.start+d.length){c.push(u);break}}for(var p=c.length-1;p>=0;--p)e.splice(c[p],1);var y=-1;for(var v in e){var g=e[v],b=t.substr(0,g.start),m=t.substr(g.start,g.length),w=t.substr(g.start+g.length),k=y<0?b:b.substr(y);k.length>0&&n.push({text:k}),y=g.start+g.length;var x=" ".repeat(g.extraPreSpaces)+m+" ".repeat(g.extraPostSpaces);x.length>0&&n.push({text:x,el:g}),w.length>0&&parseInt(v)+1===e.length&&n.push({text:w})}0===n.length&&n.push({text:t});var O=n.map(function(t){return t.text}).join("");return[e,O,n]}},{key:"border",value:function(t,e){var n=this.ctx;return n.lineWidth=xe,n.strokeStyle=e,"medium"===t?n.lineWidth=Oe(2)-.5:"thick"===t?n.lineWidth=Oe(3):"dashed"===t?n.setLineDash([Oe(3),Oe(2)]):"dotted"===t?n.setLineDash([Oe(1),Oe(1)]):"double"===t&&n.setLineDash([Oe(2),0]),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){t.beginPath();var e=arguments.length<=0?void 0:arguments[0],n=ge(e,2),r=n[0],i=n[1];t.moveTo(Ee(r),Ee(i));for(var o=1;o<arguments.length;o+=1){var a=o<0||arguments.length<=o?void 0:arguments[o],l=ge(a,2),s=l[0],c=l[1];t.lineTo(Ee(s),Ee(c))}t.stroke()}return this}},{key:"strokeBorders",value:function(t){var e=this.ctx;e.save();var n=t.borderTop,r=t.borderRight,i=t.borderBottom,o=t.borderLeft;n&&(this.border.apply(this,ve(n)),this.line.apply(this,ve(t.topxys()))),r&&(this.border.apply(this,ve(r)),this.line.apply(this,ve(t.rightxys()))),i&&(this.border.apply(this,ve(i)),this.line.apply(this,ve(t.bottomxys()))),o&&(this.border.apply(this,ve(o)),this.line.apply(this,ve(t.leftxys()))),e.restore()}},{key:"dropdown",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-15,o=r+t.height-15;e.save(),e.beginPath(),e.moveTo(Oe(i),Oe(o)),e.lineTo(Oe(i+8),Oe(o)),e.lineTo(Oe(i+4),Oe(o+6)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}},{key:"error",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-1;e.save(),e.beginPath(),e.moveTo(Oe(i-8),Oe(r-1)),e.lineTo(Oe(i),Oe(r-1)),e.lineTo(Oe(i),Oe(r+8)),e.closePath(),e.fillStyle="rgba(255, 0, 0, .65)",e.fill(),e.restore()}},{key:"frozen",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-1;e.save(),e.beginPath(),e.moveTo(Oe(i-8),Oe(r-1)),e.lineTo(Oe(i),Oe(r-1)),e.lineTo(Oe(i),Oe(r+8)),e.closePath(),e.fillStyle="rgba(0, 255, 0, .85)",e.fill(),e.restore()}},{key:"rect",value:function(t,e,n,r){var i=this.ctx,o=t.x,a=t.y,l=t.width,s=t.height,c=t.bgcolor;i.save(),i.beginPath(),i.fillStyle=c||"#fff",i.rect(Ee(o+1)-(r?0:.5),Ee(a+1)-(n?0:.5),Oe(l-2)+0+(r?0:1),Oe(s-2)+0+(n?0:1)),i.clip(),i.fill(),e(),i.restore()}}]),t}(),Te=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],Ae=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function Pe(t){for(var e=0;e<Ae.length;e+=1){var n=Ae[e];if(n.pt===t)return n.px}return t}function Re(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ie(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Fe=[{key:"SUM",title:K("formula.sum"),render:function(t){return t.reduce(function(t,e){return F("+",t,e)},0)}},{key:"AVERAGE",title:K("formula.average"),render:function(t){return t.reduce(function(t,e){return Number(t)+Number(e)},0)/t.length}},{key:"MAX",title:K("formula.max"),render:function(t){return Math.max.apply(Math,Ie(t.map(function(t){return Number(t)})))}},{key:"MIN",title:K("formula.min"),render:function(t){return Math.min.apply(Math,Ie(t.map(function(t){return Number(t)})))}},{key:"IF",title:K("formula._if"),render:function(t){var e=Re(t,3),n=e[0],r=e[1],i=e[2];return n?r:i}},{key:"AND",title:K("formula.and"),render:function(t){return t.every(function(t){return t})}},{key:"OR",title:K("formula.or"),render:function(t){return t.some(function(t){return t})}},{key:"CONCAT",title:K("formula.concat"),render:function(t){return t.join("")}}],De=Fe,ze={};Fe.forEach(function(t){ze[t.key]=t});var He=function(t,e,n){De.push({key:t,title:function(){return e},render:n}),ze[t]=De[De.length-1]};function Me(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ne(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Be=function t(e){for(var n=[],r=[],i=[],o=0,a="",l=[],s="",c=0;c<e.length;c+=1){var u=e.charAt(c);if(" "!==u){if("#"==u&&"#REF"==e.substr(c,4).toUpperCase())r.push('"#REF'),c+=3;else if(u>="a"&&u<="z")i.push(u.toUpperCase());else if(u>="0"&&u<="9"||u>="A"&&u<="Z"||"."===u||"$"==u)i.push(u);else if('"'===u){for(c+=1;'"'!==e.charAt(c)&&c<e.length;)i.push(e.charAt(c)),c+=1;r.push('"'.concat(i.join(""))),i=[]}else if("-"===u&&/[+\-*/,(]/.test(s))i.push(u);else{if("("!==u&&i.length>0&&r.push(i.join("")),")"===u){var d=n.pop();if(2===o)try{var p=Ne(f(r.pop()),2),y=p[0],v=p[1],g=Ne(f(r.pop()),2),b=g[0],m=g[1];if(y<b){var w=[y,b];b=w[0],y=w[1]}if(v<m){var k=[v,m];m=k[0],v=k[1]}for(var x=0,O=b;O<=y;O+=1)for(var S=m;S<=v;S+=1)r.push(h(O,S)),x+=1;r.push([d,x])}catch(t){}else if(1===o||3===o)3===o&&r.push(a),r.push([d,l[l.length-1]]),l.splice(l.length-1,1);else for(;"("!==d&&(We(d)?(r.push([d,l[l.length-1]]),l.splice(l.length-1,1)):r.push(d),!(n.length<=0));)d=n.pop();o=0}else if("="===u||">"===u||"<"===u){var E=e.charAt(c+1);a=u,"="!==E&&"-"!==E||(a+=E,c+=1),o=3}else if(":"===u)o=2;else if(","===u)3===o&&r.push(a),o=1,0===l.length&&l.push(1),l[l.length-1]+=1;else if("("===u)if(i.length>0)n.push(i.join("")),We(i.join(""))&&l.push(1);else{var C=c+1,j=Ve(e,C);if(j>=0){var _=t(e.substring(C,j));c=j,r.push.apply(r,Me(_))}}else{if(n.length>0&&("+"===u||"-"===u)){var T=n[n.length-1];if("("!==T&&r.push(n.pop()),"*"===T||"/"===T)for(;n.length>0&&"("!==(T=n[n.length-1]);)r.push(n.pop())}else if(n.length>0){var A=n[n.length-1];"*"!==A&&"/"!==A||r.push(n.pop())}n.push(u)}i=[]}s=u}}for(i.length>0&&r.push(i.join(""));n.length>0;)r.push(n.pop());return r},We=function(t){return"string"==typeof t&&t in ze},Ve=function(t,e){for(var n=1,r=e;r<t.length;++r){var i=t[r];if(")"===i){if(0===--n)return r}else"("===i&&n++}return-1},Le=function(t,e){var n=Ne(t,1)[0],r=t;if('"'===n)return t.substring(1);var i=1;if("-"===n&&(r=t.substring(1),i=-1),r[0]>="0"&&r[0]<="9")return i*Number(r);var o=Ne(f(r),2),a=e(o[0],o[1]);return 1===i&&"string"==typeof a?""===a?0:a:i*a},qe=function(t,e,n,r,i){var o=!0,a=!1,l=void 0;try{for(var s,c=i[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var u=s.value;if(e.includes(u))return"#ERR"}}catch(t){a=!0,l=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw l}}for(var f=[],h=0;h<e.length;h+=1){var d=e[h],p=d[0];if("+"===d){var y=f.pop();f.push(F("+",f.pop(),y))}else if("-"===d)if(1===f.length){var v=f.pop();f.push(F("*",v,-1))}else{var g=f.pop();f.push(F("-",f.pop(),g))}else if("*"===d)f.push(F("*",f.pop(),f.pop()));else if("/"===d){var b=f.pop();f.push(F("/",f.pop(),b))}else if("="===p||">"===p||"<"===p){var m=f.pop();Number.isNaN(m)||(m=Number(m));var w=f.pop();Number.isNaN(w)||(w=Number(w));var k=!1;"="===p?k=w===m:">"===d?k=w>m:">="===d?k=w>=m:"<"===d?k=w<m:"<="===d&&(k=w<=m),f.push(k)}else if(Array.isArray(d)){for(var x=Ne(d,2),O=x[0],S=x[1],E=[],C=0;C<S;C+=1)E.push(f.pop());try{f.push(n[O].render.call(t,E.reverse()))}catch(t){return"#ERR"}}else{if(i.includes(d))return"#ERR";(p>="a"&&p<="z"||p>="A"&&p<="Z")&&i.push(d),f.push(Le(d,r)),i.pop()}}return"number"==typeof f[0]&&isNaN(f[0])?"#ERR":"string"==typeof f[0]&&(f[0].includes("#ERR")||f[0].includes("NaN"))?"#ERR":"".concat(f[0])};function Ke(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];if("("===r)e.push("(");else if(")"===r&&"("!==e.pop())return!1}return 0===e.length}var $e={render:function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if("="===n[0]){if(!Ke(n))return"#ERR";var a=Be(n.substring(1));return a.length<=0?n:qe(e,a,r,function(n,a){return t(e,i(n,a),r,i,o)},o)}return n}};function Ue(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||Ze(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ye(t){return function(t){if(Array.isArray(t))return t}(t)||Ze(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ze(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}var Xe=function(t){return t},Je=function(t){if(/^(-?\d*.?\d*)$/.test(t)){var e=Ye(Number(t).toFixed(2).toString().split("\\.")),n=e[0],r=e.slice(1);return[n.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")].concat(Ue(r))}return t},Ge=[{key:"normal",title:K("format.normal"),type:"string",render:Xe},{key:"text",title:K("format.text"),type:"string",render:Xe},{key:"number",title:K("format.number"),type:"number",label:"1,000.12",render:Je},{key:"percent",title:K("format.percent"),type:"number",label:"10.12%",render:function(t){return"".concat(t,"%")}},{key:"rmb",title:K("format.rmb"),type:"number",label:"10.00",render:function(t){return"".concat(Je(t))}},{key:"usd",title:K("format.usd"),type:"number",label:"$10.00",render:function(t){return"$".concat(Je(t))}},{key:"eur",title:K("format.eur"),type:"number",label:"10.00",render:function(t){return"".concat(Je(t))}},{key:"date",title:K("format.date"),type:"date",label:"26/09/2008",render:Xe},{key:"time",title:K("format.time"),type:"date",label:"15:59:00",render:Xe},{key:"datetime",title:K("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:Xe},{key:"duration",title:K("format.duration"),type:"date",label:"24:01:00",render:Xe}],Qe={};function tn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function en(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Ge.forEach(function(t){Qe[t.key]=t});var nn=5,rn={fillStyle:"#fff",lineWidth:xe,strokeStyle:"#e6e6e6"};function on(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1;i>=0&&(i=Se(i+2*nn));var o=t.cellRect(e,n,!0,i),a=o.left,l=o.top,s=o.width,c=o.height,u=o.addedExtraWidth;return new Ce(a,l+r,s,c,nn,u)}function an(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"main",c=arguments.length>9?arguments[9]:void 0,u=arguments.length>10?arguments[10]:void 0,f=arguments.length>11?arguments[11]:void 0,h=arguments.length>12?arguments[12]:void 0,d=arguments.length>13?arguments[13]:void 0,p=n.sortedRowMap,y=n.rows,v=n.cols;if(!y.isHide(r)&&!v.isHide(i)){var g=r;p.has(r)&&(g=p.get(r));var b=n.getCell(g,i),m=function(t,e,n){return t.highlightFormulaCells?t.highlightFormulaCells.find(function(t){return t[0]==n&&t[1]==e}):null}(t,r,i);if(null!==b||m){var w=!1;b&&"editable"in b&&!1===b.editable&&(w=!0);var k=n.getCellStyleOrDefault(g,i),x="";b&&(n.settings.evalPaused?x=b.text||"":(x=$e.render(t,b.text||"",ze,function(t,e){return n.getCellTextOrDefault(e,t)}),b._lastRenderedFormula=x),k.customFormatter&&(!k.customFormatter.prepareCellStyle&&n.settings.cellCustomFormatterCreator&&n.settings.cellCustomFormatterCreator(k),k.customFormatter.prepareCellStyle&&k.customFormatter.prepareCellStyle(x,k)));var O=Object.assign({},k.font);O.size=Pe(O.size);var S=on(n,r,i,o,Math.ceil(e.getTextWidth(k&&k.customFormatter&&k.customFormatter.formatCellText?k.customFormatter.formatCellText(x):x,O))),E=on(n,r,i,o,Math.ceil(e.getTextWidth("",O)));if(S.bgcolor=k.bgcolor,void 0!==k.border){var C=S.addedExtraWidth>0,j=Object.assign({},k.border);C&&delete j.right,E.setBorders(j),e.strokeBorders(E)}if(m){var _=["thick",m[2]];E.setBorders({top:_,right:_,bottom:_,left:_}),e.strokeBorders(E)}if(d["".concat(r,"_").concat(i)]={top:S.borderTop?S.borderTop[0]:"none",right:S.borderRight?S.borderRight[0]:"none",bottom:S.borderBottom?S.borderBottom[0]:"none",left:S.borderLeft?S.borderLeft[0]:"none"},null!==b&&(!n.isCellEmpty(x,k)||b.merge)){var T=d["".concat(r-1,"_").concat(i)]?d["".concat(r-1,"_").concat(i)].bottom:"none",A=d["".concat(r,"_").concat(i-1)]?d["".concat(r,"_").concat(i-1)].right:"none";e.rect(S,function(){k.format&&(x=Qe[k.format].render(x)),k.customFormatter&&(!k.customFormatter.formatCellText&&n.settings.cellCustomFormatterCreator&&n.settings.cellCustomFormatterCreator(k),k.customFormatter.formatCellText&&(x=k.customFormatter.formatCellText(x)));var o=Object.assign({},k.font);o.size=Pe(o.size),e.text(x,S,{hasAlignSet:k.hasAlignSet,align:k.align,valign:k.valign,font:o,color:k.color,strike:k.strike,underline:k.underline},k.textwrap,a,l,s,c,u,f,h,function(e){setTimeout(function(){t.sheet.resizeRowAfterClearingEditor(r,e)},0)}),n.validations.getError(r,i)&&e.error(S),w&&e.frozen(S)},"thick"===T,"thick"===A)}}}}function ln(t,e,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"main",l=arguments.length>7?arguments[7]:void 0,s=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,u=arguments.length>10?arguments[10]:void 0,f=this.draw,h=this.data;f.save(),f.translate(n,r).translate(i,o);var d=h.exceptRowSet,p=function(t){var e=d.has(t);if(e){var n=h.rows.getHeight(t);f.translate(0,-n)}return!e},y=h.exceptRowTotalHeight(e.sri,e.eri),v={};f.save(),f.translate(0,-y),e.each(function(e,n){var r=e;h.sortedRowMap.has(e)&&(r=h.sortedRowMap.get(e));var i=h.getCell(r,n);i&&i.text||an(t,f,h,e,n,0,0,0,a,c,u,l,s,v)},function(t){return p(t)}),e.each(function(e,n){var r=e;h.sortedRowMap.has(e)&&(r=h.sortedRowMap.get(e));var i=h.getCell(r,n);i&&i.text&&an(t,f,h,e,n,0,0,0,a,c,u,l,s,v)},function(t){return p(t)}),f.restore();var g=new Set;f.save(),f.translate(0,-y),"main"===a?f.clipRect(Oe(-i+l),Oe(-o+s),Oe(e.w),Oe(e.h)):"frozen-left"===a?f.clipRect(Oe(0),Oe(-o+s),Oe(e.w),Oe(e.h)):"frozen-top"===a&&f.clipRect(Oe(-i+l),Oe(0),Oe(e.w),Oe(e.h)),h.eachMergesInView(e,function(e){var n=e.sri,r=e.sci,p=e.eri;if(d.has(n)){if(!g.has(n)){g.add(n);var y=h.rows.sumHeight(n,p+1);f.translate(0,-y)}}else an(t,f,h,n,r,0,l-i,s-o,a,c,u,l,s,v)}),f.restore(),function(t){var e=this.data,n=this.draw;if(t){var r=e.autoFilter;if(!r.active())return;var i=r.hrange();t.intersects(i)&&i.each(function(t,r){var i=on(e,t,r);n.dropdown(i)})}}.call(this,e),f.restore()}function sn(t,e,n,r){var i=this.draw;i.save(),i.attr({fillStyle:this.spreadsheet.data.settings.cellHeaderStyle.selectedBgcolor}).fillRect(t,e,n,r),i.restore()}function cn(t,e,n,r,i,o){var a=this,l=this.draw,s=this.data,u=e.h,f=e.w,h=o+r,d=i+n;l.save(),l.attr({fillStyle:this.spreadsheet.data.settings.cellHeaderStyle.bgcolor}),"all"!==t&&"left"!==t||l.fillRect(0,h,n,u),"all"!==t&&"top"!==t||l.fillRect(d,0,f,r);var p=s.selector.range,y=p.sri,v=p.sci,g=p.eri,b=p.eci;l.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat(Oe(12),"px ").concat(this.spreadsheet.data.settings.cellHeaderStyle.fontFamily),fillStyle:"#585757",lineWidth:xe(),strokeStyle:"#e6e6e6"}),"all"!==t&&"left"!==t||(s.rowEach(e.sri,e.eri,function(t,e,r){var i=h+e,o=t;l.line([0,i],[n,i]),y<=o&&o<g+1&&sn.call(a,0,i,n,r),l.fillText(o+1,n/2,i+r/2),t>0&&s.rows.isHide(t-1)&&(l.save(),l.attr({strokeStyle:"#c6c6c6"}),l.line([5,i+5],[n-5,i+5]),l.restore())}),l.line([0,u+h],[n,u+h]),l.line([n,h],[n,u+h])),"all"!==t&&"top"!==t||(s.colEach(e.sci,e.eci,function(t,e,n){var i=d+e,o=t;l.line([i,0],[i,r]),v<=o&&o<b+1&&sn.call(a,i,0,n,r),l.fillText(c(o),i+n/2,r/2),t>0&&s.cols.isHide(t-1)&&(l.save(),l.attr({strokeStyle:"#c6c6c6"}),l.line([i+5,5],[i+5,r-5]),l.restore())}),l.line([f+d,0],[f+d,r]),l.line([0,r],[f+d,r])),l.restore()}function un(t,e,n,r,i){var o=t.sri,a=t.sci,l=t.eri,s=t.eci,c=t.w,u=t.h,f=this.draw,h=this.data,d=h.settings;f.save(),f.attr(rn).translate(e+r,n+i),d.showGrid?(h.rowEach(o,l,function(t,e,n){t!==o&&f.line([0,e],[c,e]),t===l&&f.line([0,e+n],[c,e+n])}),h.colEach(a,s,function(t,e,n){t!==a&&f.line([e,0],[e,u]),t===s&&f.line([e+n,0],[e+n,u])}),f.restore()):f.restore()}var fn=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.draw=new _e(e,n.viewWidth(),n.viewHeight(),r.getClickableElementFinders(),i,r),this.data=n,this.spreadsheet=r,this.clickableElementsInner=i}var e,n,r;return e=t,(n=[{key:"resetData",value:function(t){this.data=t,this.render()}},{key:"render",value:function(){this.clickableElementsInner.el.innerHTML="";var t=this.data,e=t.rows,n=t.cols.indexWidth,r=e.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();var i=t.viewRange(),o=t.freezeTotalWidth(),a=t.freezeTotalHeight(),l=t.scroll,s=l.x,c=l.y;un.call(this,i,n,r,o,a),ln.call(this,this.spreadsheet,i,n,r,-s,-c,"main",o,a,-s,-c),cn.call(this,"all",i,n,r,o,a),function(t,e){var n=this.draw;n.save(),n.attr({fillStyle:this.spreadsheet.data.settings.cellHeaderStyle.cornerBgcolor}).fillRect(0,0,t,e),n.restore()}.call(this,n,r);var u=tn(t.freeze,2),f=u[0],h=u[1];if(f>0||h>0){if(f>0){var d=i.clone();d.sri=0,d.eri=f-1,d.h=a,un.call(this,d,n,r,o,0),ln.call(this,this.spreadsheet,d,n,r,-s,0,"frozen-top",o,a,-s,-c),cn.call(this,"top",d,n,r,o,0)}if(h>0){var p=i.clone();p.sci=0,p.eci=h-1,p.w=o,un.call(this,p,n,r,0,a),cn.call(this,"left",p,n,r,0,a),ln.call(this,this.spreadsheet,p,n,r,0,-c,"frozen-left",o,a,-s,-c)}var y=t.freezeViewRange();un.call(this,y,n,r,0,0),cn.call(this,"all",y,n,r,0,0),ln.call(this,this.spreadsheet,y,n,r,0,0,"frozen-corner",o,a,-s,-c),function(t,e,n,r){var i=this.draw,o=this.data,a=o.viewWidth()-t,l=o.viewHeight()-e;i.save().translate(t,e).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),i.line([0,r],[a,r]),i.line([n,0],[n,l]),i.restore()}.call(this,n,r,o,a)}}},{key:"clear",value:function(){this.draw.clear()}}])&&en(e.prototype,n),r&&en(e,r),t}();function hn(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function dn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var pn=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],yn=["landscape","portrait"];function vn(t){return parseInt(96*t,10)}function gn(t){"cancel"===t?this.el.hide():this.toPrint()}var bn=function(){function t(e,n){var r,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.paper={w:vn(pn[0][1]),h:vn(pn[0][2]),padding:50,orientation:yn[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=e,this.spreadsheet=n,this.el=a("div","".concat(wt,"-print")).children(a("div","".concat(wt,"-print-bar")).children(a("div","-title").child("Print settings"),a("div","-right").children(a("div","".concat(wt,"-buttons")).children(new ye("cancel").on("click",gn.bind(this,"cancel")),new ye("next","primary").on("click",gn.bind(this,"next"))))),a("div","".concat(wt,"-print-content")).children(this.contentEl=a("div","-content"),a("div","-sider").child(a("form","").children(a("fieldset","").children(a("label","").child("".concat(q("print.size"))),(r=a("select","")).children.apply(r,hn(pn.map(function(t,e){return a("option","").attr("value",e).child("".concat(t[0]," ( ").concat(t[1],"''x").concat(t[2],"'' )"))}))).on("change",function(t){var e=this.paper,n=t.target.value,r=pn[n];e.w=vn(r[1]),e.h=vn(r[2]),this.preview()}.bind(this))),a("fieldset","").children(a("label","").child("".concat(q("print.orientation"))),(i=a("select","")).children.apply(i,hn(yn.map(function(t,e){return a("option","").attr("value",e).child("".concat(q("print.orientations")[e]))}))).on("change",function(t){var e=this.paper,n=t.target.value,r=yn[n];e.orientation=r,this.preview()}.bind(this))))))).hide()}var e,n,r;return e=t,(n=[{key:"resetData",value:function(t){this.data=t}},{key:"preview",value:function(){var t=this,e=this.data,n=this.paper,r=n.width,i=n.height,o=n.padding,l=r-2*o,s=i-2*o,c=e.contentRange(),u=parseInt(c.h/s,10)+1,f=l/c.w,h=o,d=o;f>1&&(h+=(l-c.w)/2);var p=0,y=0;this.contentEl.html(""),this.canvases=[];for(var v={sri:0,sci:0,eri:0,eci:0},g=function(n){var o=0,l=0,u=a("div","".concat(wt,"-canvas-card")),g=a("canvas","".concat(wt,"-canvas"));t.canvases.push(g.el);var b=new _e(g.el,r,i);for(b.save(),b.translate(h,d),f<1&&b.scale(f,f);p<=c.eri;p+=1){var m=e.rows.getHeight(p);if(!((o+=m)<s)){l=-(o-m);break}for(var w=0;w<=c.eci;w+=1)an(t.spreadsheet,b,e,p,w,y),v.eci=w}v.eri=p,b.restore(),b.save(),b.translate(h,d),f<1&&b.scale(f,f);var k=y;e.eachMergesInView(v,function(n){var r=n.sri,i=n.sci;an(t.spreadsheet,b,e,r,i,k)}),b.restore(),v.sri=v.eri,v.sci=v.eci,y+=l,t.contentEl.child(a("div","".concat(wt,"-canvas-card-wraper")).child(u.child(g)))},b=0;b<u;b+=1)g();this.el.show()}},{key:"toPrint",value:function(){this.el.hide();var t=this.paper,e=a("iframe","").hide().el;window.document.body.appendChild(e);var n=e.contentWindow,r=n.document,i=document.createElement("style");i.innerHTML="\n      @page { size: ".concat(t.width,"px ").concat(t.height,"px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    "),r.head.appendChild(i),this.canvases.forEach(function(t){var e=t.cloneNode(!1);e.getContext("2d").drawImage(t,0,0),r.body.appendChild(e)}),n.print()}}])&&dn(e.prototype,n),r&&dn(e,r),t}();function mn(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function wn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var kn=[{key:"copy",title:K("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:K("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:K("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:K("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:K("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row-before",title:K("contextmenu.insertRowBefore")},{key:"insert-row-after",title:K("contextmenu.insertRowAfter")},{key:"insert-rows-before",title:K("contextmenu.insertRowsBefore")},{key:"insert-rows-after",title:K("contextmenu.insertRowsAfter")},{key:"insert-column-before",title:K("contextmenu.insertColumnBefore")},{key:"insert-column-after",title:K("contextmenu.insertColumnAfter")},{key:"insert-columns-before",title:K("contextmenu.insertColumnsBefore")},{key:"insert-columns-after",title:K("contextmenu.insertColumnsAfter")},{key:"divider"},{key:"delete-row",title:K("contextmenu.deleteRow")},{key:"delete-rows",title:K("contextmenu.deleteRows")},{key:"delete-column",title:K("contextmenu.deleteColumn")},{key:"delete-columns",title:K("contextmenu.deleteColumns")},{key:"delete-cell-text",title:K("contextmenu.deleteCellText")},{key:"hide",title:K("contextmenu.hide")},{key:"divider"},{key:"reset-row-height",title:K("contextmenu.resetRowHeight")},{key:"reset-column-width",title:K("contextmenu.resetColumnWidth")},{key:"divider"},{key:"validation",title:K("contextmenu.validation")},{key:"divider"},{key:"cell-printable",title:K("contextmenu.cellprintable")},{key:"cell-non-printable",title:K("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:K("contextmenu.celleditable")},{key:"cell-non-editable",title:K("contextmenu.cellnoneditable")}];function xn(t){var e=this,n=[].concat(kn);if(t&&t.length>0){n.push({key:"divider"});var r=!0,i=!1,o=void 0;try{for(var l,s=t[Symbol.iterator]();!(r=(l=s.next()).done);r=!0){var c=l.value;n.push(c)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}return this.contextMenuOptions&&this.contextMenuOptions.itemsCallback&&this.contextMenuOptions.itemsCallback(n),n.map(function(t){return function(t){var e=this,n=null;return(n="divider"===t.key?a("div","".concat(wt,"-item divider")):a("div","".concat(wt,"-item")).on("click",function(){t.callback&&t.callback(e.targetRange),e.itemClick(t.key),e.hide()}).children(t.title(),a("div","label").child(t.label||""))).attr("data-key",t.key),n.key=t.key,n}.call(e,t)})}var On=function(){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.contextMenuOptions=o,this.menuItems=xn.call(this,o.extraItems),this.el=(n=a("div","".concat(wt,"-contextmenu"))).children.apply(n,mn(this.menuItems)).hide(),this.viewFn=e,this.itemClick=function(){},this.isHide=r,this.isHideForRange=i,this.setTargetRange({sci:0,eci:0,sri:0,eri:0})}var e,n,r;return e=t,(n=[{key:"setTargetRange",value:function(t){this.targetRange=t;var e=this.getItemByKey("hide"),n="range";t.sci<0?n="row":t.sri<0&&(n="col"),this.mode=n,"range"===n?(this.isHideForRange&&this.hide(),e&&e.hide()):e&&e.show();var r=!0,i=!1,o=void 0;try{for(var a,l=this.contextMenuOptions.extraItems[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var s=a.value,c=s.isVisibleCallback(t);this.toggleShowElements([this.getItemByKey(s.key)],c)}}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}this.toggleShowSingleColumnElements(t.sci>=0&&t.sci===t.eci),this.toggleShowMultiColumnElements(t.sci>=0&&t.sci!==t.eci),this.toggleShowSingleRowElements(t.sri>=0&&t.sri===t.eri),this.toggleShowMultiRowElements(t.sri>=0&&t.sri!==t.eri),this.toggleShowElements([this.getItemByKey("reset-column-width")],t.sci>=0),this.toggleShowElements([this.getItemByKey("reset-row-height")],t.sri>=0);var u=!0,f=!1,h=void 0;try{for(var d,p=this.menuItems[Symbol.iterator]();!(u=(d=p.next()).done);u=!0){var y=d.value;"divider"===y.key&&y.show()}}catch(t){f=!0,h=t}finally{try{u||null==p.return||p.return()}finally{if(f)throw h}}for(var v=!1,g=0;g<this.menuItems.length;++g){var b=this.menuItems[g];"divider"===b.key?(v||b.hide(),v=!1):v=v||!b.isHidden()}v=!1;for(var m=this.menuItems.length-1;m>0;--m){var w=this.menuItems[m];"divider"===w.key?(v||w.hide(),v=!1):v=v||!w.isHidden()}}},{key:"getItemByKey",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.menuItems[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;if(a.key===t)return a}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return null}},{key:"toggleShowSingleColumnElements",value:function(t){var e=[this.getItemByKey("delete-column"),this.getItemByKey("insert-column-before"),this.getItemByKey("insert-column-after")];this.toggleShowElements(e,t)}},{key:"toggleShowMultiColumnElements",value:function(t){var e=[this.getItemByKey("delete-columns"),this.getItemByKey("insert-columns-before"),this.getItemByKey("insert-columns-after")];this.toggleShowElements(e,t)}},{key:"toggleShowSingleRowElements",value:function(t){var e=[this.getItemByKey("delete-row"),this.getItemByKey("insert-row-before"),this.getItemByKey("insert-row-after")];this.toggleShowElements(e,t)}},{key:"toggleShowMultiRowElements",value:function(t){var e=[this.getItemByKey("delete-rows"),this.getItemByKey("insert-rows-before"),this.getItemByKey("insert-rows-after")];this.toggleShowElements(e,t)}},{key:"toggleShowElements",value:function(t,e){var n=!e,r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var s=a.value;s&&(n?s.hide():s.show())}}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}}},{key:"hide",value:function(){var t=this.el;t.hide(),vt(t)}},{key:"setPosition",value:function(t,e){if(!(this.isHide||this.isHideForRange&&"range"===this.mode)){var n=this.el;if(this.origElements){for(var r=this.el.el,i=r.children.length-1;i>=0;--i)r.removeChild(r.children[i]);for(var o=0;o<this.origElements.length;++o)r.appendChild(this.origElements[o])}this.origElements=this.el.el.querySelectorAll(".x-spreadsheet-item"),this.contextMenuOptions&&this.contextMenuOptions.preShowCallback&&this.contextMenuOptions.preShowCallback(n.el,this.targetRange);var a=n.show().offset().width,l=this.viewFn(),s=l.height/2,c=t;l.width-t<=a&&(c-=a),n.css("left","".concat(c,"px")),e>s?n.css("bottom","".concat(l.height-e,"px")).css("max-height","".concat(e,"px")).css("top","auto"):n.css("top","".concat(e,"px")).css("max-height","".concat(l.height-e,"px")).css("bottom","auto"),gt(n)}}}])&&wn(e.prototype,n),r&&wn(e,r),t}();function Sn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var En=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tip="",e&&(this.tip=q("toolbar.".concat(e.replace(/-[a-z]/g,function(t){return t[1].toUpperCase()})))),n&&(this.tip+=" (".concat(n,")")),this.tag=e,this.shortcut=n,this.value=r,this.el=this.element(),this.change=function(){}}var e,n,r;return e=t,(n=[{key:"element",value:function(){var t=this,e=this.tip;return a("div","".concat(wt,"-toolbar-btn ").concat(wt,"-toolbar-btn--").concat(this.tag)).on("mouseenter",function(e){t.tip&&function(t,e){if(!e.classList.contains("active")){var n=e.getBoundingClientRect(),r=n.left,i=n.top,o=n.width,l=n.height,s=a("div","".concat(wt,"-tooltip")).html(t).show();document.body.appendChild(s.el);var c=s.box();s.css("left","".concat(r+o/2-c.width/2,"px")).css("top","".concat(i+l+2,"px")),pt(e,"mouseleave",function(){document.body.contains(s.el)&&document.body.removeChild(s.el)}),pt(e,"click",function(){document.body.contains(s.el)&&document.body.removeChild(s.el)})}}(t.tip,e.target)}).attr("data-tooltip",e)}},{key:"setState",value:function(){}}])&&Sn(e.prototype,n),r&&Sn(e,r),t}();function Cn(t){return(Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _n(t,e){return!e||"object"!==Cn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tn(t,e,n){return(Tn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=An(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function An(t){return(An=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pn(t,e){return(Pn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),_n(this,An(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pn(t,e)}(e,En),n=e,(r=[{key:"dropdown",value:function(){}},{key:"getValue",value:function(t){return t}},{key:"element",value:function(){var t=this,n=this.tag;return this.dd=this.dropdown(),this.dd.change=function(e){return t.change(n,t.getValue(e))},Tn(An(e.prototype),"element",this).call(this).child(this.dd)}},{key:"setState",value:function(t){t&&(this.value=t,this.dd.setTitle(t))}}])&&jn(n.prototype,r),i&&jn(n,i),e}();function In(t){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Dn(t,e){return!e||"object"!==In(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zn(t){return(zn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hn(t,e){return(Hn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mn=function(t){function e(t,n,r,i){var o,l;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(l=Dn(this,zn(e).call(this,"div","".concat(wt,"-dropdown ").concat(i)))).title=t,l.change=function(){},l.headerClick=function(){},"string"==typeof t?l.title=a("div","".concat(wt,"-dropdown-title")).child(t):r&&l.title.addClass("arrow-left"),l.contentEl=a("div","".concat(wt,"-dropdown-content")).css("width",n).hide();for(var s=arguments.length,c=new Array(s>4?s-4:0),u=4;u<s;u++)c[u-4]=arguments[u];return(o=l).setContentChildren.apply(o,c),l.headerEl=a("div","".concat(wt,"-dropdown-header")),l.headerEl.on("click",function(){"block"!==l.contentEl.css("display")?l.show():l.hide()}).children(l.title,r?a("div","".concat(wt,"-icon arrow-right")).child(a("div","".concat(wt,"-icon-img arrow-down"))):""),l.children(l.headerEl,l.contentEl),l}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hn(t,e)}(e,o),n=e,(r=[{key:"setContentChildren",value:function(){var t;(this.contentEl.html(""),arguments.length>0)&&(t=this.contentEl).children.apply(t,arguments)}},{key:"setTitle",value:function(t){this.title.html(t),this.hide()}},{key:"show",value:function(){var t=this;this.contentEl.show(),this.parent().active(),gt(this.parent(),function(){t.hide()})}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),vt(this.parent())}}])&&Fn(n.prototype,r),i&&Fn(n,i),e}();function Nn(t){return(Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bn(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Wn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Vn(t,e){return!e||"object"!==Nn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ln(t){return(Ln=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qn(t,e){return(qn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Kn=function(t){function e(t,n){var r,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=new Jt("align-".concat(n)),l=t.map(function(t){return(e="align-".concat(t),a("div","".concat(wt,"-item")).child(new Jt(e))).on("click",function(){i.setTitle(t),i.change(t)});var e});return i=Vn(this,(r=Ln(e)).call.apply(r,[this,o,"auto",!0,"bottom-left"].concat(Bn(l))))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qn(t,e)}(e,Mn),n=e,(r=[{key:"setTitle",value:function(t){this.title.setName("align-".concat(t)),this.hide()}}])&&Wn(n.prototype,r),i&&Wn(n,i),e}();function $n(t){return($n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Un(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yn(t,e){return!e||"object"!==$n(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zn(t){return(Zn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xn(t,e){return(Xn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jn=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Yn(this,Zn(e).call(this,"align","",t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xn(t,e)}(e,Rn),n=e,(r=[{key:"dropdown",value:function(){var t=this.value;return new Kn(["left","center","right"],t)}}])&&Un(n.prototype,r),i&&Un(n,i),e}();function Gn(t){return(Gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tr(t,e){return!e||"object"!==Gn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function er(t){return(er=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nr(t,e){return(nr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rr=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),tr(this,er(e).call(this,"valign","",t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nr(t,e)}(e,Rn),n=e,(r=[{key:"dropdown",value:function(){var t=this.value;return new Kn(["top","middle","bottom"],t)}}])&&Qn(n.prototype,r),i&&Qn(n,i),e}();function ir(t){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function or(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ar(t,e){return!e||"object"!==ir(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lr(t,e,n){return(lr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=sr(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function sr(t){return(sr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cr(t,e){return(cr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ur=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ar(this,sr(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cr(t,e)}(e,En),n=e,(r=[{key:"element",value:function(){var t=this,n=this.tag;return lr(sr(e.prototype),"element",this).call(this).child(new Jt(n)).on("click",function(){return t.click()})}},{key:"click",value:function(){this.change(this.tag,this.toggle())}},{key:"setState",value:function(t){this.el.active(t)}},{key:"toggle",value:function(){return this.el.toggle()}},{key:"active",value:function(){return this.el.hasClass("active")}}])&&or(n.prototype,r),i&&or(n,i),e}();function fr(t){return(fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function dr(t,e){return!e||"object"!==fr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pr(t){return(pr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yr(t,e){return(yr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),dr(this,pr(e).call(this,"autofilter"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yr(t,e)}(e,ur),n=e,(r=[{key:"setState",value:function(){}}])&&hr(n.prototype,r),i&&hr(n,i),e}();function gr(t){return(gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function br(t,e){return!e||"object"!==gr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mr(t){return(mr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wr(t,e){return(wr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),br(this,mr(e).call(this,"font-bold","Ctrl+B"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wr(t,e)}(e,ur),e}();function xr(t){return(xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Or(t,e){return!e||"object"!==xr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sr(t){return(Sr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Er(t,e){return(Er=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Or(this,Sr(e).call(this,"font-italic","Ctrl+I"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Er(t,e)}(e,ur),e}();function jr(t){return(jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _r(t,e){return!e||"object"!==jr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tr(t){return(Tr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ar(t,e){return(Ar=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),_r(this,Tr(e).call(this,"strike","Ctrl+U"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ar(t,e)}(e,ur),e}();function Rr(t){return(Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ir(t,e){return!e||"object"!==Rr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fr(t){return(Fr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dr(t,e){return(Dr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ir(this,Fr(e).call(this,"underline","Ctrl+U"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dr(t,e)}(e,ur),e}();function Hr(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Mr=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],Nr=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],Br=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"],Wr=["#445589","#71ae47","#7030a0","#fe0000","#e68f12","#3874ad","#a00000","#000000"];function Vr(t){var e=this;return a("td","").child(a("div","".concat(wt,"-color-palette-cell")).on("click.stop",function(){return e.change(t)}).css("background-color",t))}var Lr=function t(){var e,n,r,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=a("div","".concat(wt,"-color-palette")),this.change=function(){};var o=a("table","").children((e=a("tbody","")).children.apply(e,[(n=a("tr","".concat(wt,"-theme-color-placeholders"))).children.apply(n,Hr(Mr.map(function(t){return Vr.call(i,t)})))].concat(Hr(Nr.map(function(t){var e;return(e=a("tr","".concat(wt,"-theme-colors"))).children.apply(e,Hr(t.map(function(t){return Vr.call(i,t)})))})),[(r=a("tr","".concat(wt,"-standard-colors"))).children.apply(r,Hr(Br.map(function(t){return Vr.call(i,t)})))])));this.el.child(o)};function qr(t){return(qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $r(t,e){return!e||"object"!==qr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ur(t){return(Ur=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yr(t,e){return(Yr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zr=function(t){function e(t,n){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=new Jt(t).css("height","16px").css("border-bottom","3px solid ".concat(n)),o=new Lr;return o.change=function(t){r.setTitle(t),r.change(t)},r=$r(this,Ur(e).call(this,i,"auto",!1,"bottom-left",o.el))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yr(t,e)}(e,Mn),n=e,(r=[{key:"setTitle",value:function(t){this.title.css("border-color",t),this.hide()}}])&&Kr(n.prototype,r),i&&Kr(n,i),e}();function Xr(t){return(Xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jr(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Gr(t,e){return!e||"object"!==Xr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qr(t){return(Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ti(t,e){return(ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ei=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],ni=function(t){function e(t){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=new Jt("line-type"),o=0,l=ei.map(function(e,n){return a("div","".concat(wt,"-item state ").concat(t===e[0]?"checked":"")).on("click",function(){l[o].toggle("checked"),l[n].toggle("checked"),o=n,r.hide(),r.change(e)}).child(a("div","".concat(wt,"-line-type")).html(e[1]))});return r=Gr(this,(n=Qr(e)).call.apply(n,[this,i,"auto",!1,"bottom-left"].concat(Jr(l))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ti(t,e)}(e,Mn),e}();function ri(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ii(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function oi(){var t;return a("table","").child((t=a("tbody","")).children.apply(t,arguments))}function ai(t){var e=this;return a("td","").child(a("div","".concat(wt,"-border-palette-cell")).child(new Jt("border-".concat(t))).on("click",function(){e.mode=t;var n=e.mode,r=e.style,i=e.color;e.change({mode:n,style:r,color:i})}))}var li=function t(){var e,n,r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new Zr("line-color",this.color),this.ddColor.change=function(t){r.color=t},this.ddType=new ni(this.style),this.ddType.change=function(t){var e=ii(t,1)[0];r.style=e},this.el=a("div","".concat(wt,"-border-palette"));var i=oi(a("tr","").children(a("td","".concat(wt,"-border-palette-left")).child(oi((e=a("tr","")).children.apply(e,ri(["all","inside","horizontal","vertical","outside"].map(function(t){return ai.call(r,t)}))),(n=a("tr","")).children.apply(n,ri(["left","top","right","bottom","none"].map(function(t){return ai.call(r,t)}))))),a("td","".concat(wt,"-border-palette-right")).children(a("div","".concat(wt,"-toolbar-btn")).child(this.ddColor.el),a("div","".concat(wt,"-toolbar-btn")).child(this.ddType.el))));this.el.child(i)};function si(t){return(si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ci(t,e){return!e||"object"!==si(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ui(t){return(ui=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fi(t,e){return(fi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hi=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new Jt("border-all"),r=new li;return r.change=function(e){t.change(e),t.hide()},t=ci(this,ui(e).call(this,n,"auto",!1,"bottom-left",r.el))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fi(t,e)}(e,Mn),e}();function di(t){return(di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yi(t,e){return!e||"object"!==di(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vi(t){return(vi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gi(t,e){return(gi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),yi(this,vi(e).call(this,"border"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gi(t,e)}(e,Rn),n=e,(r=[{key:"dropdown",value:function(){return new hi}}])&&pi(n.prototype,r),i&&pi(n,i),e}();function mi(t){return(mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ki(t,e){return!e||"object"!==mi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xi(t,e,n){return(xi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Oi(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Oi(t){return(Oi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Si(t,e){return(Si=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ei=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ki(this,Oi(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Si(t,e)}(e,En),n=e,(r=[{key:"element",value:function(){var t=this;return xi(Oi(e.prototype),"element",this).call(this).child(new Jt(this.tag)).on("click",function(){return t.change(t.tag)})}},{key:"setState",value:function(t){this.el.disabled(t)}}])&&wi(n.prototype,r),i&&wi(n,i),e}();function Ci(t){return(Ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ji(t,e){return!e||"object"!==Ci(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _i(t){return(_i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ti(t,e){return(Ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ai=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ji(this,_i(e).call(this,"clearformat"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ti(t,e)}(e,Ei),e}();function Pi(t){return(Pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ri(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ii(t,e){return!e||"object"!==Pi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fi(t){return(Fi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Di(t,e){return(Di=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ii(this,Fi(e).call(this,"paintformat"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Di(t,e)}(e,ur),n=e,(r=[{key:"setState",value:function(){}}])&&Ri(n.prototype,r),i&&Ri(n,i),e}();function Hi(t){return(Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ni(t,e){return!e||"object"!==Hi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bi(t){return(Bi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wi(t,e){return(Wi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vi=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ni(this,Bi(e).call(this,"color",void 0,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wi(t,e)}(e,Rn),n=e,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Zr(t,e)}}])&&Mi(n.prototype,r),i&&Mi(n,i),e}();function Li(t){return(Li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ki(t,e){return!e||"object"!==Li(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $i(t){return($i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ui(t,e){return(Ui=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yi=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ki(this,$i(e).call(this,"bgcolor",void 0,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ui(t,e)}(e,Rn),n=e,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Zr(t,e)}}])&&qi(n.prototype,r),i&&qi(n,i),e}();function Zi(t){return(Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xi(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ji(t,e){return!e||"object"!==Zi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gi(t){return(Gi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qi(t,e){return(Qi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var to=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=Ae.map(function(t){return a("div","".concat(wt,"-item")).on("click",function(){n.setTitle("".concat(t.pt)),n.change(t)}).child("".concat(t.pt))});return n=Ji(this,(t=Gi(e)).call.apply(t,[this,"10","60px",!0,"bottom-left"].concat(Xi(r))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qi(t,e)}(e,Mn),e}();function eo(t){return(eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function no(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ro(t,e){return!e||"object"!==eo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function io(t){return(io=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oo(t,e){return(oo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ao=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ro(this,io(e).call(this,"font-size"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oo(t,e)}(e,Rn),n=e,(r=[{key:"getValue",value:function(t){return t.pt}},{key:"dropdown",value:function(){return new to}}])&&no(n.prototype,r),i&&no(n,i),e}();function lo(t){return(lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function so(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function co(t,e){return!e||"object"!==lo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function uo(t){return(uo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fo(t,e){return(fo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ho=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=Te.map(function(t){return a("div","".concat(wt,"-item")).on("click",function(){n.setTitle(t.title),n.change(t)}).child(t.title)});return n=co(this,(t=uo(e)).call.apply(t,[this,Te[0].title,"160px",!0,"bottom-left"].concat(so(r))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fo(t,e)}(e,Mn),e}();function po(t){return(po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vo(t,e){return!e||"object"!==po(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function go(t){return(go=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bo(t,e){return(bo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),vo(this,go(e).call(this,"font-name"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bo(t,e)}(e,Rn),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new ho}}])&&yo(n.prototype,r),i&&yo(n,i),e}();function wo(t){return(wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ko(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function xo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Oo(t,e){return!e||"object"!==wo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function So(t){return(So=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Eo(t,e){return(Eo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Co=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=Ge.slice(0);return r.splice(2,0,{key:"divider"}),r.splice(8,0,{key:"divider"}),r=r.map(function(t){var e=a("div","".concat(wt,"-item"));return"divider"===t.key?e.addClass("divider"):(e.child(t.title()).on("click",function(){n.setTitle(t.title()),n.change(t)}),t.label&&e.child(a("div","label").html(t.label))),e}),n=Oo(this,(t=So(e)).call.apply(t,[this,"Normal","220px",!0,"bottom-left"].concat(ko(r))))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Eo(t,e)}(e,Mn),n=e,(r=[{key:"setTitle",value:function(t){for(var e=0;e<Ge.length;e+=1)Ge[e].key===t&&this.title.html(Ge[e].title());this.hide()}}])&&xo(n.prototype,r),i&&xo(n,i),e}();function jo(t){return(jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function To(t,e){return!e||"object"!==jo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ao(t){return(Ao=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Po(t,e){return(Po=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ro=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),To(this,Ao(e).call(this,"format"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Po(t,e)}(e,Rn),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Co}}])&&_o(n.prototype,r),i&&_o(n,i),e}();function Io(t){return(Io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fo(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Do(t,e){return!e||"object"!==Io(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zo(t){return(zo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ho(t,e){return(Ho=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mo=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=Fe.map(function(t){return a("div","".concat(wt,"-item")).on("click",function(){n.hide(),n.change(t)}).child(t.key)});return n=Do(this,(t=zo(e)).call.apply(t,[this,new Jt("formula"),"180px",!0,"bottom-left"].concat(Fo(r))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ho(t,e)}(e,Mn),e}();function No(t){return(No="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wo(t,e){return!e||"object"!==No(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vo(t){return(Vo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lo(t,e){return(Lo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Wo(this,Vo(e).call(this,"formula"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lo(t,e)}(e,Rn),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Mo}}])&&Bo(n.prototype,r),i&&Bo(n,i),e}();function Ko(t){return(Ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $o(t,e){return!e||"object"!==Ko(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Uo(t){return(Uo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yo(t,e){return(Yo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),$o(this,Uo(e).call(this,"freeze"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yo(t,e)}(e,ur),e}();function Xo(t){return(Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Go(t,e){return!e||"object"!==Xo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qo(t){return(Qo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ta(t,e){return(ta=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ea=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Go(this,Qo(e).call(this,"merge"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ta(t,e)}(e,ur),n=e,(r=[{key:"setState",value:function(t,e){this.el.active(t).disabled(e)}}])&&Jo(n.prototype,r),i&&Jo(n,i),e}();function na(t){return(na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ra(t,e){return!e||"object"!==na(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ia(t){return(ia=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oa(t,e){return(oa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var aa=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ra(this,ia(e).call(this,"redo","Ctrl+Y"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oa(t,e)}(e,Ei),e}();function la(t){return(la="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sa(t,e){return!e||"object"!==la(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ca(t){return(ca=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ua(t,e){return(ua=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fa=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),sa(this,ca(e).call(this,"undo","Ctrl+Z"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ua(t,e)}(e,Ei),e}();function ha(t){return(ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function da(t,e){return!e||"object"!==ha(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pa(t){return(pa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ya(t,e){return(ya=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var va=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),da(this,pa(e).call(this,"print","Ctrl+P"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ya(t,e)}(e,Ei),e}();function ga(t){return(ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ba(t,e){return!e||"object"!==ga(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ma(t){return(ma=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wa(t,e){return(wa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ka=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ba(this,ma(e).call(this,"textwrap"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wa(t,e)}(e,ur),e}();function xa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Oa(t){return(Oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sa(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ea(t,e){return!e||"object"!==Oa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ca(t){return(Ca=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ja(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_a(t,e)}function _a(t,e){return(_a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ta=function(t){function e(){var t;Sa(this,e);var n=new Jt("ellipsis"),r=a("div","".concat(wt,"-toolbar-more"));return(t=Ea(this,Ca(e).call(this,n,"auto",!1,"bottom-right",r))).moreBtns=r,t.contentEl.css("max-width","420px"),t}return ja(e,Mn),e}(),Aa=function(t){function e(){var t;return Sa(this,e),(t=Ea(this,Ca(e).call(this,"more"))).el.hide(),t}var n,r,i;return ja(e,Rn),n=e,(r=[{key:"dropdown",value:function(){return new Ta}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&xa(n.prototype,r),i&&xa(n,i),e}();function Pa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ra(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ia(){return a("div","".concat(wt,"-toolbar-divider"))}function Fa(){var t,e,n=this.el,r=this.btns,i=this.moreEl,o=this.btns2,a=i.dd,l=a.moreBtns,s=a.contentEl;n.css("width","".concat(this.widthFn(),"px"));var c=n.box(),u=160,f=12,h=[],d=[];o.forEach(function(t,e){var n=Ra(t,2),r=n[0],i=n[1];u+=i,e===o.length-1||u<c.width?h.push(r):(f+=i,d.push(r))}),(t=r.html("")).children.apply(t,h),(e=l.html("")).children.apply(e,d),s.css("width","".concat(f,"px")),d.length>0?i.show():i.hide()}function Da(t){var e=this,n=new En;n.el.on("click",function(){t.onClick&&t.onClick(e.data.getData(),e.data)}),n.tip=t.tip||"";var r=t.el;if(t.icon&&(r=a("img").attr("src",t.icon)),r){var i=a("div","".concat(wt,"-icon"));i.child(r),n.el.child(i)}return n}var za=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data=e,this.change=function(){},this.widthFn=n,this.isHide=i;var o=e.defaultStyle(),l=e.settings.toolbar;this.items=[[this.createItem(function(){return r.undoEl=new fa},l.misc.undo),this.createItem(function(){return r.redoEl=new aa},l.misc.redo),this.createItem(function(){return new va},l.misc.print),this.createItem(function(){return r.paintformatEl=new zi},l.misc.paintFormat),this.createItem(function(){return r.clearformatEl=new Ai},l.misc.clearFormat)],Ia(),[this.createItem(function(){return r.formatEl=new Ro},l.format.format)],Ia(),[this.createItem(function(){return r.fontEl=new mo},l.font.family),this.createItem(function(){return r.fontSizeEl=new ao},l.font.size)],Ia(),[this.createItem(function(){return r.boldEl=new kr},l.textStyle.bold),this.createItem(function(){return r.italicEl=new Cr},l.textStyle.italic),this.createItem(function(){return r.underlineEl=new zr},l.textStyle.underline),this.createItem(function(){return r.strikeEl=new Pr},l.textStyle.strike),this.createItem(function(){return r.textColorEl=new Vi(o.color)},l.textStyle.color)],Ia(),[this.createItem(function(){return r.fillColorEl=new Yi(o.bgcolor)},l.cell.fill),this.createItem(function(){return r.borderEl=new bi},l.cell.borders),this.createItem(function(){return r.mergeEl=new ea},l.cell.merge)],Ia(),[this.createItem(function(){return r.alignEl=new Jn(o.align)},l.cellText.horizontalAlignment),this.createItem(function(){return r.valignEl=new rr(o.valign)},l.cellText.verticalAlignment),this.createItem(function(){return r.textwrapEl=new ka},l.cellText.wrap)],Ia(),[this.createItem(function(){return r.freezeEl=new Zo},l.tools.freezeCell),this.createItem(function(){return r.autofilterEl=new vr},l.tools.filter),this.createItem(function(){return r.formulaEl=new qo},l.tools.formulas)]],function(t){for(var e in t)Array.isArray(t[e])&&(t[e]=t[e].filter(function(t){return null!==t}));var n=[];for(var r in t)Array.isArray(t[r])&&0===t[r].length&&n.push(r);n.reverse().forEach(function(e){t.splice(e,1)}),n.length=0;for(var i=!1,o=!1,a=t.length-1;a>=0;--a){var l=t[a];Array.isArray(l)||(i=Array.isArray(t[a-1]),o=Array.isArray(t[a+1]),i&&o||t.splice(a,1))}}(this.items),l.itemsCallback&&l.itemsCallback(this.items);var s=e.settings.extendToolbar,c=void 0===s?{}:s;if(c.left&&c.left.length>0){this.items.unshift(Ia());var u=c.left.map(Da.bind(this));this.items.unshift(u)}if(c.right&&c.right.length>0){this.items.push(Ia());var f=c.right.map(Da.bind(this));this.items.push(f)}this.items.push([this.moreEl=new Aa]),this.el=a("div","".concat(wt,"-toolbar")),this.btns=a("div","".concat(wt,"-toolbar-btns")),this.items.forEach(function(t){Array.isArray(t)?t.forEach(function(t){r.btns.child(t.el)}):r.btns.child(t.el)}),this.el.child(this.btns),i?this.el.hide():(this.reset(),setTimeout(function(){(function(){var t=this;this.btns2=[],this.items.forEach(function(e){if(Array.isArray(e))e.forEach(function(e){var n=e.el,r=n.box(),i=n.computedStyle(),o=i.marginLeft,a=i.marginRight;t.btns2.push([n,r.width+parseInt(o,10)+parseInt(a,10)])});else{var n=e.box(),r=e.computedStyle(),i=r.marginLeft,o=r.marginRight;t.btns2.push([e,n.width+parseInt(i,10)+parseInt(o,10)])}})}).call(r),Fa.call(r)},0),pt(window,"resize",function(){Fa.call(r)}))}var e,n,r;return e=t,(n=[{key:"createItem",value:function(t,e){var n=this,r=t();return r.change=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];"merge"===e[0]&&!0===e[1]?n.checkMergeWarning().then(function(t){t?n.change.apply(n,e):n.mergeEl.setState(!1,!1)}):n.change.apply(n,e)},e?r:null}},{key:"paintformatActive",value:function(){return this.paintformatEl.active()}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){this["".concat(t,"El")].click()}},{key:"resetData",value:function(t){this.data=t,this.reset()}},{key:"checkMergeWarning",value:function(){var t=this;return Promise.resolve().then(function(){return!(t.data.collectMergeValues().length>1)||window.confirm(q("warning.mergingMultipleValues"))})}},{key:"reset",value:function(){if(!this.isHide){var t=this.data,e=t.getSelectedCellStyle(),n=t.getSelectedCell(),r=e.align;!e.hasAlignSet&&n&&n.text&&n.text.trim().length>0&&!isNaN(n.text)&&(r="right"),this.undoEl.setState(!t.canUndo()),this.redoEl.setState(!t.canRedo()),this.mergeEl.setState(t.canUnmerge(),!t.selector.multiple()),this.autofilterEl.setState(!t.canAutofilter());var i=e.font,o=e.format;this.formatEl.setState(o),this.fontEl.setState(i.name),this.fontSizeEl.setState(i.size),this.boldEl.setState(i.bold),this.italicEl.setState(i.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(r),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive())}}}])&&Pa(e.prototype,n),r&&Pa(e,r),t}();function Ha(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ma=function(){function t(e,n,r){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.editable=e,this.formulaBarOptions=n,this.el=a("div","".concat(wt,"-formulabar ").concat(wt,"-").concat("nextToToolbar"===n.location?"next-to-toolbar":"below-toolbar")).child(this.inputEl=a("input","").on("keydown",function(t){13!==t.keyCode&&27!==t.keyCode&&t.stopPropagation(),27===t.keyCode&&(i.reset(i.initialText),r&&r(i.text))}).on("input",function(){r&&(i.text=i.inputEl.val(),r(i.text))})).child(this.selectionInfoEl=a("div","".concat(wt,"-selection-info"))).child(this.htmlFormulaOverlay=a("div","".concat(wt,"-html-formula-overlay"))),this.editable||(this.inputEl.el.readOnly=!0)}var e,n,r;return e=t,(n=[{key:"setSelectionInfoText",value:function(t){this.selectionInfoEl.el.textContent=t}},{key:"reset",value:function(t){this.initialText=t,this.text=t,this.inputEl.val(t)}},{key:"setText",value:function(t){this.text=t,this.inputEl.val(t)}},{key:"setFormulaHtml",value:function(t){this.htmlFormulaOverlay.el.innerHTML=t,this.inputEl.el.style.color=t?"rgba(0, 0, 0, 0)":""}}])&&Ha(e.prototype,n),r&&Ha(e,r),t}();function Na(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ba(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Wa=function(){function t(e,n){var r,i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.title=e,this.el=a("div","".concat(wt,"-modal")).css("width",o).children(a("div","".concat(wt,"-modal-header")).children(new Jt("close").on("click.stop",function(){return i.hide()}),this.title),(r=a("div","".concat(wt,"-modal-content"))).children.apply(r,Na(n))).hide()}var e,n,r;return e=t,(n=[{key:"show",value:function(){var t=this;this.dimmer=a("div","".concat(wt,"-dimmer active")),document.body.appendChild(this.dimmer.el);var e=this.el.show().box(),n=e.width,r=e.height,i=document.documentElement,o=i.clientHeight,l=i.clientWidth;this.el.offset({left:(l-n)/2,top:(o-r)/3}),window.xkeydownEsc=function(e){27===e.keyCode&&t.hide()},pt(window,"keydown",window.xkeydownEsc)}},{key:"hide",value:function(){this.el.hide(),document.body.removeChild(this.dimmer.el),yt(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}])&&Ba(e.prototype,n),r&&Ba(e,r),t}();function Va(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var La=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vchange=function(){},this.el=a("div","".concat(wt,"-form-input")),this.input=a("input","").css("width",e).on("input",function(t){return r.vchange(t)}).attr("placeholder",n),this.el.child(this.input)}var e,n,r;return e=t,(n=[{key:"focus",value:function(){var t=this;setTimeout(function(){t.input.el.focus()},10)}},{key:"hint",value:function(t){this.input.attr("placeholder",t)}},{key:"val",value:function(t){return this.input.val(t)}}])&&Va(e.prototype,n),r&&Va(e,r),t}();function qa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ka=function(){function t(e,n,r){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t},l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.key=e,this.getTitle=o,this.vchange=function(){},this.el=a("div","".concat(wt,"-form-select")),this.suggest=new Kt(n.map(function(t){return{key:t,title:i.getTitle(t)}}),function(t){i.itemClick(t.key),l(t.key),i.vchange(t.key)},r,this.el),this.el.children(this.itemEl=a("div","input-text").html(this.getTitle(e)),this.suggest.el).on("click",function(){return i.show()})}var e,n,r;return e=t,(n=[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(t){this.key=t,this.itemEl.html(this.getTitle(t))}},{key:"val",value:function(t){return void 0!==t?(this.key=t,this.itemEl.html(this.getTitle(t)),this):this.key}}])&&qa(e.prototype,n),r&&qa(e,r),t}();function $a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ua={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},Ya=function(){function t(e,n,r,i){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.label="",this.rule=n,r&&(this.label=a("label","label").css("width","".concat(i,"px")).html(r)),this.tip=a("div","tip").child("tip").hide(),this.input=e,this.input.vchange=function(){return o.validate()},this.el=a("div","".concat(wt,"-form-field")).children(this.label,e.el,this.tip)}var e,n,r;return e=t,(n=[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(t){return this.input.val(t)}},{key:"hint",value:function(t){this.input.hint(t)}},{key:"validate",value:function(){var t=this.input,e=this.rule,n=this.tip,r=this.el,i=t.val();if(e.required&&/^\s*$/.test(i))return n.html(q("validation.required")),r.addClass("error"),!1;if((e.type||e.pattern)&&!(e.pattern||Ua[e.type]).test(i))return n.html(q("validation.notMatch")),r.addClass("error"),!1;return r.removeClass("error"),!0}}])&&$a(e.prototype,n),r&&$a(e,r),t}();function Za(t){return(Za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ja(t,e){return!e||"object"!==Za(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ga(t){return(Ga=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qa(t,e){return(Qa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tl=100,el=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new Ya(new Ka("cell",["cell"],"100%",function(t){return q("dataValidation.modeType.".concat(t))}),{required:!0},"".concat(q("dataValidation.range"),":"),tl),r=new Ya(new La("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),i=new Ya(new Ka("list",["list","number","date","phone","email"],"100%",function(t){return q("dataValidation.type.".concat(t))},function(e){return t.criteriaSelected(e)}),{required:!0},"".concat(q("dataValidation.criteria"),":"),tl),o=new Ya(new Ka("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",function(t){return q("dataValidation.operator.".concat(t))},function(e){return t.criteriaOperatorSelected(e)}),{required:!0}).hide(),l=new Ya(new La("70px","10"),{required:!0}).hide(),s=new Ya(new La("70px","100"),{required:!0,type:"number"}).hide(),c=new Ya(new La("120px","a,b,c"),{required:!0}),u=new Ya(new La("70px","10"),{required:!0,type:"number"}).hide();return(t=Ja(this,Ga(e).call(this,q("contextmenu.validation"),[a("div","".concat(wt,"-form-fields")).children(n.el,r.el),a("div","".concat(wt,"-form-fields")).children(i.el,o.el,l.el,s.el,u.el,c.el),a("div","".concat(wt,"-buttons")).children(new ye("cancel").on("click",function(){return t.btnClick("cancel")}),new ye("remove").on("click",function(){return t.btnClick("remove")}),new ye("save","primary").on("click",function(){return t.btnClick("save")}))]))).mf=n,t.rf=r,t.cf=i,t.of=o,t.minvf=l,t.maxvf=s,t.vf=u,t.svf=c,t.change=function(){},t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qa(t,e)}(e,Wa),n=e,(r=[{key:"showVf",value:function(t){var e="date"===t?"2018-11-12":"10",n=this.vf;n.input.hint(e),n.show()}},{key:"criteriaSelected",value:function(t){var e=this.of,n=this.minvf,r=this.maxvf,i=this.vf,o=this.svf;"date"===t||"number"===t?(e.show(),n.rule.type=t,r.rule.type=t,"date"===t?(n.hint("2018-11-12"),r.hint("2019-11-12")):(n.hint("10"),r.hint("100")),n.show(),r.show(),i.hide(),o.hide()):("list"===t?o.show():o.hide(),i.hide(),e.hide(),n.hide(),r.hide())}},{key:"criteriaOperatorSelected",value:function(t){if(t){var e=this.minvf,n=this.maxvf,r=this.vf;if("be"===t||"nbe"===t)e.show(),n.show(),r.hide();else{var i=this.cf.val();r.rule.type=i,"date"===i?r.hint("2018-11-12"):r.hint("10"),r.show(),e.hide(),n.hide()}}}},{key:"btnClick",value:function(t){if("cancel"===t)this.hide();else if("remove"===t)this.change("remove"),this.hide();else if("save"===t){for(var e=["mf","rf","cf","of","svf","vf","minvf","maxvf"],n=0;n<e.length;n+=1){var r=this[e[n]];if(r.isShow()&&!r.validate())return}var i=this.mf.val(),o=this.rf.val(),a=this.cf.val(),l=this.of.val(),s=this.svf.val();"number"!==a&&"date"!==a||(s="be"===l||"nbe"===l?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",i,o,{type:a,operator:l,required:!1,value:s}),this.hide()}}},{key:"setValue",value:function(t){if(t){var e=this.mf,n=this.rf,r=this.cf,i=this.of,o=this.svf,a=this.vf,l=this.minvf,s=this.maxvf,c=t.mode,u=t.ref,f=t.validator||{type:"list"},h=f.type,d=f.operator,p=f.value;e.val(c||"cell"),n.val(u),r.val(h),i.val(d),Array.isArray(p)?(l.val(p[0]),s.val(p[1])):(o.val(p||""),a.val(p||"")),this.criteriaSelected(h),this.criteriaOperatorSelected(d)}this.show()}}])&&Xa(n.prototype,r),i&&Xa(n,i),e}();function nl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rl(t){return a("div","".concat(wt,"-item ").concat(t))}function il(t){var e=this;return rl("state").child(q("sort.".concat(t))).on("click.stop",function(){return e.itemClick(t)})}function ol(){var t=this.filterhEl,e=this.filterValues,n=this.values;t.html("".concat(e.length," / ").concat(n.length)),t.checked(e.length===n.length)}var al=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterbEl=a("div","".concat(wt,"-body")),this.filterhEl=a("div","".concat(wt,"-header state")).on("click.stop",function(){return e.filterClick(0,"all")}),this.el=a("div","".concat(wt,"-sort-filter")).children(this.sortAscEl=il.call(this,"asc"),this.sortDescEl=il.call(this,"desc"),rl("divider"),a("div","".concat(wt,"-filter")).children(this.filterhEl,this.filterbEl),a("div","".concat(wt,"-buttons")).children(new ye("cancel").on("click",function(){return e.btnClick("cancel")}),new ye("ok","primary").on("click",function(){return e.btnClick("ok")}))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}var e,n,r;return e=t,(n=[{key:"btnClick",value:function(t){if("ok"===t){var e=this.ci,n=this.sort,r=this.filterValues;this.ok&&this.ok(e,n,"in",r)}this.hide()}},{key:"itemClick",value:function(t){this.sort=t;var e=this.sortAscEl,n=this.sortDescEl;e.checked("asc"===t),n.checked("desc"===t)}},{key:"filterClick",value:function(t,e){var n=this.filterbEl,r=this.filterValues,i=this.values,o=n.children();"all"===e?o.length===r.length?(this.filterValues=[],o.forEach(function(t){return a(t).checked(!1)})):(this.filterValues=Array.from(i),o.forEach(function(t){return a(t).checked(!0)})):a(o[t]).toggle("checked")?r.push(e):r.splice(r.findIndex(function(t){return t===e}),1);ol.call(this)}},{key:"set",value:function(t,e,n,r){this.ci=t;var i=this.sortAscEl,o=this.sortDescEl;null!==r?(this.sort=r.order,i.checked(r.asc()),o.checked(r.desc())):(this.sortDesc=null,i.checked(!1),o.checked(!1)),this.values=Object.keys(e),this.filterValues=n?Array.from(n.value):Object.keys(e),function(t){var e=this,n=this.filterbEl,r=this.filterValues;n.html(""),Object.keys(t).forEach(function(i,o){var l=t[i],s=r.includes(i)?"checked":"";n.child(a("div","".concat(wt,"-item state ").concat(s)).on("click.stop",function(){return e.filterClick(o,i)}).children(""===i?q("filter.empty"):i,a("div","label").html("(".concat(l,")"))))})}.call(this,e,n),ol.call(this)}},{key:"setOffset",value:function(t){var e=this;this.el.offset(t).show();var n=1;gt(this.el,function(){n<=0&&e.hide(),n-=1})}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),vt(this.el)}}])&&nl(e.prototype,n),r&&nl(e,r),t}();function ll(t,e){var n=a("div","".concat(wt,"-toast")),r=a("div","".concat(wt,"-dimmer active"));n.children(a("div","".concat(wt,"-toast-header")).children(new Jt("close").on("click.stop",function(){return document.body.removeChild(n.el),void document.body.removeChild(r.el)}),t),a("div","".concat(wt,"-toast-content")).html(e)),document.body.appendChild(n.el),document.body.appendChild(r.el);var i=n.box(),o=i.width,l=i.height,s=document.documentElement,c=s.clientHeight,u=s.clientWidth;n.offset({left:(u-o)/2,top:(c-l)/3})}function sl(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function cl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ul(t){return(ul="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function hl(t,e){var n,r=this;return function(){for(var i=r,o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];var s=a;n||(n=setTimeout(function(){n=null,t.apply(i,s)},e))}}function dl(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(-1!==e||-1!==n){var a=this.table,l=this.selector,s=this.toolbar,c=this.data.getCell(e,n);if(t)l.setEnd(e,n,i,o),this.trigger("cells-selected",c,l.range),this.updateSelectionInfo();else{l.set(e,n,r),this.trigger("cell-selected",c,e,n);var u=c?c.text:"";this.formulaBar.reset(u),this.updateSelectionInfo()}this.updateContextMenuTargetRange(e,n),s.reset(),a.render()}}function pl(t,e){var n=this.selector,r=this.data,i=r.rows,o=r.cols,a=fl(n.indexes,2),l=a[0],s=a[1],c=n.range,u=c.eri,f=c.eci;if(t){var h=fl(n.moveIndexes,2);l=h[0],s=h[1]}"left"===e?s>0&&(s-=1):"right"===e?(f!==s&&(s=f),s<o.len-1&&(s+=1)):"up"===e?l>0&&(l-=1):"down"===e?(u!==l&&(l=u),l<i.len-1&&(l+=1)):"row-first"===e?s=0:"row-last"===e?s=o.len-1:"col-first"===e?l=0:"col-last"===e&&(l=i.len-1),t&&(n.moveIndexes=[l,s]),dl.call(this,t,l,s),function(){var t=this.data,e=this.verticalScrollbar,n=this.horizontalScrollbar,r=t.getSelectedRect(),i=r.l,o=r.t,a=r.left,l=r.top,s=r.width,c=r.height,u=this.getTableOffset();if(Math.abs(a)+s>u.width)n.move({left:i+s-u.width});else{var f=t.freezeTotalWidth();a<f&&n.move({left:i-1-f})}if(Math.abs(l)+c>u.height)e.move({top:o+c-u.height-1});else{var h=t.freezeTotalHeight();l<h&&e.move({top:o-1-h})}}.call(this)}function yl(){var t=this.data,e=this.verticalScrollbar,n=this.getTableOffset().height,r=t.exceptRowTotalHeight(0,-1);e.set(n,t.rows.totalHeight()-r)}function vl(){var t=this.data,e=this.horizontalScrollbar,n=this.getTableOffset().width;t&&e.set(n,t.cols.totalWidth())}function gl(){var t=this.data,e=this.tableEl,n=this.overlayerEl,r=this.overlayerCEl,i=this.table,o=this.toolbar,a=this.selector,l=this.el,s=this.getTableOffset(),c=this.getRect();e.attr(c),n.offset(c),r.offset(s),l.css("width","".concat(c.width,"px")),yl.call(this),vl.call(this),function(){var t=this.selector,e=this.data,n=this.editor,r=fl(e.freeze,2),i=r[0],o=r[1];if(i>0||o>0){var a=e.freezeTotalWidth(),l=e.freezeTotalHeight();n.setFreezeLengths(a,l)}t.resetAreaOffset()}.call(this),i.render(),o.reset(),a.reset();var u=t.getSelectedCell();this.formulaBar.reset(u&&u.text?u.text:""),this.updateSelectionInfo()}function bl(){var t=this.data,e=this.selector;t.clearClipboard(),e.hideClipboard()}function ml(t){var e=this.data,n=this.selector;"read"!==e.settings.mode?(e.copy(),e.copyToSystemClipboard(t),n.showClipboard()):e.copyToSystemClipboard(t)}function wl(t){var e=this.data,n=this.selector;"read"!==e.settings.mode?(e.cut(),e.copyToSystemClipboard(t),n.showClipboard()):e.copyToSystemClipboard(t)}function kl(t,e){var n=this,r=this.data;if("read"!==r.settings.mode){var i;i=r.settings.clipboard&&r.settings.clipboard.getData?r.settings.clipboard.getData():e.clipboardData.getData("text/plain");var o=function(){var o=!1;if(i&&i.json)try{var a=JSON.parse(i.json);o="x-spreadsheet"===a.srcType&&a.srcDataId===r.randomId}catch(t){}if(o||r.clipboard.clear(),o&&r.paste(t,function(t){return ll("Tip",t)}))gl.call(n);else if(e){if("object"===ul(i))if(i.json)try{var l=JSON.parse(i.json);i="x-spreadsheet"===l.srcType?l:i.text}catch(t){i=i.text}else i=i.text;"string"==typeof i?n.data.pasteFromText(i):n.data.pasteFromObj(i),gl.call(n);var s=n.data.getSelectedCell(),c=s?s.text:"";n.formulaBar.reset(c),n.updateSelectionInfo()}};i instanceof Promise?i.then(function(t){i=t,o()}):o()}}function xl(t,e){this.data.unhideRowsOrCols(t,e),gl.call(this)}function Ol(t){var e=this,n=this.selector,r=this.data,i=this.table,o=this.sortFilter,a=t.offsetX,l=t.offsetY,s=t.shiftKey;if(this.isSelectingCellsForFormula&&(s=!1),t.target.closest(".spreadsheet-trigger")){if(t.ctrlKey||t.metaKey)return;var c=this.overlayerEl.el.getBoundingClientRect();a=t.clientX-c.x,l=t.clientY-c.y}var u=t.target.className==="".concat(wt,"-selector-corner"),f=r.getCellRectByXY(a,l),h=f.left,d=f.top,p=f.width,y=f.height,v=f.ri,g=f.ci,b=r.autoFilter;if(b.includes(v,g)&&h+p-20<a&&d+y-20<l){var m=b.items(g,function(t,e){return r.rows.getCell(t,e)});return o.hide(),o.set(g,m,b.getFilter(g),b.getSort(g)),void o.setOffset({left:h,top:d+y+2})}var w=v<0,k=g<0,x=w||k,O=this.selector.range,S=O.sci,E=O.eci,C=O.sri,j=O.eri,_=w&&g>=S&&g<=E&&0===C&&j===r.rows.len-1,T=k&&v>=C&&v<=j&&0===S&&E===r.cols.len-1,A=(_||T)&&2===t.buttons;s||A||(u?n.showAutofill(v,g):dl.call(this,!1,v,g),bt(window,function(t){var i=t.target.closest(".spreadsheet-trigger"),o=t.offsetX,a=t.offsetY;if(i){if(t.ctrlKey||t.metaKey)return;var l=e.overlayerEl.el.getBoundingClientRect();o=t.clientX-l.x,a=t.clientY-l.y}var s=r.getCellRectByXY(o,a);v=s.ri,g=s.ci,u?n.showAutofill(v,g):1===t.buttons&&dl.call(e,!0,v,g,!0,!0)},function(){u&&n.arange&&"read"!==r.settings.mode&&r.autofill(n.arange,"all",function(t){return ll("Tip",t)})&&i.render(),n.hideAutofill(),function(){var t=this.toolbar;t.paintformatActive()&&(kl.call(this,"format"),bl.call(this),t.paintformatToggle())}.call(e)})),u||1!==t.buttons||s&&dl.call(this,!0,v,g,!0,!1,x)}function Sl(){var t=this.editor,e=this.data.getSelectedRect(),n=this.getTableOffset(),r="top";e.top>n.height/2&&(r="bottom"),t.setOffset(e,r),this.clickableElementsInner.offset({left:-this.data.scroll.x,top:-this.data.scroll.y})}function El(t,e){var n=this.editor,r=this.data;"read"!==r.settings.mode&&(Sl.call(this),n.setCell(r.getSelectedCell(),r.getSelectedValidator(),t,e),bl.call(this),this.updateHighlightedFormulaReferences())}function Cl(t,e){var n=t.ri,r=this.table,i=this.selector,o=this.data,a=i.range;if(a.eri===n)for(var l=a.sri;l<=a.eri;++l)o.setRowHeight(l,e);else o.setRowHeight(n,e);r.render(),i.resetAreaOffset(),yl.call(this),Sl.call(this)}function jl(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",n=this.data,r=this.table;if("read"!==n.settings.mode){n.setSelectedCellText(t,e);var i=n.selector,o=i.ri,a=i.ci;"finished"===e?r.render():this.trigger("cell-edited",t,o,a)}}function _l(t){var e=this.data,n=this.selector,r=n.range.eri-n.range.sri+1,i=n.range.eci-n.range.sci+1,o=!1;if("read"!==e.settings.mode){if("insert-row-before"===t||"insert-rows-before"===t)e.insert("row","before",r);else if("insert-row-after"===t||"insert-rows-after"===t)e.insert("row","after",r);else if("delete-row"===t||"delete-rows"===t)e.delete("row"),o=!0;else if("insert-column-before"===t||"insert-columns-before"===t)e.insert("column","before",i);else if("insert-column-after"===t||"insert-columns-after"===t)e.insert("column","after",i);else if("delete-column"===t||"delete-columns"===t)e.delete("column"),o=!0;else if("reset-row-height"===t)for(var a=n.range.sri;a<=n.range.eri;++a)e.rows.setHeight(a,25);else if("reset-column-width"===t)for(var l=n.range.sci;l<=n.range.eci;++l)e.cols.setWidth(l,100);else"delete-cell"===t?e.deleteCell():"delete-cell-format"===t?e.deleteCell("format"):"delete-cell-text"===t?e.deleteCell("text"):"cell-printable"===t?e.setSelectedCellAttr("printable",!0):"cell-non-printable"===t?e.setSelectedCellAttr("printable",!1):"cell-editable"===t?e.setSelectedCellAttr("editable",!0):"cell-non-editable"===t&&e.setSelectedCellAttr("editable",!1);o&&function(){var t=this.data,e=this.selector.range,n=e.sci,r=e.eci,i=e.sri,o=e.eri,a=t.cols.len,l=t.rows.len,s=Math.min(n,a-1),c=Math.min(r,a-1),u=Math.min(i,l-1),f=Math.min(o,l-1);s===n&&c===r&&u===i&&f===o||(this.selectorSet(!1,u,s),this.selectorSet(!0,f,c))}.call(this),bl.call(this),gl.call(this)}}function Tl(t,e){var n=this.data;if("undo"===t)this.undo();else if("redo"===t)this.redo();else if("print"===t)this.print.preview();else if("paintformat"===t)!0===e?ml.call(this):bl.call(this);else if("clearformat"===t)_l.call(this,"delete-cell-format");else if("link"===t);else if("chart"===t);else if("autofilter"===t)(function(){this.data.autofilter(),gl.call(this)}).call(this);else if("freeze"===t)if(e){var r=n.selector,i=r.ri,o=r.ci;this.freeze(i,o)}else this.freeze(0,0);else n.setSelectedCellAttr(t,e),"formula"!==t||n.selector.multiple()||El.call(this),gl.call(this)}function Al(){var t,e,n,r,i,o,a=this,l=this.selector,s=this.overlayerEl,c=this.rowResizer,u=this.colResizer,f=this.verticalScrollbar,d=this.horizontalScrollbar,p=this.editor,y=this.contextMenu,v=this.toolbar,g=this.modalValidation,b=this.sortFilter;s.on("mousemove",function(t){(function(t){if(0===t.buttons&&t.target.className!=="".concat(wt,"-resizer-hover")){var e=t.offsetX,n=t.offsetY,r=this.rowResizer,i=this.colResizer,o=this.tableEl,a=this.data,l=a.rows,s=a.cols;if(e>s.indexWidth&&n>l.height)return r.hide(),void i.hide();var c=o.box(),u=a.getCellRectByXY(t.offsetX,t.offsetY);u.ri>=0&&-1===u.ci?(u.width=s.indexWidth,r.show(u,{width:c.width}),l.isHide(u.ri-1)?r.showUnhide(u.ri):r.hideUnhide()):r.hide(),-1===u.ri&&u.ci>=0?(u.height=l.height,i.show(u,{height:c.height}),s.isHide(u.ci-1)?i.showUnhide(u.ci):i.hideUnhide()):i.hide()}}).call(a,t)}).on("mousedown",function(t){var e,n,r;if(p.isEnteringFormula()?(a.isSelectingCellsForFormula=!0,e=a.selector.range.sri,n=a.selector.range.sci,r=a.editor.getCursorPosition()):p.clear(),y.hide(),2===t.buttons){var i=t.offsetX,o=t.offsetY;if(t.target.closest(".spreadsheet-trigger")){if(t.ctrlKey||t.metaKey)return;var l=a.overlayerEl.el.getBoundingClientRect();i=t.clientX-l.x,o=t.clientY-l.y}var s=a.data.getCellRectByXY(i,o),c=s.ri,u=s.ci;a.updateContextMenuTargetRange(c,u),a.data.xyInSelectedRect(t.offsetX,t.offsetY)?y.setPosition(t.offsetX,t.offsetY):(Ol.call(a,t),y.setPosition(t.offsetX,t.offsetY)),t.stopPropagation()}else 2===t.detail?El.call(a,null,!0):Ol.call(a,t);if(a.isSelectingCellsForFormula){document.addEventListener("mouseup",function i(){document.removeEventListener("mouseup",i),a.isSelectingCellsForFormula=!1;var o=a.selector.range.sci,l=a.selector.range.eci,s=a.selector.range.sri,c=a.selector.range.eri,u=t.ctrlKey||t.metaKey,f=h(o,s,u,u),d=h(l,c,u,u),y=f===d?f:"".concat(f,":").concat(d);a.editor.injectText(y,r[0],r[1]),a.spreadsheet.setSelectedRange({row0:e,row1:e,col0:n,col1:n}),a.editor.textEl.focus(),a.editor.setCursorPosition(r[0]+y.length),setTimeout(function(){a.editor.setCursorPosition(r[0]+y.length)},0),a.formulaBar.setText(p.inputText),a.updateHighlightedFormulaReferences()})}}).on("mousewheel.stop",function(t){(function(t){var e=this.verticalScrollbar,n=this.horizontalScrollbar,r=this.data,i=e.scroll().top,o=n.scroll().left,a=r.rows,l=r.cols,s=t.deltaY,c=t.deltaX,u=function(t,e){var n=t,r=0;do{r=e(n),n+=1}while(r<=0);return r},f=function(t){if(t>0){var n=r.scroll.ri+1;if(n<a.len){var o=u(n,function(t){return a.getHeight(t)});e.move({top:i+o-1})}}else{var l=r.scroll.ri-1;if(l>=0){var s=u(l,function(t){return a.getHeight(t)});e.move({top:0===l?0:i-s})}}},h=Math.abs(s),d=Math.abs(c),p=Math.max(h,d);/Firefox/i.test(window.navigator.userAgent)&&hl(f(t.detail),50),p===d&&hl(function(t){if(t>0){var e=r.scroll.ci+1;if(e<l.len){var i=u(e,function(t){return l.getWidth(t)});n.move({left:o+i-1})}}else{var a=r.scroll.ci-1;if(a>=0){var s=u(a,function(t){return l.getWidth(t)});n.move({left:0===a?0:o-s})}}}(c),50),p===h&&hl(f(s),50)}).call(a,t)}).on("mouseout",function(t){var e=t.offsetX;t.offsetY<=0&&u.hide(),e<=0&&c.hide()}),l.inputChange=function(t){jl.call(a,t,"input"),El.call(a)},t=s.el,n=(e={move:function(t,e){(function(t,e){var n=this.verticalScrollbar,r=this.horizontalScrollbar,i=n.scroll().top,o=r.scroll().left;"left"===t||"right"===t?r.move({left:o-e}):"up"!==t&&"down"!==t||n.move({top:i-e})}).call(a,t,e)}}).move,r=e.end,i=0,o=0,pt(t,"touchstart",function(t){var e=t.touches[0],n=e.pageX,r=e.pageY;i=n,o=r}),pt(t,"touchmove",function(t){if(n){var e=t.changedTouches[0],r=e.pageX,a=e.pageY,l=r-i,s=a-o;(Math.abs(l)>10||Math.abs(s)>10)&&(mt(l,s,t,n),i=r,o=a),t.preventDefault()}}),pt(t,"touchend",function(t){if(r){var e=t.changedTouches[0],n=e.pageX,a=e.pageY;mt(n-i,a-o,t,r)}}),v.change=function(t,e){return Tl.call(a,t,e)},b.ok=function(t,e,n,r){return function(t,e,n,r){this.data.setAutoFilter(t,e,n,r),gl.call(this)}.call(a,t,e,n,r)},c.finishedFn=function(t,e){Cl.call(a,t,e)},u.finishedFn=function(t,e){(function(t,e){var n=t.ci,r=this.table,i=this.selector,o=this.data,a=i.range;if(a.eci===n)for(var l=a.sci;l<=a.eci;++l)o.setColWidth(l,e);else o.setColWidth(n,e);r.render(),i.resetAreaOffset(),vl.call(this),Sl.call(this)}).call(a,t,e)},c.unhideFn=function(t){xl.call(a,"row",t)},u.unhideFn=function(t){xl.call(a,"col",t)},f.moveFn=function(t,e){(function(t){var e=this,n=this.data,r=this.table,i=this.selector;n.scrolly(t,function(){i.resetBRLAreaOffset(),Sl.call(e),r.render()})}).call(a,t,e)},d.moveFn=function(t,e){(function(t){var e=this,n=this.data,r=this.table,i=this.selector;n.scrollx(t,function(){i.resetBRTAreaOffset(),Sl.call(e),r.render()})}).call(a,t,e)},p.change=function(t,e){"finished"===t?(a.formulaBar.reset(e),a.updateSelectionInfo()):(a.formulaBar.setText(e),a.updateSelectionInfo()),jl.call(a,e,t),a.updateHighlightedFormulaReferences()},g.change=function(t){if("save"===t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=a.data).addValidation.apply(e,r)}else a.data.removeValidation()},y.itemClick=function(t){"validation"===t?g.setValue(a.data.getSelectedValidation()):"copy"===t?ml.call(a):"cut"===t?wl.call(a):"paste"===t?kl.call(a,"all"):"paste-value"===t?kl.call(a,"text"):"paste-format"===t?kl.call(a,"format"):"hide"===t?function(){this.data.hideRowsOrCols(),gl.call(this)}.call(a):_l.call(a,t)},pt(window,"resize",function(){a.reload()}),pt(window,"click",function(t){a.focusing=a.spreadsheetEl.contains(t.target)}),pt(window,"paste",function(t){a.focusing&&(kl.call(a,"all",t),t.preventDefault())}),pt(window,"copy",function(t){a.focusing&&document.activeElement!==a.formulaBar.inputEl.el&&(ml.call(a,t),t.preventDefault())}),pt(window,"cut",function(t){a.focusing&&document.activeElement!==a.formulaBar.inputEl.el&&(wl.call(a,t),t.preventDefault())}),pt(window,"keydown",function(t){if(a.focusing){var e=t.keyCode||t.which,n=t.key,r=t.altKey,i=t.ctrlKey,o=t.shiftKey,l=t.metaKey;if(i||l)switch(e){case 90:a.undo(),t.preventDefault();break;case 89:a.redo(),t.preventDefault();break;case 67:case 88:break;case 85:v.trigger("underline"),t.preventDefault();break;case 86:break;case 37:pl.call(a,o,"row-first"),t.preventDefault();break;case 38:pl.call(a,o,"col-first"),t.preventDefault();break;case 39:pl.call(a,o,"row-last"),t.preventDefault();break;case 40:pl.call(a,o,"col-last"),t.preventDefault();break;case 32:dl.call(a,!1,-1,a.data.selector.ci,!1),t.preventDefault();break;case 66:v.trigger("bold");break;case 73:v.trigger("italic")}else{switch(e){case 32:o&&dl.call(a,!1,a.data.selector.ri,-1,!1);break;case 27:y.hide(),bl.call(a);break;case 37:pl.call(a,o,"left"),t.preventDefault();break;case 38:pl.call(a,o,"up"),t.preventDefault();break;case 39:pl.call(a,o,"right"),t.preventDefault();break;case 40:pl.call(a,o,"down"),t.preventDefault();break;case 9:p.clear(),pl.call(a,!1,o?"left":"right"),t.preventDefault();break;case 13:p.clear(),pl.call(a,!1,r?"up":"down"),t.preventDefault();break;case 8:_l.call(a,"delete-cell-text"),t.preventDefault()}if("Delete"===n)_l.call(a,"delete-cell-text"),t.preventDefault();else if(e>=65&&e<=90||e>=48&&e<=57||e>=96&&e<=105||e>=186&&e<=192||e>=219&&e<=222||"="===t.key){var s=a.data.getSelectedCell(),c=s?s.text:"";jl.call(a,t.key,"input"),El.call(a,c),a.formulaBar.setText(p.inputText)}else 113===e&&El.call(a,null,!0)}}})}var Pl=function(){function t(e,n,r){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.spreadsheetEl=e,this.spreadsheet=r,this.eventMap=function(){var t=new Map;function e(e,n){var r;return t.has(e)&&(r=t.get(e),Array.isArray(r)&&r.push(n)||!1)||t.set(e,[].concat(n))}function n(e,n){var r,i;return t.has(e)&&(r=t.get(e),(i=r.indexOf(n))>=0&&r.splice(i,1)&&0===t.get(e).length&&t.delete(e))}return{get current(){return t},on:e,once:function(t,r){return e(t,function e(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];r.call.apply(r,[null].concat(o)),n(t,e)})},fire:function(e,n){return t.has(e)&&function(){var r=t.get(e),i=!0,o=!1,a=void 0;try{for(var l,s=r[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var c=l.value;c.call.apply(c,[null].concat(dt(n)))}}catch(t){o=!0,a=t}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}}()},removeListener:n,removeAllListeners:function(){t.clear()}}}();var o=n.settings,l=o.view,s=o.showToolbar,c=o.showContextmenu,u=o.showContextMenuForCells,f=o.formulaBar,h=o.contextMenu;this.el=a("div","".concat(wt,"-sheet")),this.toolbar=new za(n,l.width,!s),this.formulaBar=new Ma("read"!==n.settings.mode,f,function(t){jl.call(i,t,"finished"),i.editor.cell&&(i.editor.setText(t,!0),i.updateHighlightedFormulaReferences()),i.trigger("change")}),this.print=new bn(n,r),e.children(this.toolbar.el,this.formulaBar.el,this.el,this.print.el),this.data=n,this.tableEl=a("canvas","".concat(wt,"-table")),this.rowResizer=new xt(!1,n.rows.height),this.colResizer=new xt(!0,n.cols.minWidth),this.verticalScrollbar=new St(!0),this.horizontalScrollbar=new St(!1),this.editor=new ue(De,function(){return i.getTableOffset()},n.rows.height,function(t,e,n){t<0?pl.call(i,e,n?"left":"up"):t>0&&pl.call(i,e,n?"right":"down")},n.settings.suggestFormulas,this.spreadsheet.getChoosers(),this.spreadsheet),this.modalValidation=new el,this.contextMenu=new On(function(){return i.getRect()},!c,!u,h),this.selector=new Wt(n),this.clickableElementsInner=a("div","".concat(wt,"-overlayer-clickable-elements-inner")),this.clickableElementsContainer=a("div","".concat(wt,"-overlayer-clickable-elements-container")).child(this.clickableElementsInner),this.overlayerCEl=a("div","".concat(wt,"-overlayer-content")).children(this.editor.el,this.selector.el,this.clickableElementsContainer),this.overlayerEl=a("div","".concat(wt,"-overlayer")).child(this.overlayerCEl),this.sortFilter=new al,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el),this.table=new fn(this.tableEl.el,n,this.spreadsheet,this.clickableElementsInner),Al.call(this),gl.call(this),dl.call(this,!1,0,0),this.selectorSet=dl,this.clearClipboard=bl,this.isSelectingCellsForFormula=!1}var e,n,r;return e=t,(n=[{key:"focus",value:function(){this.selector.focus()}},{key:"on",value:function(t,e){return this.eventMap.on(t,e),this}},{key:"trigger",value:function(t){for(var e=this.eventMap,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.fire(t,r)}},{key:"resetData",value:function(t){this.editor.clear(),this.data=t,yl.call(this),vl.call(this),this.toolbar.resetData(t),this.print.resetData(t),this.selector.resetData(t),this.table.resetData(t)}},{key:"loadData",value:function(t){return this.data.setData(t),gl.call(this),this}},{key:"freeze",value:function(t,e){return this.data.setFreeze(t,e),gl.call(this),this}},{key:"undo",value:function(){var t=this;this.data.undo(function(){t.trigger("undo-performed")}),gl.call(this)}},{key:"redo",value:function(){var t=this;this.data.redo(function(){t.trigger("redo-performed")}),gl.call(this)}},{key:"reload",value:function(){return gl.call(this),this}},{key:"getRect",value:function(){var t=this.data;return{width:t.viewWidth(),height:t.viewHeight()}}},{key:"getTableOffset",value:function(){var t=this.data,e=t.rows,n=t.cols,r=this.getRect(),i=r.width,o=r.height;return{width:i-n.indexWidth,height:o-e.height,left:n.indexWidth,top:e.height}}},{key:"setSelectedCellCustomFormatter",value:function(t){this.data.setSelectedCellCustomFormatter(t),gl.call(this)}},{key:"clearSelectedCellCustomFormatter",value:function(){this.data.clearSelectedCellCustomFormatter(),gl.call(this)}},{key:"updateSelectionInfo",value:function(){var t=this.data,e=t.rows,n=t.selector,r=[];if(n.range.sri!==n.range.eri||n.range.sci!==n.range.eci)for(var i=n.range.sri;i<=n.range.eri;++i)for(var o=n.range.sci;o<=n.range.eci;++o){var a=e.getCell(i,o);if(a&&a.text&&a.text.length>0){var l=a.text;l.startsWith("=")&&(l=$e.render(this.spreadsheet,a.text||"",ze,function(e,n){return t.getCellTextOrDefault(n,e)}),a._lastRenderedFormula=l),isNaN(l)||r.push(parseFloat(l))}}if(0===r.length)this.formulaBar.setSelectionInfoText("");else{var s=r.reduce(function(t,e){return t+e}),c=s/r.length,u=function(t){for(var e=Math.pow(10,3),n=(Math.round(e*t)/e).toFixed(3);"."===n[n.length-1]||"0"==n[n.length-1];){var r=n[n.length-1];if(n=n.substr(0,n.length-1),"."===r)break}return n},f=u(s),h=u(c);this.formulaBar.setSelectionInfoText("Sum: ".concat(f,"; Avg: ").concat(h))}}},{key:"updateHighlightedFormulaReferences",value:function(){var t=this.editor,e=this.formulaBar;if(!!t.isOn&&t.inputText&&"="===t.inputText[0]){var n=sl(t.inputText.matchAll(/\$?([a-zA-Z]{1,3}\$?\d+:\$?[a-zA-Z]{1,3}\$?\d+|\$?[a-zA-Z]{1,3}\$?\d+)/g)),r=0,i=[],o=t.inputText,a=0;n.forEach(function(t){var e=t[0],n=Wr[r];if(r=(r+1)%Wr.length,e.includes(":"))for(var l=fl(e.split(":").map(function(t){return f(t)}),2),s=l[0],c=l[1],u=s[0];u<=c[0];++u)for(var h=s[1];h<=c[1];++h)i.push([u,h,n]);else i.push([].concat(sl(f(e)),[n]));var d=o.substring(0,t.index+a),p=o.substring(t.index+e.length+a),y=o.length,v=(o="".concat(d,'<span style="color:').concat(n,';">').concat(e,"</span>").concat(p)).length;a+=v-y}),this.spreadsheet.highlightFormulaCells=i,t.setFormulaHtml(o),e.setFormulaHtml(o)}else this.spreadsheet.highlightFormulaCells=void 0,t.setFormulaHtml(""),e.setFormulaHtml("");this.table.render()}},{key:"updateContextMenuTargetRange",value:function(t,e){var n=this.contextMenu,r=this.selector.range;n.setTargetRange({sci:-1===e?-1:r.sci,eci:-1===e?-1:r.eci,sri:-1===t?-1:r.sri,eri:-1===t?-1:r.eri})}},{key:"resizeRowAfterClearingEditor",value:function(t,e){var n=this,r=function(){Cl.call(n,{ri:t},e)};this.editor.isOn?this.editor.onClearActions.push(r):r()}}])&&cl(e.prototype,n),r&&cl(e,r),t}();function Rl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Il(t){return(Il="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fl(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Dl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Hl(t,e,n){return e&&zl(t.prototype,e),n&&zl(t,n),t}function Ml(t,e){return!e||"object"!==Il(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Nl(t){return(Nl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bl(t,e){return(Bl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wl=function(t){function e(t){var n;Dl(this,e);var r=new Jt("ellipsis");return(n=Ml(this,Nl(e).call(this,r,"auto",!1,"top-left"))).contentClick=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bl(t,e)}(e,Mn),Hl(e,[{key:"reset",value:function(t){var e=this,n=t.map(function(t,n){return a("div","".concat(wt,"-item")).css("width","150px").css("font-weight","normal").on("click",function(){e.contentClick(n),e.hide()}).child(t)});this.setContentChildren.apply(this,Fl(n))}},{key:"setTitle",value:function(){}}]),e}(),Vl=[{key:"delete",title:K("contextmenu.deleteSheet")}];function Ll(){var t=this;return Vl.map(function(e){return function(t){var e=this;return a("div","".concat(wt,"-item")).child(t.title()).on("click",function(){e.itemClick(t.key),e.hide()})}.call(t,e)})}var ql=function(){function t(){var e;Dl(this,t),this.el=(e=a("div","".concat(wt,"-contextmenu")).css("width","160px")).children.apply(e,Fl(Ll.call(this))).hide(),this.itemClick=function(){}}return Hl(t,[{key:"hide",value:function(){var t=this.el;t.hide(),vt(t)}},{key:"setOffset",value:function(t){var e=this.el;e.offset(t),e.show(),gt(e)}}]),t}(),Kl=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};Dl(this,t),this.swapFunc=r,this.updateFunc=o,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new Wl(function(t){e.clickSwap2(e.items[t])}),this.contextMenu=new ql,this.contextMenu.itemClick=i,this.el=a("div","".concat(wt,"-bottombar")).children(this.contextMenu.el,this.menuEl=a("ul","".concat(wt,"-menu")).child(a("li","").children(new Jt("add").on("click",function(){n()}),a("span","").child(this.moreEl))))}return Hl(t,[{key:"addItem",value:function(t,e,n){var r=this;this.dataNames.push(t);var i=a("li",e?"active":"").child(t);i.on("click",function(){r.clickSwap2(i)}).on("contextmenu",function(t){if("read"!==n.mode){var e=t.target,o=e.offsetLeft,a=e.offsetHeight;r.contextMenu.setOffset({left:o,bottom:a+1}),r.deleteEl=i}}).on("dblclick",function(){if("read"!==n.mode){var t=i.html(),e=new La("auto","");e.val(t),e.input.on("blur",function(e){var n=e.target.value,i=r.dataNames.findIndex(function(e){return e===t});r.renameItem(i,n)}),i.html("").child(e.el),e.focus()}}),e&&this.clickSwap(i),this.items.push(i),this.menuEl.child(i),this.moreEl.reset(this.dataNames)}},{key:"renameItem",value:function(t,e){this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)}},{key:"clear",value:function(){var t=this;this.items.forEach(function(e){t.menuEl.removeChild(e.el)}),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}},{key:"deleteItem",value:function(){var t=this.activeEl,e=this.deleteEl;if(this.items.length>1){var n=this.items.findIndex(function(t){return t===e});if(this.items.splice(n,1),this.dataNames.splice(n,1),this.menuEl.removeChild(e.el),this.moreEl.reset(this.dataNames),t===e){var r=Rl(this.items,1)[0];return this.activeEl=r,this.activeEl.toggle(),[n,0]}return[n,-1]}return[-1]}},{key:"clickSwap2",value:function(t){var e=this.items.findIndex(function(e){return e===t});this.clickSwap(t),this.activeEl.toggle(),this.swapFunc(e)}},{key:"clickSwap",value:function(t){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=t}}]),t}();n(1);function $l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ul(t,e){var n=Object.keys(t);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(t)),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n}function Yl(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,"spreadsheet",function(){return es});var Xl=[];function Jl(t,e,n){Xl.push({finder:t,render:e,onCtrlClick:n})}var Gl=[];function Ql(t,e){Gl.push({getHint:t,onTriggered:e})}var ts=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var i=e;this.options=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ul(n,!0).forEach(function(e){Yl(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ul(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({showBottomBar:!0},r),this.sheetIndex=1,this.datas=[],"string"==typeof e&&(i=document.querySelector(e)),this.bottombar=this.options.showBottomBar?new Kl(function(){if("read"!==n.options.mode){var t=n.addSheet();n.sheet.resetData(t)}},function(t){var e=n.datas[t];n.sheet.resetData(e)},function(){n.deleteSheet()},function(t,e){n.datas[t].name=e,n.sheet.trigger("change")}):null,this.data=this.addSheet();var o=a("div","".concat(wt)).on("contextmenu",function(t){return t.preventDefault()});if(i.appendChild(o.el),this.sheet=new Pl(o,this.data,this),null!==this.bottombar&&o.child(this.bottombar.el),!window.xSpreadsheetCtrlKeyListener){var l=!1;window.xSpreadsheetCtrlKeyListener=function(t){var e=t.ctrlKey||t.metaKey;e!==l&&(l=e,document.body.classList.toggle("".concat(wt,"-has-ctrl-key"),e),document.body.classList.toggle("".concat(wt,"-no-ctrl-key"),!e))},window.addEventListener("mousemove",window.xSpreadsheetCtrlKeyListener),window.addEventListener("keydown",window.xSpreadsheetCtrlKeyListener),window.addEventListener("keyup",window.xSpreadsheetCtrlKeyListener)}}var e,n,r;return e=t,r=[{key:"locale",value:function(t,e){$(t,e)}},{key:"addCustomFormula",value:function(t,e,n){He(t,e,n)}},{key:"addClickableElementFinder",value:function(t,e,n){Jl(t,e,n)}},{key:"addChooser",value:function(t,e){Ql(t,e)}}],(n=[{key:"focus",value:function(){this.sheet&&this.sheet.focus()}},{key:"addSheet",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=t||"sheet".concat(this.sheetIndex),i=new ht(r,this.options);return i.change=function(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=e.sheet).trigger.apply(t,["change"].concat(r))},this.datas.push(i),null!==this.bottombar&&this.bottombar.addItem(r,n,this.options),this.sheetIndex+=1,i}},{key:"deleteSheet",value:function(){if(null!==this.bottombar){var t=$l(this.bottombar.deleteItem(),2),e=t[0],n=t[1];e>=0&&(this.datas.splice(e,1),n>=0&&this.sheet.resetData(this.datas[n]),this.sheet.trigger("change"))}}},{key:"loadData",value:function(t){var e=Array.isArray(t)?t:[t];if(null!==this.bottombar&&this.bottombar.clear(),this.datas=[],e.length>0)for(var n=0;n<e.length;n+=1){var r=e[n],i=this.addSheet(r.name,0===n);i.setData(r),0===n&&this.sheet.resetData(i)}return this}},{key:"getData",value:function(){return this.datas.map(function(t){return t.getData()})}},{key:"cellText",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.datas[r].setCellText(t,e,n,"finished"),this}},{key:"cell",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[n].getCell(t,e)}},{key:"cellStyle",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[n].getCellStyle(t,e)}},{key:"setSelectedCellCustomFormatter",value:function(t){this.sheet.setSelectedCellCustomFormatter(t)}},{key:"clearSelectedCellCustomFormatter",value:function(){this.sheet.clearSelectedCellCustomFormatter()}},{key:"getSelectedRange",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.datas[t].selector.range;return{col0:e.sci,col1:e.eci,row0:e.sri,row1:e.eri}}},{key:"setSelectedRange",value:function(t){this.sheet.selectorSet(!1,t.row0,t.col0,!0,!1),this.sheet.selectorSet(!0,t.row1,t.col1,!0,!1)}},{key:"clearCustomClipboard",value:function(){this.sheet.clearClipboard()}},{key:"reRender",value:function(){return this.sheet.table.render(),this}},{key:"on",value:function(t,e){return this.sheet.on(t,e),this}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"change",value:function(t){return this.sheet.on("change",t),this}},{key:"getClickableElementFinders",value:function(){return Xl}},{key:"getChoosers",value:function(){return Gl}}])&&Zl(e.prototype,n),r&&Zl(e,r),t}(),es=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new ts(t,e)};window&&(window.x_spreadsheet=es,window.x_spreadsheet.locale=function(t,e){return $(t,e)},window.x_spreadsheet.addCustomFormula=function(t,e,n){return He(t,e,n)},window.x_spreadsheet.addClickableElementFinder=function(t,e,n){return Jl(t,e,n)},window.x_spreadsheet.addChooser=function(t,e){return Ql(t,e)});e.default=ts}]);
//# sourceMappingURL=xspreadsheet.js.map
